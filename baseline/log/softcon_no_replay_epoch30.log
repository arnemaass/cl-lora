2025-06-16 18:50:43,123 INFO Logger initialized
2025-06-16 18:50:43,123 INFO Config path: config_baseline.yml
2025-06-16 18:50:43,123 INFO Config file contents:
# Aktualisierte Konfigurationsdatei f√ºr Continual-Learning-Benchmark

# Test-Typ: 'replay' oder 'no_replay'
test_type: no_replay

# Modell-Definition
model_module: SoftCon  # Options: 'SpectralGPT' or 'SoftCon'

# Parameter f√ºr die Tests
params:
  countries:
    - Finland
    - Ireland
    - Serbia
    - Austria
    - Portugal
  permutation: [0, 1, 2, 3, 4]                # Reihenfolge der L√§nder-Indices

  # Anzahl der zuf√§llig gezogenen Samples pro Land
  train_samples: 5000 #22482
  test_samples: 500 #8176
  seed: 42                              # Seed f√ºr Reproduzierbarkeit

  # DataLoader-Parameter
  batch_size: 256
  num_workers: 4
  epoch: 30
  lr: 1e-3


  # Bildgr√∂√üe und Filteroptionen
  include_snowy: false
  include_cloudy: false


  save_dir: ./saved_models                # Verzeichnis zum Speichern der Modelle
  log_every_step: true


2025-06-16 18:50:43,126 INFO Using model module: SoftCon
/home/arne/softcon/models/dinov2/layers/swiglu_ffn.py:43: UserWarning: xFormers is available (SwiGLU)
  warnings.warn("xFormers is available (SwiGLU)")
/home/arne/softcon/models/dinov2/layers/attention.py:27: UserWarning: xFormers is available (Attention)
  warnings.warn("xFormers is available (Attention)")
/home/arne/softcon/models/dinov2/layers/block.py:33: UserWarning: xFormers is available (Block)
  warnings.warn("xFormers is available (Block)")
2025-06-16 18:50:43,378 INFO using MLP layer as FFN
2025-06-16 18:50:44,608 INFO using MLP layer as FFN
Sequential(
  (0): LoRA_ViT_timm(
    (lora_vit): DinoVisionTransformer(
      (patch_embed): PatchEmbed(
        (proj): Conv2d(13, 768, kernel_size=(14, 14), stride=(14, 14))
        (norm): Identity()
      )
      (blocks): ModuleList(
        (0-11): 12 x NestedTensorBlock(
          (norm1): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
          (attn): MemEffAttention(
            (qkv): _LoRA_qkv_timm(
              (qkv): Linear(in_features=768, out_features=2304, bias=True)
              (linear_a_q): Linear(in_features=768, out_features=4, bias=False)
              (linear_b_q): Linear(in_features=4, out_features=768, bias=False)
              (linear_a_v): Linear(in_features=768, out_features=4, bias=False)
              (linear_b_v): Linear(in_features=4, out_features=768, bias=False)
            )
            (attn_drop): Dropout(p=0.0, inplace=False)
            (proj): Linear(in_features=768, out_features=768, bias=True)
            (proj_drop): Dropout(p=0.0, inplace=False)
          )
          (ls1): LayerScale()
          (drop_path1): Identity()
          (norm2): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
          (mlp): Mlp(
            (fc1): Linear(in_features=768, out_features=3072, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=3072, out_features=768, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
          (ls2): LayerScale()
          (drop_path2): Identity()
        )
      )
      (norm): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (head): Identity()
    )
  )
  (1): Linear(in_features=768, out_features=19, bias=True)
)
Number of trainable parameters (w/ LoRA): 162067
[96m[INFO]    Loading BEN data for train...[0m
[96m[INFO]        237871 patches indexed[0m
[96m[INFO]        4000 pre-filtered patches indexed[0m
[96m[INFO]        4000 filtered patches indexed[0m
[96m[INFO]    Merged metadata with snow/cloud metadata[0m
[96m[INFO]    Loaded 549488 labels[0m
[96m[INFO]    Loaded 549488 keys[0m
[96m[INFO]    Loaded mapping created[0m
[96m[INFO]    Loading BEN data for train...[0m
[96m[INFO]        237871 patches indexed[0m
[96m[INFO]        1000 pre-filtered patches indexed[0m
[96m[INFO]        1000 filtered patches indexed[0m
[96m[INFO]    Merged metadata with snow/cloud metadata[0m
[96m[INFO]    Loaded 549488 labels[0m
[96m[INFO]    Loaded 549488 keys[0m
[96m[INFO]    Loaded mapping created[0m
[96m[INFO]    Loading BEN data for train...[0m
[96m[INFO]        237871 patches indexed[0m
[96m[INFO]        4000 pre-filtered patches indexed[0m
[96m[INFO]        4000 filtered patches indexed[0m
[96m[INFO]    Merged metadata with snow/cloud metadata[0m
[96m[INFO]    Loaded 549488 labels[0m
[96m[INFO]    Loaded 549488 keys[0m
[96m[INFO]    Loaded mapping created[0m
[96m[INFO]    Loading BEN data for train...[0m
[96m[INFO]        237871 patches indexed[0m
[96m[INFO]        1000 pre-filtered patches indexed[0m
[96m[INFO]        1000 filtered patches indexed[0m
[96m[INFO]    Merged metadata with snow/cloud metadata[0m
[96m[INFO]    Loaded 549488 labels[0m
[96m[INFO]    Loaded 549488 keys[0m
[96m[INFO]    Loaded mapping created[0m
[96m[INFO]    Loading BEN data for train...[0m
[96m[INFO]        237871 patches indexed[0m
[96m[INFO]        4000 pre-filtered patches indexed[0m
[96m[INFO]        4000 filtered patches indexed[0m
[96m[INFO]    Merged metadata with snow/cloud metadata[0m
[96m[INFO]    Loaded 549488 labels[0m
[96m[INFO]    Loaded 549488 keys[0m
[96m[INFO]    Loaded mapping created[0m
[96m[INFO]    Loading BEN data for train...[0m
[96m[INFO]        237871 patches indexed[0m
[96m[INFO]        1000 pre-filtered patches indexed[0m
[96m[INFO]        1000 filtered patches indexed[0m
[96m[INFO]    Merged metadata with snow/cloud metadata[0m
[96m[INFO]    Loaded 549488 labels[0m
[96m[INFO]    Loaded 549488 keys[0m
[96m[INFO]    Loaded mapping created[0m
[96m[INFO]    Loading BEN data for train...[0m
[96m[INFO]        237871 patches indexed[0m
[96m[INFO]        4000 pre-filtered patches indexed[0m
[96m[INFO]        4000 filtered patches indexed[0m
[96m[INFO]    Merged metadata with snow/cloud metadata[0m
[96m[INFO]    Loaded 549488 labels[0m
[96m[INFO]    Loaded 549488 keys[0m
[96m[INFO]    Loaded mapping created[0m
[96m[INFO]    Loading BEN data for train...[0m
[96m[INFO]        237871 patches indexed[0m
[96m[INFO]        1000 pre-filtered patches indexed[0m
[96m[INFO]        1000 filtered patches indexed[0m
[96m[INFO]    Merged metadata with snow/cloud metadata[0m
[96m[INFO]    Loaded 549488 labels[0m
[96m[INFO]    Loaded 549488 keys[0m
[96m[INFO]    Loaded mapping created[0m
[96m[INFO]    Loading BEN data for train...[0m
[96m[INFO]        237871 patches indexed[0m
[96m[INFO]        4000 pre-filtered patches indexed[0m
[96m[INFO]        4000 filtered patches indexed[0m
[96m[INFO]    Merged metadata with snow/cloud metadata[0m
[96m[INFO]    Loaded 549488 labels[0m
[96m[INFO]    Loaded 549488 keys[0m
[96m[INFO]    Loaded mapping created[0m
[96m[INFO]    Loading BEN data for train...[0m
[96m[INFO]        237871 patches indexed[0m
[96m[INFO]        1000 pre-filtered patches indexed[0m
[96m[INFO]        1000 filtered patches indexed[0m
[96m[INFO]    Merged metadata with snow/cloud metadata[0m
[96m[INFO]    Loaded 549488 labels[0m
[96m[INFO]    Loaded 549488 keys[0m
[96m[INFO]    Loaded mapping created[0m
[96m[INFO]    Loading BEN data for test...[0m
[96m[INFO]        119825 patches indexed[0m
[96m[INFO]        500 pre-filtered patches indexed[0m
[96m[INFO]        500 filtered patches indexed[0m
[96m[INFO]    Merged metadata with snow/cloud metadata[0m
[96m[INFO]    Loaded 549488 labels[0m
[96m[INFO]    Loaded 549488 keys[0m
[96m[INFO]    Loaded mapping created[0m
[96m[INFO]    Loading BEN data for test...[0m
[96m[INFO]        119825 patches indexed[0m
[96m[INFO]        0 pre-filtered patches indexed[0m
[96m[INFO]        0 filtered patches indexed[0m
[96m[INFO]    Merged metadata with snow/cloud metadata[0m
[96m[INFO]    Loaded 549488 labels[0m
[96m[INFO]    Loaded 549488 keys[0m
[96m[INFO]    Loaded mapping created[0m
[96m[INFO]    Loading BEN data for test...[0m
[96m[INFO]        119825 patches indexed[0m
[96m[INFO]        500 pre-filtered patches indexed[0m
[96m[INFO]        500 filtered patches indexed[0m
[96m[INFO]    Merged metadata with snow/cloud metadata[0m
[96m[INFO]    Loaded 549488 labels[0m
[96m[INFO]    Loaded 549488 keys[0m
[96m[INFO]    Loaded mapping created[0m
[96m[INFO]    Loading BEN data for test...[0m
[96m[INFO]        119825 patches indexed[0m
[96m[INFO]        0 pre-filtered patches indexed[0m
[96m[INFO]        0 filtered patches indexed[0m
[96m[INFO]    Merged metadata with snow/cloud metadata[0m
[96m[INFO]    Loaded 549488 labels[0m
[96m[INFO]    Loaded 549488 keys[0m
[96m[INFO]    Loaded mapping created[0m
[96m[INFO]    Loading BEN data for test...[0m
[96m[INFO]        119825 patches indexed[0m
[96m[INFO]        500 pre-filtered patches indexed[0m
[96m[INFO]        500 filtered patches indexed[0m
[96m[INFO]    Merged metadata with snow/cloud metadata[0m
[96m[INFO]    Loaded 549488 labels[0m
[96m[INFO]    Loaded 549488 keys[0m
[96m[INFO]    Loaded mapping created[0m
[96m[INFO]    Loading BEN data for test...[0m
[96m[INFO]        119825 patches indexed[0m
[96m[INFO]        0 pre-filtered patches indexed[0m
[96m[INFO]        0 filtered patches indexed[0m
[96m[INFO]    Merged metadata with snow/cloud metadata[0m
[96m[INFO]    Loaded 549488 labels[0m
[96m[INFO]    Loaded 549488 keys[0m
[96m[INFO]    Loaded mapping created[0m
[96m[INFO]    Loading BEN data for test...[0m
[96m[INFO]        119825 patches indexed[0m
[96m[INFO]        500 pre-filtered patches indexed[0m
[96m[INFO]        500 filtered patches indexed[0m
[96m[INFO]    Merged metadata with snow/cloud metadata[0m
[96m[INFO]    Loaded 549488 labels[0m
2025-06-16 18:52:01,190 INFO Step 1: Countries ['Finland']
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
Initializing distributed: GLOBAL_RANK: 0, MEMBER: 1/1
----------------------------------------------------------------------------------------------------
distributed_backend=nccl
All distributed processes registered. Starting with 1 processes
----------------------------------------------------------------------------------------------------

LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name              | Type              | Params | Mode 
----------------------------------------------------------------
0 | feature_extractor | LoRA_ViT_timm     | 87.4 M | train
1 | classifier        | Linear            | 14.6 K | train
2 | criterion         | BCEWithLogitsLoss | 0      | train
----------------------------------------------------------------
162 K     Trainable params
87.2 M    Non-trainable params
87.4 M    Total params
349.572   Total estimated model params size (MB)
274       Modules in train mode
0         Modules in eval mode
SLURM auto-requeueing enabled. Setting signal handlers.
[96m[INFO]    Loaded 549488 keys[0m
[96m[INFO]    Loaded mapping created[0m
[96m[INFO]    Loading BEN data for test...[0m
[96m[INFO]        119825 patches indexed[0m
[96m[INFO]        0 pre-filtered patches indexed[0m
[96m[INFO]        0 filtered patches indexed[0m
[96m[INFO]    Merged metadata with snow/cloud metadata[0m
[96m[INFO]    Loaded 549488 labels[0m
[96m[INFO]    Loaded 549488 keys[0m
[96m[INFO]    Loaded mapping created[0m
[96m[INFO]    Loading BEN data for test...[0m
[96m[INFO]        119825 patches indexed[0m
[96m[INFO]        500 pre-filtered patches indexed[0m
[96m[INFO]        500 filtered patches indexed[0m
[96m[INFO]    Merged metadata with snow/cloud metadata[0m
[96m[INFO]    Loaded 549488 labels[0m
[96m[INFO]    Loaded 549488 keys[0m
[96m[INFO]    Loaded mapping created[0m
[96m[INFO]    Loading BEN data for test...[0m
[96m[INFO]        119825 patches indexed[0m
[96m[INFO]        0 pre-filtered patches indexed[0m
[96m[INFO]        0 filtered patches indexed[0m
[96m[INFO]    Merged metadata with snow/cloud metadata[0m
[96m[INFO]    Loaded 549488 labels[0m
[96m[INFO]    Loaded 549488 keys[0m
[96m[INFO]    Loaded mapping created[0m
/faststorage/arne/mamba/envs/cl_lora_env/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py:4631: UserWarning: No device id is provided via `init_process_group` or `barrier `. Using the current device set by the user. 
  warnings.warn(  # warn only once
/faststorage/arne/mamba/envs/cl_lora_env/lib/python3.9/site-packages/pytorch_lightning/trainer/connectors/logger_connector/result.py:434: It is recommended to use `self.log('val_loss', ..., sync_dist=True)` when logging on epoch level in distributed setting to accumulate the metric across devices.
/faststorage/arne/mamba/envs/cl_lora_env/lib/python3.9/site-packages/pytorch_lightning/trainer/connectors/logger_connector/result.py:434: It is recommended to use `self.log('val_micro_ap', ..., sync_dist=True)` when logging on epoch level in distributed setting to accumulate the metric across devices.
/faststorage/arne/mamba/envs/cl_lora_env/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py:4631: UserWarning: No device id is provided via `init_process_group` or `barrier `. Using the current device set by the user. 
  warnings.warn(  # warn only once
/faststorage/arne/mamba/envs/cl_lora_env/lib/python3.9/site-packages/pytorch_lightning/loops/fit_loop.py:310: The number of training batches (16) is smaller than the logging interval Trainer(log_every_n_steps=50). Set a lower value for log_every_n_steps if you want to see logs for the training epoch.
[rank0]:[W616 18:52:19.359597386 reducer.cpp:1430] Warning: find_unused_parameters=True was specified in DDP constructor, but did not find any unused parameters in the forward pass. This flag results in an extra traversal of the autograd graph every iteration,  which can adversely affect performance. If your model indeed never has any unused parameters in the forward pass, consider turning this flag off. Note that this warning may be a false positive if your model has flow control causing later iterations to have unused parameters. (function operator())
Sanity Checking: |          | 0/? [00:00<?, ?it/s]Sanity Checking:   0%|          | 0/2 [00:00<?, ?it/s]Sanity Checking DataLoader 0:   0%|          | 0/2 [00:00<?, ?it/s]Sanity Checking DataLoader 0:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:02<00:02,  0.45it/s]Sanity Checking DataLoader 0: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 2/2 [00:03<00:00,  0.57it/s]                                                                           Training: |          | 0/? [00:00<?, ?it/s]Training:   0%|          | 0/16 [00:00<?, ?it/s]Epoch 0:   0%|          | 0/16 [00:00<?, ?it/s] Epoch 0:   6%|‚ñã         | 1/16 [00:09<02:15,  0.11it/s]Epoch 0:   6%|‚ñã         | 1/16 [00:09<02:15,  0.11it/s, v_num=8820, train_loss=0.809, train_micro_ap=0.158]Epoch 0:  12%|‚ñà‚ñé        | 2/16 [00:10<01:14,  0.19it/s, v_num=8820, train_loss=0.809, train_micro_ap=0.158]Epoch 0:  12%|‚ñà‚ñé        | 2/16 [00:12<01:24,  0.17it/s, v_num=8820, train_loss=0.587, train_micro_ap=0.269]Epoch 0:  19%|‚ñà‚ñâ        | 3/16 [00:13<00:58,  0.22it/s, v_num=8820, train_loss=0.587, train_micro_ap=0.269]Epoch 0:  19%|‚ñà‚ñâ        | 3/16 [00:14<01:04,  0.20it/s, v_num=8820, train_loss=0.435, train_micro_ap=0.502]Epoch 0:  25%|‚ñà‚ñà‚ñå       | 4/16 [00:16<00:48,  0.25it/s, v_num=8820, train_loss=0.435, train_micro_ap=0.502]Epoch 0:  25%|‚ñà‚ñà‚ñå       | 4/16 [00:17<00:53,  0.22it/s, v_num=8820, train_loss=0.319, train_micro_ap=0.595]Epoch 0:  31%|‚ñà‚ñà‚ñà‚ñè      | 5/16 [00:19<00:42,  0.26it/s, v_num=8820, train_loss=0.319, train_micro_ap=0.595]Epoch 0:  31%|‚ñà‚ñà‚ñà‚ñè      | 5/16 [00:20<00:45,  0.24it/s, v_num=8820, train_loss=0.266, train_micro_ap=0.641]Epoch 0:  38%|‚ñà‚ñà‚ñà‚ñä      | 6/16 [00:22<00:36,  0.27it/s, v_num=8820, train_loss=0.266, train_micro_ap=0.641]Epoch 0:  38%|‚ñà‚ñà‚ñà‚ñä      | 6/16 [00:23<00:39,  0.26it/s, v_num=8820, train_loss=0.232, train_micro_ap=0.668]Epoch 0:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 7/16 [00:24<00:31,  0.28it/s, v_num=8820, train_loss=0.232, train_micro_ap=0.668]Epoch 0:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 7/16 [00:26<00:33,  0.27it/s, v_num=8820, train_loss=0.240, train_micro_ap=0.703]Epoch 0:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 8/16 [00:27<00:27,  0.29it/s, v_num=8820, train_loss=0.240, train_micro_ap=0.703]Epoch 0:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 8/16 [00:29<00:29,  0.27it/s, v_num=8820, train_loss=0.246, train_micro_ap=0.716]Epoch 0:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 9/16 [00:30<00:23,  0.29it/s, v_num=8820, train_loss=0.246, train_micro_ap=0.716]Epoch 0:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 9/16 [00:31<00:24,  0.28it/s, v_num=8820, train_loss=0.254, train_micro_ap=0.706]Epoch 0:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 10/16 [00:33<00:20,  0.30it/s, v_num=8820, train_loss=0.254, train_micro_ap=0.706]Epoch 0:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 10/16 [00:34<00:20,  0.29it/s, v_num=8820, train_loss=0.246, train_micro_ap=0.697]Epoch 0:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 11/16 [00:36<00:16,  0.30it/s, v_num=8820, train_loss=0.246, train_micro_ap=0.697]Epoch 0:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 11/16 [00:37<00:17,  0.29it/s, v_num=8820, train_loss=0.214, train_micro_ap=0.687]Epoch 0:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 12/16 [00:39<00:13,  0.31it/s, v_num=8820, train_loss=0.214, train_micro_ap=0.687]Epoch 0:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 12/16 [00:40<00:13,  0.30it/s, v_num=8820, train_loss=0.218, train_micro_ap=0.740]Epoch 0:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 13/16 [00:41<00:09,  0.31it/s, v_num=8820, train_loss=0.218, train_micro_ap=0.740]Epoch 0:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 13/16 [00:43<00:10,  0.30it/s, v_num=8820, train_loss=0.221, train_micro_ap=0.685]Epoch 0:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 14/16 [00:44<00:06,  0.31it/s, v_num=8820, train_loss=0.221, train_micro_ap=0.685]Epoch 0:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 14/16 [00:46<00:06,  0.30it/s, v_num=8820, train_loss=0.230, train_micro_ap=0.690]Epoch 0:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 15/16 [00:47<00:03,  0.32it/s, v_num=8820, train_loss=0.230, train_micro_ap=0.690]Epoch 0:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 15/16 [00:49<00:03,  0.31it/s, v_num=8820, train_loss=0.229, train_micro_ap=0.714]Epoch 0: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 16/16 [00:49<00:00,  0.32it/s, v_num=8820, train_loss=0.229, train_micro_ap=0.714]Epoch 0: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 16/16 [00:50<00:00,  0.31it/s, v_num=8820, train_loss=0.212, train_micro_ap=0.740][96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m

Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:01<00:03,  0.96it/s][A
Validation DataLoader 0:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:02<00:02,  0.84it/s][A
Validation DataLoader 0:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:03<00:01,  0.81it/s][A
Validation DataLoader 0: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:04<00:00,  0.81it/s][A
/faststorage/arne/mamba/envs/cl_lora_env/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py:4631: UserWarning: No device id is provided via `init_process_group` or `barrier `. Using the current device set by the user. 
  warnings.warn(  # warn only once
Metric val_loss improved. New best score: 0.211
Epoch 0, global step 16: 'val_loss' reached 0.21113 (best 0.21113), saving model to 'saved_models/lightning_logs/version_8820/checkpoints/epoch=0-step=16.ckpt' as top 1
                                                                      [AEpoch 0: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 16/16 [01:01<00:00,  0.26it/s, v_num=8820, train_loss=0.212, train_micro_ap=0.740, val_loss=0.211, val_micro_ap=0.721]Epoch 0: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 16/16 [01:01<00:00,  0.26it/s, v_num=8820, train_loss=0.212, train_micro_ap=0.740, val_loss=0.211, val_micro_ap=0.721]Epoch 0:   0%|          | 0/16 [00:00<?, ?it/s, v_num=8820, train_loss=0.212, train_micro_ap=0.740, val_loss=0.211, val_micro_ap=0.721]         Epoch 1:   0%|          | 0/16 [00:00<?, ?it/s, v_num=8820, train_loss=0.212, train_micro_ap=0.740, val_loss=0.211, val_micro_ap=0.721][96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
Epoch 1:   6%|‚ñã         | 1/16 [00:07<01:49,  0.14it/s, v_num=8820, train_loss=0.212, train_micro_ap=0.740, val_loss=0.211, val_micro_ap=0.721]Epoch 1:   6%|‚ñã         | 1/16 [00:08<02:11,  0.11it/s, v_num=8820, train_loss=0.241, train_micro_ap=0.691, val_loss=0.211, val_micro_ap=0.721]Epoch 1:  12%|‚ñà‚ñé        | 2/16 [00:10<01:11,  0.20it/s, v_num=8820, train_loss=0.241, train_micro_ap=0.691, val_loss=0.211, val_micro_ap=0.721]Epoch 1:  12%|‚ñà‚ñé        | 2/16 [00:11<01:21,  0.17it/s, v_num=8820, train_loss=0.211, train_micro_ap=0.714, val_loss=0.211, val_micro_ap=0.721]Epoch 1:  19%|‚ñà‚ñâ        | 3/16 [00:13<00:56,  0.23it/s, v_num=8820, train_loss=0.211, train_micro_ap=0.714, val_loss=0.211, val_micro_ap=0.721]Epoch 1:  19%|‚ñà‚ñâ        | 3/16 [00:14<01:03,  0.21it/s, v_num=8820, train_loss=0.207, train_micro_ap=0.732, val_loss=0.211, val_micro_ap=0.721]Epoch 1:  25%|‚ñà‚ñà‚ñå       | 4/16 [00:16<00:48,  0.25it/s, v_num=8820, train_loss=0.207, train_micro_ap=0.732, val_loss=0.211, val_micro_ap=0.721]Epoch 1:  25%|‚ñà‚ñà‚ñå       | 4/16 [00:17<00:53,  0.23it/s, v_num=8820, train_loss=0.217, train_micro_ap=0.735, val_loss=0.211, val_micro_ap=0.721]Epoch 1:  31%|‚ñà‚ñà‚ñà‚ñè      | 5/16 [00:19<00:41,  0.26it/s, v_num=8820, train_loss=0.217, train_micro_ap=0.735, val_loss=0.211, val_micro_ap=0.721]Epoch 1:  31%|‚ñà‚ñà‚ñà‚ñè      | 5/16 [00:20<00:45,  0.24it/s, v_num=8820, train_loss=0.218, train_micro_ap=0.716, val_loss=0.211, val_micro_ap=0.721]Epoch 1:  38%|‚ñà‚ñà‚ñà‚ñä      | 6/16 [00:21<00:36,  0.27it/s, v_num=8820, train_loss=0.218, train_micro_ap=0.716, val_loss=0.211, val_micro_ap=0.721]Epoch 1:  38%|‚ñà‚ñà‚ñà‚ñä      | 6/16 [00:23<00:38,  0.26it/s, v_num=8820, train_loss=0.220, train_micro_ap=0.706, val_loss=0.211, val_micro_ap=0.721]Epoch 1:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 7/16 [00:24<00:31,  0.28it/s, v_num=8820, train_loss=0.220, train_micro_ap=0.706, val_loss=0.211, val_micro_ap=0.721]Epoch 1:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 7/16 [00:26<00:33,  0.27it/s, v_num=8820, train_loss=0.207, train_micro_ap=0.751, val_loss=0.211, val_micro_ap=0.721]Epoch 1:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 8/16 [00:27<00:27,  0.29it/s, v_num=8820, train_loss=0.207, train_micro_ap=0.751, val_loss=0.211, val_micro_ap=0.721]Epoch 1:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 8/16 [00:29<00:29,  0.28it/s, v_num=8820, train_loss=0.215, train_micro_ap=0.733, val_loss=0.211, val_micro_ap=0.721]Epoch 1:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 9/16 [00:30<00:23,  0.30it/s, v_num=8820, train_loss=0.215, train_micro_ap=0.733, val_loss=0.211, val_micro_ap=0.721]Epoch 1:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 9/16 [00:31<00:24,  0.28it/s, v_num=8820, train_loss=0.209, train_micro_ap=0.708, val_loss=0.211, val_micro_ap=0.721]Epoch 1:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 10/16 [00:33<00:19,  0.30it/s, v_num=8820, train_loss=0.209, train_micro_ap=0.708, val_loss=0.211, val_micro_ap=0.721]Epoch 1:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 10/16 [00:34<00:20,  0.29it/s, v_num=8820, train_loss=0.218, train_micro_ap=0.702, val_loss=0.211, val_micro_ap=0.721]Epoch 1:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 11/16 [00:36<00:16,  0.30it/s, v_num=8820, train_loss=0.218, train_micro_ap=0.702, val_loss=0.211, val_micro_ap=0.721]Epoch 1:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 11/16 [00:37<00:17,  0.29it/s, v_num=8820, train_loss=0.214, train_micro_ap=0.718, val_loss=0.211, val_micro_ap=0.721]Epoch 1:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 12/16 [00:38<00:12,  0.31it/s, v_num=8820, train_loss=0.214, train_micro_ap=0.718, val_loss=0.211, val_micro_ap=0.721]Epoch 1:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 12/16 [00:40<00:13,  0.30it/s, v_num=8820, train_loss=0.201, train_micro_ap=0.756, val_loss=0.211, val_micro_ap=0.721]Epoch 1:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 13/16 [00:41<00:09,  0.31it/s, v_num=8820, train_loss=0.201, train_micro_ap=0.756, val_loss=0.211, val_micro_ap=0.721]Epoch 1:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 13/16 [00:43<00:09,  0.30it/s, v_num=8820, train_loss=0.211, train_micro_ap=0.721, val_loss=0.211, val_micro_ap=0.721]Epoch 1:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 14/16 [00:44<00:06,  0.31it/s, v_num=8820, train_loss=0.211, train_micro_ap=0.721, val_loss=0.211, val_micro_ap=0.721]Epoch 1:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 14/16 [00:46<00:06,  0.30it/s, v_num=8820, train_loss=0.204, train_micro_ap=0.740, val_loss=0.211, val_micro_ap=0.721]Epoch 1:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 15/16 [00:47<00:03,  0.32it/s, v_num=8820, train_loss=0.204, train_micro_ap=0.740, val_loss=0.211, val_micro_ap=0.721]Epoch 1:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 15/16 [00:48<00:03,  0.31it/s, v_num=8820, train_loss=0.207, train_micro_ap=0.731, val_loss=0.211, val_micro_ap=0.721]Epoch 1: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 16/16 [00:49<00:00,  0.32it/s, v_num=8820, train_loss=0.207, train_micro_ap=0.731, val_loss=0.211, val_micro_ap=0.721]Epoch 1: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 16/16 [00:50<00:00,  0.32it/s, v_num=8820, train_loss=0.190, train_micro_ap=0.757, val_loss=0.211, val_micro_ap=0.721][96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m

Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:01<00:03,  0.98it/s][A
Validation DataLoader 0:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:02<00:02,  0.86it/s][A
Validation DataLoader 0:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:03<00:01,  0.82it/s][A
Validation DataLoader 0: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:04<00:00,  0.82it/s][A
/faststorage/arne/mamba/envs/cl_lora_env/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py:4631: UserWarning: No device id is provided via `init_process_group` or `barrier `. Using the current device set by the user. 
  warnings.warn(  # warn only once
Epoch 1, global step 32: 'val_loss' reached 0.20379 (best 0.20379), saving model to 'saved_models/lightning_logs/version_8820/checkpoints/epoch=1-step=32.ckpt' as top 1
                                                                      [AEpoch 1: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 16/16 [01:01<00:00,  0.26it/s, v_num=8820, train_loss=0.190, train_micro_ap=0.757, val_loss=0.204, val_micro_ap=0.731]Epoch 1: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 16/16 [01:01<00:00,  0.26it/s, v_num=8820, train_loss=0.190, train_micro_ap=0.757, val_loss=0.204, val_micro_ap=0.731]Epoch 1:   0%|          | 0/16 [00:00<?, ?it/s, v_num=8820, train_loss=0.190, train_micro_ap=0.757, val_loss=0.204, val_micro_ap=0.731]         Epoch 2:   0%|          | 0/16 [00:00<?, ?it/s, v_num=8820, train_loss=0.190, train_micro_ap=0.757, val_loss=0.204, val_micro_ap=0.731][96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
Epoch 2:   6%|‚ñã         | 1/16 [00:07<01:50,  0.14it/s, v_num=8820, train_loss=0.190, train_micro_ap=0.757, val_loss=0.204, val_micro_ap=0.731]Epoch 2:   6%|‚ñã         | 1/16 [00:08<02:12,  0.11it/s, v_num=8820, train_loss=0.222, train_micro_ap=0.701, val_loss=0.204, val_micro_ap=0.731]Epoch 2:  12%|‚ñà‚ñé        | 2/16 [00:10<01:11,  0.20it/s, v_num=8820, train_loss=0.222, train_micro_ap=0.701, val_loss=0.204, val_micro_ap=0.731]Epoch 2:  12%|‚ñà‚ñé        | 2/16 [00:11<01:22,  0.17it/s, v_num=8820, train_loss=0.193, train_micro_ap=0.755, val_loss=0.204, val_micro_ap=0.731]Epoch 2:  19%|‚ñà‚ñâ        | 3/16 [00:13<00:56,  0.23it/s, v_num=8820, train_loss=0.193, train_micro_ap=0.755, val_loss=0.204, val_micro_ap=0.731]Epoch 2:  19%|‚ñà‚ñâ        | 3/16 [00:14<01:03,  0.21it/s, v_num=8820, train_loss=0.202, train_micro_ap=0.740, val_loss=0.204, val_micro_ap=0.731]Epoch 2:  25%|‚ñà‚ñà‚ñå       | 4/16 [00:16<00:48,  0.25it/s, v_num=8820, train_loss=0.202, train_micro_ap=0.740, val_loss=0.204, val_micro_ap=0.731]Epoch 2:  25%|‚ñà‚ñà‚ñå       | 4/16 [00:17<00:53,  0.23it/s, v_num=8820, train_loss=0.217, train_micro_ap=0.710, val_loss=0.204, val_micro_ap=0.731]Epoch 2:  31%|‚ñà‚ñà‚ñà‚ñè      | 5/16 [00:19<00:42,  0.26it/s, v_num=8820, train_loss=0.217, train_micro_ap=0.710, val_loss=0.204, val_micro_ap=0.731]Epoch 2:  31%|‚ñà‚ñà‚ñà‚ñè      | 5/16 [00:20<00:45,  0.24it/s, v_num=8820, train_loss=0.186, train_micro_ap=0.780, val_loss=0.204, val_micro_ap=0.731]Epoch 2:  38%|‚ñà‚ñà‚ñà‚ñä      | 6/16 [00:21<00:36,  0.27it/s, v_num=8820, train_loss=0.186, train_micro_ap=0.780, val_loss=0.204, val_micro_ap=0.731]Epoch 2:  38%|‚ñà‚ñà‚ñà‚ñä      | 6/16 [00:23<00:39,  0.26it/s, v_num=8820, train_loss=0.212, train_micro_ap=0.723, val_loss=0.204, val_micro_ap=0.731]Epoch 2:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 7/16 [00:24<00:31,  0.28it/s, v_num=8820, train_loss=0.212, train_micro_ap=0.723, val_loss=0.204, val_micro_ap=0.731]Epoch 2:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 7/16 [00:26<00:33,  0.27it/s, v_num=8820, train_loss=0.216, train_micro_ap=0.733, val_loss=0.204, val_micro_ap=0.731]Epoch 2:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 8/16 [00:27<00:27,  0.29it/s, v_num=8820, train_loss=0.216, train_micro_ap=0.733, val_loss=0.204, val_micro_ap=0.731]Epoch 2:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 8/16 [00:29<00:29,  0.27it/s, v_num=8820, train_loss=0.204, train_micro_ap=0.722, val_loss=0.204, val_micro_ap=0.731]Epoch 2:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 9/16 [00:30<00:23,  0.30it/s, v_num=8820, train_loss=0.204, train_micro_ap=0.722, val_loss=0.204, val_micro_ap=0.731]Epoch 2:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 9/16 [00:31<00:24,  0.28it/s, v_num=8820, train_loss=0.201, train_micro_ap=0.754, val_loss=0.204, val_micro_ap=0.731]Epoch 2:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 10/16 [00:33<00:20,  0.30it/s, v_num=8820, train_loss=0.201, train_micro_ap=0.754, val_loss=0.204, val_micro_ap=0.731]Epoch 2:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 10/16 [00:34<00:20,  0.29it/s, v_num=8820, train_loss=0.198, train_micro_ap=0.758, val_loss=0.204, val_micro_ap=0.731]Epoch 2:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 11/16 [00:36<00:16,  0.30it/s, v_num=8820, train_loss=0.198, train_micro_ap=0.758, val_loss=0.204, val_micro_ap=0.731]Epoch 2:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 11/16 [00:37<00:17,  0.29it/s, v_num=8820, train_loss=0.206, train_micro_ap=0.744, val_loss=0.204, val_micro_ap=0.731]Epoch 2:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 12/16 [00:39<00:13,  0.31it/s, v_num=8820, train_loss=0.206, train_micro_ap=0.744, val_loss=0.204, val_micro_ap=0.731]Epoch 2:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 12/16 [00:40<00:13,  0.30it/s, v_num=8820, train_loss=0.204, train_micro_ap=0.745, val_loss=0.204, val_micro_ap=0.731]Epoch 2:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 13/16 [00:41<00:09,  0.31it/s, v_num=8820, train_loss=0.204, train_micro_ap=0.745, val_loss=0.204, val_micro_ap=0.731]Epoch 2:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 13/16 [00:43<00:09,  0.30it/s, v_num=8820, train_loss=0.220, train_micro_ap=0.714, val_loss=0.204, val_micro_ap=0.731]Epoch 2:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 14/16 [00:44<00:06,  0.31it/s, v_num=8820, train_loss=0.220, train_micro_ap=0.714, val_loss=0.204, val_micro_ap=0.731]Epoch 2:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 14/16 [00:46<00:06,  0.30it/s, v_num=8820, train_loss=0.207, train_micro_ap=0.726, val_loss=0.204, val_micro_ap=0.731]Epoch 2:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 15/16 [00:47<00:03,  0.32it/s, v_num=8820, train_loss=0.207, train_micro_ap=0.726, val_loss=0.204, val_micro_ap=0.731]Epoch 2:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 15/16 [00:48<00:03,  0.31it/s, v_num=8820, train_loss=0.202, train_micro_ap=0.765, val_loss=0.204, val_micro_ap=0.731]Epoch 2: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 16/16 [00:49<00:00,  0.32it/s, v_num=8820, train_loss=0.202, train_micro_ap=0.765, val_loss=0.204, val_micro_ap=0.731]Epoch 2: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 16/16 [00:50<00:00,  0.32it/s, v_num=8820, train_loss=0.196, train_micro_ap=0.758, val_loss=0.204, val_micro_ap=0.731][96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m

Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:01<00:03,  0.98it/s][A
Validation DataLoader 0:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:02<00:02,  0.85it/s][A
Validation DataLoader 0:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:03<00:01,  0.82it/s][A
Validation DataLoader 0: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:04<00:00,  0.82it/s][A
/faststorage/arne/mamba/envs/cl_lora_env/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py:4631: UserWarning: No device id is provided via `init_process_group` or `barrier `. Using the current device set by the user. 
  warnings.warn(  # warn only once
Metric val_loss improved by 0.015 >= min_delta = 0.01. New best score: 0.196
Epoch 2, global step 48: 'val_loss' reached 0.19572 (best 0.19572), saving model to 'saved_models/lightning_logs/version_8820/checkpoints/epoch=2-step=48.ckpt' as top 1
                                                                      [AEpoch 2: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 16/16 [01:01<00:00,  0.26it/s, v_num=8820, train_loss=0.196, train_micro_ap=0.758, val_loss=0.196, val_micro_ap=0.750]Epoch 2: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 16/16 [01:01<00:00,  0.26it/s, v_num=8820, train_loss=0.196, train_micro_ap=0.758, val_loss=0.196, val_micro_ap=0.750]Epoch 2:   0%|          | 0/16 [00:00<?, ?it/s, v_num=8820, train_loss=0.196, train_micro_ap=0.758, val_loss=0.196, val_micro_ap=0.750]         Epoch 3:   0%|          | 0/16 [00:00<?, ?it/s, v_num=8820, train_loss=0.196, train_micro_ap=0.758, val_loss=0.196, val_micro_ap=0.750][96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
Epoch 3:   6%|‚ñã         | 1/16 [00:07<01:48,  0.14it/s, v_num=8820, train_loss=0.196, train_micro_ap=0.758, val_loss=0.196, val_micro_ap=0.750]Epoch 3:   6%|‚ñã         | 1/16 [00:08<02:11,  0.11it/s, v_num=8820, train_loss=0.211, train_micro_ap=0.743, val_loss=0.196, val_micro_ap=0.750]Epoch 3:  12%|‚ñà‚ñé        | 2/16 [00:10<01:11,  0.20it/s, v_num=8820, train_loss=0.211, train_micro_ap=0.743, val_loss=0.196, val_micro_ap=0.750]Epoch 3:  12%|‚ñà‚ñé        | 2/16 [00:11<01:21,  0.17it/s, v_num=8820, train_loss=0.206, train_micro_ap=0.742, val_loss=0.196, val_micro_ap=0.750]Epoch 3:  19%|‚ñà‚ñâ        | 3/16 [00:13<00:56,  0.23it/s, v_num=8820, train_loss=0.206, train_micro_ap=0.742, val_loss=0.196, val_micro_ap=0.750]Epoch 3:  19%|‚ñà‚ñâ        | 3/16 [00:14<01:03,  0.21it/s, v_num=8820, train_loss=0.187, train_micro_ap=0.758, val_loss=0.196, val_micro_ap=0.750]Epoch 3:  25%|‚ñà‚ñà‚ñå       | 4/16 [00:15<00:47,  0.25it/s, v_num=8820, train_loss=0.187, train_micro_ap=0.758, val_loss=0.196, val_micro_ap=0.750]Epoch 3:  25%|‚ñà‚ñà‚ñå       | 4/16 [00:17<00:52,  0.23it/s, v_num=8820, train_loss=0.197, train_micro_ap=0.753, val_loss=0.196, val_micro_ap=0.750]Epoch 3:  31%|‚ñà‚ñà‚ñà‚ñè      | 5/16 [00:18<00:41,  0.27it/s, v_num=8820, train_loss=0.197, train_micro_ap=0.753, val_loss=0.196, val_micro_ap=0.750]Epoch 3:  31%|‚ñà‚ñà‚ñà‚ñè      | 5/16 [00:20<00:44,  0.25it/s, v_num=8820, train_loss=0.212, train_micro_ap=0.734, val_loss=0.196, val_micro_ap=0.750]Epoch 3:  38%|‚ñà‚ñà‚ñà‚ñä      | 6/16 [00:21<00:36,  0.28it/s, v_num=8820, train_loss=0.212, train_micro_ap=0.734, val_loss=0.196, val_micro_ap=0.750]Epoch 3:  38%|‚ñà‚ñà‚ñà‚ñä      | 6/16 [00:23<00:38,  0.26it/s, v_num=8820, train_loss=0.202, train_micro_ap=0.747, val_loss=0.196, val_micro_ap=0.750]Epoch 3:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 7/16 [00:24<00:31,  0.29it/s, v_num=8820, train_loss=0.202, train_micro_ap=0.747, val_loss=0.196, val_micro_ap=0.750]Epoch 3:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 7/16 [00:25<00:33,  0.27it/s, v_num=8820, train_loss=0.204, train_micro_ap=0.738, val_loss=0.196, val_micro_ap=0.750]Epoch 3:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 8/16 [00:27<00:27,  0.29it/s, v_num=8820, train_loss=0.204, train_micro_ap=0.738, val_loss=0.196, val_micro_ap=0.750]Epoch 3:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 8/16 [00:28<00:28,  0.28it/s, v_num=8820, train_loss=0.195, train_micro_ap=0.752, val_loss=0.196, val_micro_ap=0.750]Epoch 3:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 9/16 [00:30<00:23,  0.30it/s, v_num=8820, train_loss=0.195, train_micro_ap=0.752, val_loss=0.196, val_micro_ap=0.750]Epoch 3:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 9/16 [00:31<00:24,  0.28it/s, v_num=8820, train_loss=0.194, train_micro_ap=0.775, val_loss=0.196, val_micro_ap=0.750]Epoch 3:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 10/16 [00:32<00:19,  0.30it/s, v_num=8820, train_loss=0.194, train_micro_ap=0.775, val_loss=0.196, val_micro_ap=0.750]Epoch 3:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 10/16 [00:34<00:20,  0.29it/s, v_num=8820, train_loss=0.194, train_micro_ap=0.752, val_loss=0.196, val_micro_ap=0.750]Epoch 3:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 11/16 [00:35<00:16,  0.31it/s, v_num=8820, train_loss=0.194, train_micro_ap=0.752, val_loss=0.196, val_micro_ap=0.750]Epoch 3:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 11/16 [00:37<00:16,  0.30it/s, v_num=8820, train_loss=0.198, train_micro_ap=0.770, val_loss=0.196, val_micro_ap=0.750]Epoch 3:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 12/16 [00:38<00:12,  0.31it/s, v_num=8820, train_loss=0.198, train_micro_ap=0.770, val_loss=0.196, val_micro_ap=0.750]Epoch 3:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 12/16 [00:40<00:13,  0.30it/s, v_num=8820, train_loss=0.194, train_micro_ap=0.783, val_loss=0.196, val_micro_ap=0.750]Epoch 3:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 13/16 [00:41<00:09,  0.31it/s, v_num=8820, train_loss=0.194, train_micro_ap=0.783, val_loss=0.196, val_micro_ap=0.750]Epoch 3:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 13/16 [00:42<00:09,  0.30it/s, v_num=8820, train_loss=0.203, train_micro_ap=0.753, val_loss=0.196, val_micro_ap=0.750]Epoch 3:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 14/16 [00:44<00:06,  0.32it/s, v_num=8820, train_loss=0.203, train_micro_ap=0.753, val_loss=0.196, val_micro_ap=0.750]Epoch 3:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 14/16 [00:45<00:06,  0.31it/s, v_num=8820, train_loss=0.191, train_micro_ap=0.760, val_loss=0.196, val_micro_ap=0.750]Epoch 3:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 15/16 [00:47<00:03,  0.32it/s, v_num=8820, train_loss=0.191, train_micro_ap=0.760, val_loss=0.196, val_micro_ap=0.750]Epoch 3:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 15/16 [00:48<00:03,  0.31it/s, v_num=8820, train_loss=0.206, train_micro_ap=0.755, val_loss=0.196, val_micro_ap=0.750]Epoch 3: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 16/16 [00:49<00:00,  0.32it/s, v_num=8820, train_loss=0.206, train_micro_ap=0.755, val_loss=0.196, val_micro_ap=0.750]Epoch 3: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 16/16 [00:50<00:00,  0.32it/s, v_num=8820, train_loss=0.215, train_micro_ap=0.713, val_loss=0.196, val_micro_ap=0.750][96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m

Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:01<00:03,  0.96it/s][A
Validation DataLoader 0:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:02<00:02,  0.85it/s][A
Validation DataLoader 0:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:03<00:01,  0.81it/s][A
Validation DataLoader 0: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:04<00:00,  0.82it/s][A
/faststorage/arne/mamba/envs/cl_lora_env/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py:4631: UserWarning: No device id is provided via `init_process_group` or `barrier `. Using the current device set by the user. 
  warnings.warn(  # warn only once
Epoch 3, global step 64: 'val_loss' was not in top 1
                                                                      [AEpoch 3: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 16/16 [01:01<00:00,  0.26it/s, v_num=8820, train_loss=0.215, train_micro_ap=0.713, val_loss=0.196, val_micro_ap=0.755]Epoch 3: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 16/16 [01:01<00:00,  0.26it/s, v_num=8820, train_loss=0.215, train_micro_ap=0.713, val_loss=0.196, val_micro_ap=0.755]Epoch 3:   0%|          | 0/16 [00:00<?, ?it/s, v_num=8820, train_loss=0.215, train_micro_ap=0.713, val_loss=0.196, val_micro_ap=0.755]         Epoch 4:   0%|          | 0/16 [00:00<?, ?it/s, v_num=8820, train_loss=0.215, train_micro_ap=0.713, val_loss=0.196, val_micro_ap=0.755][96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
Epoch 4:   6%|‚ñã         | 1/16 [00:07<01:48,  0.14it/s, v_num=8820, train_loss=0.215, train_micro_ap=0.713, val_loss=0.196, val_micro_ap=0.755]Epoch 4:   6%|‚ñã         | 1/16 [00:08<02:10,  0.12it/s, v_num=8820, train_loss=0.194, train_micro_ap=0.760, val_loss=0.196, val_micro_ap=0.755]Epoch 4:  12%|‚ñà‚ñé        | 2/16 [00:10<01:11,  0.20it/s, v_num=8820, train_loss=0.194, train_micro_ap=0.760, val_loss=0.196, val_micro_ap=0.755]Epoch 4:  12%|‚ñà‚ñé        | 2/16 [00:11<01:21,  0.17it/s, v_num=8820, train_loss=0.193, train_micro_ap=0.756, val_loss=0.196, val_micro_ap=0.755]Epoch 4:  19%|‚ñà‚ñâ        | 3/16 [00:12<00:56,  0.23it/s, v_num=8820, train_loss=0.193, train_micro_ap=0.756, val_loss=0.196, val_micro_ap=0.755]Epoch 4:  19%|‚ñà‚ñâ        | 3/16 [00:14<01:02,  0.21it/s, v_num=8820, train_loss=0.179, train_micro_ap=0.782, val_loss=0.196, val_micro_ap=0.755]Epoch 4:  25%|‚ñà‚ñà‚ñå       | 4/16 [00:15<00:47,  0.25it/s, v_num=8820, train_loss=0.179, train_micro_ap=0.782, val_loss=0.196, val_micro_ap=0.755]Epoch 4:  25%|‚ñà‚ñà‚ñå       | 4/16 [00:17<00:51,  0.23it/s, v_num=8820, train_loss=0.203, train_micro_ap=0.761, val_loss=0.196, val_micro_ap=0.755]Epoch 4:  31%|‚ñà‚ñà‚ñà‚ñè      | 5/16 [00:18<00:41,  0.27it/s, v_num=8820, train_loss=0.203, train_micro_ap=0.761, val_loss=0.196, val_micro_ap=0.755]Epoch 4:  31%|‚ñà‚ñà‚ñà‚ñè      | 5/16 [00:20<00:44,  0.25it/s, v_num=8820, train_loss=0.186, train_micro_ap=0.786, val_loss=0.196, val_micro_ap=0.755]Epoch 4:  38%|‚ñà‚ñà‚ñà‚ñä      | 6/16 [00:21<00:35,  0.28it/s, v_num=8820, train_loss=0.186, train_micro_ap=0.786, val_loss=0.196, val_micro_ap=0.755]Epoch 4:  38%|‚ñà‚ñà‚ñà‚ñä      | 6/16 [00:23<00:38,  0.26it/s, v_num=8820, train_loss=0.187, train_micro_ap=0.770, val_loss=0.196, val_micro_ap=0.755]Epoch 4:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 7/16 [00:24<00:31,  0.29it/s, v_num=8820, train_loss=0.187, train_micro_ap=0.770, val_loss=0.196, val_micro_ap=0.755]Epoch 4:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 7/16 [00:25<00:33,  0.27it/s, v_num=8820, train_loss=0.190, train_micro_ap=0.781, val_loss=0.196, val_micro_ap=0.755]Epoch 4:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 8/16 [00:27<00:27,  0.29it/s, v_num=8820, train_loss=0.190, train_micro_ap=0.781, val_loss=0.196, val_micro_ap=0.755]Epoch 4:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 8/16 [00:28<00:28,  0.28it/s, v_num=8820, train_loss=0.207, train_micro_ap=0.740, val_loss=0.196, val_micro_ap=0.755]Epoch 4:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 9/16 [00:30<00:23,  0.30it/s, v_num=8820, train_loss=0.207, train_micro_ap=0.740, val_loss=0.196, val_micro_ap=0.755]Epoch 4:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 9/16 [00:31<00:24,  0.29it/s, v_num=8820, train_loss=0.188, train_micro_ap=0.784, val_loss=0.196, val_micro_ap=0.755]Epoch 4:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 10/16 [00:32<00:19,  0.30it/s, v_num=8820, train_loss=0.188, train_micro_ap=0.784, val_loss=0.196, val_micro_ap=0.755]Epoch 4:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 10/16 [00:34<00:20,  0.29it/s, v_num=8820, train_loss=0.219, train_micro_ap=0.733, val_loss=0.196, val_micro_ap=0.755]Epoch 4:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 11/16 [00:35<00:16,  0.31it/s, v_num=8820, train_loss=0.219, train_micro_ap=0.733, val_loss=0.196, val_micro_ap=0.755]Epoch 4:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 11/16 [00:37<00:16,  0.30it/s, v_num=8820, train_loss=0.193, train_micro_ap=0.764, val_loss=0.196, val_micro_ap=0.755]Epoch 4:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 12/16 [00:38<00:12,  0.31it/s, v_num=8820, train_loss=0.193, train_micro_ap=0.764, val_loss=0.196, val_micro_ap=0.755]Epoch 4:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 12/16 [00:40<00:13,  0.30it/s, v_num=8820, train_loss=0.216, train_micro_ap=0.715, val_loss=0.196, val_micro_ap=0.755]Epoch 4:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 13/16 [00:41<00:09,  0.31it/s, v_num=8820, train_loss=0.216, train_micro_ap=0.715, val_loss=0.196, val_micro_ap=0.755]Epoch 4:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 13/16 [00:42<00:09,  0.30it/s, v_num=8820, train_loss=0.189, train_micro_ap=0.754, val_loss=0.196, val_micro_ap=0.755]Epoch 4:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 14/16 [00:44<00:06,  0.32it/s, v_num=8820, train_loss=0.189, train_micro_ap=0.754, val_loss=0.196, val_micro_ap=0.755]Epoch 4:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 14/16 [00:45<00:06,  0.31it/s, v_num=8820, train_loss=0.193, train_micro_ap=0.770, val_loss=0.196, val_micro_ap=0.755]Epoch 4:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 15/16 [00:47<00:03,  0.32it/s, v_num=8820, train_loss=0.193, train_micro_ap=0.770, val_loss=0.196, val_micro_ap=0.755]Epoch 4:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 15/16 [00:48<00:03,  0.31it/s, v_num=8820, train_loss=0.184, train_micro_ap=0.798, val_loss=0.196, val_micro_ap=0.755]Epoch 4: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 16/16 [00:49<00:00,  0.32it/s, v_num=8820, train_loss=0.184, train_micro_ap=0.798, val_loss=0.196, val_micro_ap=0.755]Epoch 4: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 16/16 [00:50<00:00,  0.32it/s, v_num=8820, train_loss=0.207, train_micro_ap=0.731, val_loss=0.196, val_micro_ap=0.755][96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m

Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:01<00:03,  0.98it/s][A
Validation DataLoader 0:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:02<00:02,  0.85it/s][A
Validation DataLoader 0:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:03<00:01,  0.82it/s][A
Validation DataLoader 0: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:04<00:00,  0.82it/s][A
/faststorage/arne/mamba/envs/cl_lora_env/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py:4631: UserWarning: No device id is provided via `init_process_group` or `barrier `. Using the current device set by the user. 
  warnings.warn(  # warn only once
Metric val_loss improved by 0.012 >= min_delta = 0.01. New best score: 0.184
Epoch 4, global step 80: 'val_loss' reached 0.18406 (best 0.18406), saving model to 'saved_models/lightning_logs/version_8820/checkpoints/epoch=4-step=80.ckpt' as top 1
                                                                      [AEpoch 4: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 16/16 [01:01<00:00,  0.26it/s, v_num=8820, train_loss=0.207, train_micro_ap=0.731, val_loss=0.184, val_micro_ap=0.770]Epoch 4: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 16/16 [01:01<00:00,  0.26it/s, v_num=8820, train_loss=0.207, train_micro_ap=0.731, val_loss=0.184, val_micro_ap=0.770]Epoch 4:   0%|          | 0/16 [00:00<?, ?it/s, v_num=8820, train_loss=0.207, train_micro_ap=0.731, val_loss=0.184, val_micro_ap=0.770]         Epoch 5:   0%|          | 0/16 [00:00<?, ?it/s, v_num=8820, train_loss=0.207, train_micro_ap=0.731, val_loss=0.184, val_micro_ap=0.770][96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
Epoch 5:   6%|‚ñã         | 1/16 [00:07<01:54,  0.13it/s, v_num=8820, train_loss=0.207, train_micro_ap=0.731, val_loss=0.184, val_micro_ap=0.770]Epoch 5:   6%|‚ñã         | 1/16 [00:09<02:16,  0.11it/s, v_num=8820, train_loss=0.187, train_micro_ap=0.771, val_loss=0.184, val_micro_ap=0.770]Epoch 5:  12%|‚ñà‚ñé        | 2/16 [00:10<01:14,  0.19it/s, v_num=8820, train_loss=0.187, train_micro_ap=0.771, val_loss=0.184, val_micro_ap=0.770]Epoch 5:  12%|‚ñà‚ñé        | 2/16 [00:12<01:25,  0.16it/s, v_num=8820, train_loss=0.184, train_micro_ap=0.806, val_loss=0.184, val_micro_ap=0.770]Epoch 5:  19%|‚ñà‚ñâ        | 3/16 [00:13<00:58,  0.22it/s, v_num=8820, train_loss=0.184, train_micro_ap=0.806, val_loss=0.184, val_micro_ap=0.770]Epoch 5:  19%|‚ñà‚ñâ        | 3/16 [00:15<01:05,  0.20it/s, v_num=8820, train_loss=0.180, train_micro_ap=0.789, val_loss=0.184, val_micro_ap=0.770]Epoch 5:  25%|‚ñà‚ñà‚ñå       | 4/16 [00:16<00:49,  0.24it/s, v_num=8820, train_loss=0.180, train_micro_ap=0.789, val_loss=0.184, val_micro_ap=0.770]Epoch 5:  25%|‚ñà‚ñà‚ñå       | 4/16 [00:17<00:53,  0.22it/s, v_num=8820, train_loss=0.186, train_micro_ap=0.785, val_loss=0.184, val_micro_ap=0.770]Epoch 5:  31%|‚ñà‚ñà‚ñà‚ñè      | 5/16 [00:19<00:42,  0.26it/s, v_num=8820, train_loss=0.186, train_micro_ap=0.785, val_loss=0.184, val_micro_ap=0.770]Epoch 5:  31%|‚ñà‚ñà‚ñà‚ñè      | 5/16 [00:20<00:45,  0.24it/s, v_num=8820, train_loss=0.213, train_micro_ap=0.734, val_loss=0.184, val_micro_ap=0.770]Epoch 5:  38%|‚ñà‚ñà‚ñà‚ñä      | 6/16 [00:22<00:36,  0.27it/s, v_num=8820, train_loss=0.213, train_micro_ap=0.734, val_loss=0.184, val_micro_ap=0.770]Epoch 5:  38%|‚ñà‚ñà‚ñà‚ñä      | 6/16 [00:23<00:39,  0.25it/s, v_num=8820, train_loss=0.188, train_micro_ap=0.746, val_loss=0.184, val_micro_ap=0.770]Epoch 5:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 7/16 [00:24<00:32,  0.28it/s, v_num=8820, train_loss=0.188, train_micro_ap=0.746, val_loss=0.184, val_micro_ap=0.770]Epoch 5:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 7/16 [00:26<00:33,  0.27it/s, v_num=8820, train_loss=0.181, train_micro_ap=0.799, val_loss=0.184, val_micro_ap=0.770]Epoch 5:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 8/16 [00:27<00:27,  0.29it/s, v_num=8820, train_loss=0.181, train_micro_ap=0.799, val_loss=0.184, val_micro_ap=0.770]Epoch 5:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 8/16 [00:29<00:29,  0.27it/s, v_num=8820, train_loss=0.189, train_micro_ap=0.756, val_loss=0.184, val_micro_ap=0.770]Epoch 5:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 9/16 [00:30<00:23,  0.29it/s, v_num=8820, train_loss=0.189, train_micro_ap=0.756, val_loss=0.184, val_micro_ap=0.770]Epoch 5:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 9/16 [00:32<00:24,  0.28it/s, v_num=8820, train_loss=0.198, train_micro_ap=0.758, val_loss=0.184, val_micro_ap=0.770]Epoch 5:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 10/16 [00:33<00:20,  0.30it/s, v_num=8820, train_loss=0.198, train_micro_ap=0.758, val_loss=0.184, val_micro_ap=0.770]Epoch 5:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 10/16 [00:34<00:20,  0.29it/s, v_num=8820, train_loss=0.196, train_micro_ap=0.770, val_loss=0.184, val_micro_ap=0.770]Epoch 5:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 11/16 [00:36<00:16,  0.30it/s, v_num=8820, train_loss=0.196, train_micro_ap=0.770, val_loss=0.184, val_micro_ap=0.770]Epoch 5:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 11/16 [00:37<00:17,  0.29it/s, v_num=8820, train_loss=0.205, train_micro_ap=0.742, val_loss=0.184, val_micro_ap=0.770]Epoch 5:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 12/16 [00:39<00:13,  0.31it/s, v_num=8820, train_loss=0.205, train_micro_ap=0.742, val_loss=0.184, val_micro_ap=0.770]Epoch 5:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 12/16 [00:40<00:13,  0.30it/s, v_num=8820, train_loss=0.202, train_micro_ap=0.757, val_loss=0.184, val_micro_ap=0.770]Epoch 5:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 13/16 [00:41<00:09,  0.31it/s, v_num=8820, train_loss=0.202, train_micro_ap=0.757, val_loss=0.184, val_micro_ap=0.770]Epoch 5:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 13/16 [00:43<00:10,  0.30it/s, v_num=8820, train_loss=0.183, train_micro_ap=0.787, val_loss=0.184, val_micro_ap=0.770]Epoch 5:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 14/16 [00:44<00:06,  0.31it/s, v_num=8820, train_loss=0.183, train_micro_ap=0.787, val_loss=0.184, val_micro_ap=0.770]Epoch 5:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 14/16 [00:46<00:06,  0.30it/s, v_num=8820, train_loss=0.193, train_micro_ap=0.780, val_loss=0.184, val_micro_ap=0.770]Epoch 5:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 15/16 [00:47<00:03,  0.32it/s, v_num=8820, train_loss=0.193, train_micro_ap=0.780, val_loss=0.184, val_micro_ap=0.770]Epoch 5:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 15/16 [00:49<00:03,  0.31it/s, v_num=8820, train_loss=0.196, train_micro_ap=0.764, val_loss=0.184, val_micro_ap=0.770]Epoch 5: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 16/16 [00:49<00:00,  0.32it/s, v_num=8820, train_loss=0.196, train_micro_ap=0.764, val_loss=0.184, val_micro_ap=0.770]Epoch 5: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 16/16 [00:50<00:00,  0.31it/s, v_num=8820, train_loss=0.181, train_micro_ap=0.777, val_loss=0.184, val_micro_ap=0.770][96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m

Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:01<00:03,  0.98it/s][A
Validation DataLoader 0:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:02<00:02,  0.85it/s][A
Validation DataLoader 0:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:03<00:01,  0.82it/s][A
Validation DataLoader 0: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:04<00:00,  0.82it/s][A
/faststorage/arne/mamba/envs/cl_lora_env/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py:4631: UserWarning: No device id is provided via `init_process_group` or `barrier `. Using the current device set by the user. 
  warnings.warn(  # warn only once
Epoch 5, global step 96: 'val_loss' was not in top 1
                                                                      [AEpoch 5: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 16/16 [01:01<00:00,  0.26it/s, v_num=8820, train_loss=0.181, train_micro_ap=0.777, val_loss=0.187, val_micro_ap=0.773]Epoch 5: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 16/16 [01:01<00:00,  0.26it/s, v_num=8820, train_loss=0.181, train_micro_ap=0.777, val_loss=0.187, val_micro_ap=0.773]Epoch 5:   0%|          | 0/16 [00:00<?, ?it/s, v_num=8820, train_loss=0.181, train_micro_ap=0.777, val_loss=0.187, val_micro_ap=0.773]         Epoch 6:   0%|          | 0/16 [00:00<?, ?it/s, v_num=8820, train_loss=0.181, train_micro_ap=0.777, val_loss=0.187, val_micro_ap=0.773][96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
Epoch 6:   6%|‚ñã         | 1/16 [00:07<01:46,  0.14it/s, v_num=8820, train_loss=0.181, train_micro_ap=0.777, val_loss=0.187, val_micro_ap=0.773]Epoch 6:   6%|‚ñã         | 1/16 [00:08<02:08,  0.12it/s, v_num=8820, train_loss=0.193, train_micro_ap=0.766, val_loss=0.187, val_micro_ap=0.773]Epoch 6:  12%|‚ñà‚ñé        | 2/16 [00:10<01:12,  0.19it/s, v_num=8820, train_loss=0.193, train_micro_ap=0.766, val_loss=0.187, val_micro_ap=0.773]Epoch 6:  12%|‚ñà‚ñé        | 2/16 [00:11<01:22,  0.17it/s, v_num=8820, train_loss=0.199, train_micro_ap=0.745, val_loss=0.187, val_micro_ap=0.773]Epoch 6:  19%|‚ñà‚ñâ        | 3/16 [00:13<00:56,  0.23it/s, v_num=8820, train_loss=0.199, train_micro_ap=0.745, val_loss=0.187, val_micro_ap=0.773]Epoch 6:  19%|‚ñà‚ñâ        | 3/16 [00:14<01:03,  0.21it/s, v_num=8820, train_loss=0.209, train_micro_ap=0.752, val_loss=0.187, val_micro_ap=0.773]Epoch 6:  25%|‚ñà‚ñà‚ñå       | 4/16 [00:16<00:48,  0.25it/s, v_num=8820, train_loss=0.209, train_micro_ap=0.752, val_loss=0.187, val_micro_ap=0.773]Epoch 6:  25%|‚ñà‚ñà‚ñå       | 4/16 [00:17<00:52,  0.23it/s, v_num=8820, train_loss=0.216, train_micro_ap=0.724, val_loss=0.187, val_micro_ap=0.773]Epoch 6:  31%|‚ñà‚ñà‚ñà‚ñè      | 5/16 [00:18<00:41,  0.27it/s, v_num=8820, train_loss=0.216, train_micro_ap=0.724, val_loss=0.187, val_micro_ap=0.773]Epoch 6:  31%|‚ñà‚ñà‚ñà‚ñè      | 5/16 [00:20<00:44,  0.25it/s, v_num=8820, train_loss=0.198, train_micro_ap=0.760, val_loss=0.187, val_micro_ap=0.773]Epoch 6:  38%|‚ñà‚ñà‚ñà‚ñä      | 6/16 [00:21<00:36,  0.28it/s, v_num=8820, train_loss=0.198, train_micro_ap=0.760, val_loss=0.187, val_micro_ap=0.773]Epoch 6:  38%|‚ñà‚ñà‚ñà‚ñä      | 6/16 [00:23<00:38,  0.26it/s, v_num=8820, train_loss=0.206, train_micro_ap=0.747, val_loss=0.187, val_micro_ap=0.773]Epoch 6:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 7/16 [00:24<00:31,  0.28it/s, v_num=8820, train_loss=0.206, train_micro_ap=0.747, val_loss=0.187, val_micro_ap=0.773]Epoch 6:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 7/16 [00:26<00:33,  0.27it/s, v_num=8820, train_loss=0.200, train_micro_ap=0.744, val_loss=0.187, val_micro_ap=0.773]Epoch 6:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 8/16 [00:27<00:27,  0.29it/s, v_num=8820, train_loss=0.200, train_micro_ap=0.744, val_loss=0.187, val_micro_ap=0.773]Epoch 6:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 8/16 [00:28<00:28,  0.28it/s, v_num=8820, train_loss=0.190, train_micro_ap=0.775, val_loss=0.187, val_micro_ap=0.773]Epoch 6:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 9/16 [00:30<00:23,  0.30it/s, v_num=8820, train_loss=0.190, train_micro_ap=0.775, val_loss=0.187, val_micro_ap=0.773]Epoch 6:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 9/16 [00:31<00:24,  0.28it/s, v_num=8820, train_loss=0.201, train_micro_ap=0.765, val_loss=0.187, val_micro_ap=0.773]Epoch 6:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 10/16 [00:33<00:19,  0.30it/s, v_num=8820, train_loss=0.201, train_micro_ap=0.765, val_loss=0.187, val_micro_ap=0.773]Epoch 6:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 10/16 [00:34<00:20,  0.29it/s, v_num=8820, train_loss=0.199, train_micro_ap=0.748, val_loss=0.187, val_micro_ap=0.773]Epoch 6:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 11/16 [00:35<00:16,  0.31it/s, v_num=8820, train_loss=0.199, train_micro_ap=0.748, val_loss=0.187, val_micro_ap=0.773]Epoch 6:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 11/16 [00:37<00:16,  0.29it/s, v_num=8820, train_loss=0.200, train_micro_ap=0.762, val_loss=0.187, val_micro_ap=0.773]Epoch 6:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 12/16 [00:38<00:12,  0.31it/s, v_num=8820, train_loss=0.200, train_micro_ap=0.762, val_loss=0.187, val_micro_ap=0.773]Epoch 6:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 12/16 [00:40<00:13,  0.30it/s, v_num=8820, train_loss=0.209, train_micro_ap=0.730, val_loss=0.187, val_micro_ap=0.773]Epoch 6:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 13/16 [00:41<00:09,  0.31it/s, v_num=8820, train_loss=0.209, train_micro_ap=0.730, val_loss=0.187, val_micro_ap=0.773]Epoch 6:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 13/16 [00:43<00:09,  0.30it/s, v_num=8820, train_loss=0.187, train_micro_ap=0.764, val_loss=0.187, val_micro_ap=0.773]Epoch 6:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 14/16 [00:44<00:06,  0.32it/s, v_num=8820, train_loss=0.187, train_micro_ap=0.764, val_loss=0.187, val_micro_ap=0.773]Epoch 6:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 14/16 [00:45<00:06,  0.31it/s, v_num=8820, train_loss=0.183, train_micro_ap=0.777, val_loss=0.187, val_micro_ap=0.773]Epoch 6:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 15/16 [00:47<00:03,  0.32it/s, v_num=8820, train_loss=0.183, train_micro_ap=0.777, val_loss=0.187, val_micro_ap=0.773]Epoch 6:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 15/16 [00:48<00:03,  0.31it/s, v_num=8820, train_loss=0.191, train_micro_ap=0.759, val_loss=0.187, val_micro_ap=0.773]Epoch 6: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 16/16 [00:49<00:00,  0.32it/s, v_num=8820, train_loss=0.191, train_micro_ap=0.759, val_loss=0.187, val_micro_ap=0.773]Epoch 6: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 16/16 [00:50<00:00,  0.32it/s, v_num=8820, train_loss=0.195, train_micro_ap=0.784, val_loss=0.187, val_micro_ap=0.773][96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m

Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:01<00:03,  0.98it/s][A
Validation DataLoader 0:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:02<00:02,  0.85it/s][A
Validation DataLoader 0:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:03<00:01,  0.82it/s][A
Validation DataLoader 0: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:04<00:00,  0.82it/s][A
/faststorage/arne/mamba/envs/cl_lora_env/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py:4631: UserWarning: No device id is provided via `init_process_group` or `barrier `. Using the current device set by the user. 
  warnings.warn(  # warn only once
Epoch 6, global step 112: 'val_loss' was not in top 1
                                                                      [AEpoch 6: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 16/16 [01:01<00:00,  0.26it/s, v_num=8820, train_loss=0.195, train_micro_ap=0.784, val_loss=0.191, val_micro_ap=0.767]Epoch 6: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 16/16 [01:01<00:00,  0.26it/s, v_num=8820, train_loss=0.195, train_micro_ap=0.784, val_loss=0.191, val_micro_ap=0.767]Epoch 6:   0%|          | 0/16 [00:00<?, ?it/s, v_num=8820, train_loss=0.195, train_micro_ap=0.784, val_loss=0.191, val_micro_ap=0.767]         Epoch 7:   0%|          | 0/16 [00:00<?, ?it/s, v_num=8820, train_loss=0.195, train_micro_ap=0.784, val_loss=0.191, val_micro_ap=0.767][96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
Epoch 7:   6%|‚ñã         | 1/16 [00:07<01:52,  0.13it/s, v_num=8820, train_loss=0.195, train_micro_ap=0.784, val_loss=0.191, val_micro_ap=0.767]Epoch 7:   6%|‚ñã         | 1/16 [00:08<02:14,  0.11it/s, v_num=8820, train_loss=0.195, train_micro_ap=0.775, val_loss=0.191, val_micro_ap=0.767]Epoch 7:  12%|‚ñà‚ñé        | 2/16 [00:10<01:12,  0.19it/s, v_num=8820, train_loss=0.195, train_micro_ap=0.775, val_loss=0.191, val_micro_ap=0.767]Epoch 7:  12%|‚ñà‚ñé        | 2/16 [00:11<01:22,  0.17it/s, v_num=8820, train_loss=0.209, train_micro_ap=0.738, val_loss=0.191, val_micro_ap=0.767]Epoch 7:  19%|‚ñà‚ñâ        | 3/16 [00:13<00:57,  0.23it/s, v_num=8820, train_loss=0.209, train_micro_ap=0.738, val_loss=0.191, val_micro_ap=0.767]Epoch 7:  19%|‚ñà‚ñâ        | 3/16 [00:14<01:03,  0.20it/s, v_num=8820, train_loss=0.200, train_micro_ap=0.754, val_loss=0.191, val_micro_ap=0.767]Epoch 7:  25%|‚ñà‚ñà‚ñå       | 4/16 [00:16<00:48,  0.25it/s, v_num=8820, train_loss=0.200, train_micro_ap=0.754, val_loss=0.191, val_micro_ap=0.767]Epoch 7:  25%|‚ñà‚ñà‚ñå       | 4/16 [00:17<00:53,  0.23it/s, v_num=8820, train_loss=0.191, train_micro_ap=0.777, val_loss=0.191, val_micro_ap=0.767]Epoch 7:  31%|‚ñà‚ñà‚ñà‚ñè      | 5/16 [00:19<00:42,  0.26it/s, v_num=8820, train_loss=0.191, train_micro_ap=0.777, val_loss=0.191, val_micro_ap=0.767]Epoch 7:  31%|‚ñà‚ñà‚ñà‚ñè      | 5/16 [00:20<00:45,  0.24it/s, v_num=8820, train_loss=0.190, train_micro_ap=0.785, val_loss=0.191, val_micro_ap=0.767]Epoch 7:  38%|‚ñà‚ñà‚ñà‚ñä      | 6/16 [00:22<00:36,  0.27it/s, v_num=8820, train_loss=0.190, train_micro_ap=0.785, val_loss=0.191, val_micro_ap=0.767]Epoch 7:  38%|‚ñà‚ñà‚ñà‚ñä      | 6/16 [00:23<00:39,  0.26it/s, v_num=8820, train_loss=0.179, train_micro_ap=0.785, val_loss=0.191, val_micro_ap=0.767]Epoch 7:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 7/16 [00:24<00:31,  0.28it/s, v_num=8820, train_loss=0.179, train_micro_ap=0.785, val_loss=0.191, val_micro_ap=0.767]Epoch 7:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 7/16 [00:26<00:33,  0.27it/s, v_num=8820, train_loss=0.194, train_micro_ap=0.760, val_loss=0.191, val_micro_ap=0.767]Epoch 7:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 8/16 [00:27<00:27,  0.29it/s, v_num=8820, train_loss=0.194, train_micro_ap=0.760, val_loss=0.191, val_micro_ap=0.767]Epoch 7:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 8/16 [00:29<00:29,  0.27it/s, v_num=8820, train_loss=0.184, train_micro_ap=0.770, val_loss=0.191, val_micro_ap=0.767]Epoch 7:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 9/16 [00:30<00:23,  0.29it/s, v_num=8820, train_loss=0.184, train_micro_ap=0.770, val_loss=0.191, val_micro_ap=0.767]Epoch 7:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 9/16 [00:32<00:24,  0.28it/s, v_num=8820, train_loss=0.194, train_micro_ap=0.773, val_loss=0.191, val_micro_ap=0.767]Epoch 7:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 10/16 [00:33<00:20,  0.30it/s, v_num=8820, train_loss=0.194, train_micro_ap=0.773, val_loss=0.191, val_micro_ap=0.767]Epoch 7:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 10/16 [00:34<00:20,  0.29it/s, v_num=8820, train_loss=0.192, train_micro_ap=0.766, val_loss=0.191, val_micro_ap=0.767]Epoch 7:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 11/16 [00:36<00:16,  0.30it/s, v_num=8820, train_loss=0.192, train_micro_ap=0.766, val_loss=0.191, val_micro_ap=0.767]Epoch 7:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 11/16 [00:37<00:17,  0.29it/s, v_num=8820, train_loss=0.184, train_micro_ap=0.767, val_loss=0.191, val_micro_ap=0.767]Epoch 7:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 12/16 [00:39<00:13,  0.31it/s, v_num=8820, train_loss=0.184, train_micro_ap=0.767, val_loss=0.191, val_micro_ap=0.767]Epoch 7:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 12/16 [00:40<00:13,  0.30it/s, v_num=8820, train_loss=0.187, train_micro_ap=0.784, val_loss=0.191, val_micro_ap=0.767]Epoch 7:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 13/16 [00:41<00:09,  0.31it/s, v_num=8820, train_loss=0.187, train_micro_ap=0.784, val_loss=0.191, val_micro_ap=0.767]Epoch 7:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 13/16 [00:43<00:10,  0.30it/s, v_num=8820, train_loss=0.180, train_micro_ap=0.769, val_loss=0.191, val_micro_ap=0.767]Epoch 7:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 14/16 [00:44<00:06,  0.31it/s, v_num=8820, train_loss=0.180, train_micro_ap=0.769, val_loss=0.191, val_micro_ap=0.767]Epoch 7:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 14/16 [00:46<00:06,  0.30it/s, v_num=8820, train_loss=0.194, train_micro_ap=0.770, val_loss=0.191, val_micro_ap=0.767]Epoch 7:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 15/16 [00:47<00:03,  0.31it/s, v_num=8820, train_loss=0.194, train_micro_ap=0.770, val_loss=0.191, val_micro_ap=0.767]Epoch 7:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 15/16 [00:49<00:03,  0.31it/s, v_num=8820, train_loss=0.210, train_micro_ap=0.729, val_loss=0.191, val_micro_ap=0.767]Epoch 7: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 16/16 [00:49<00:00,  0.32it/s, v_num=8820, train_loss=0.210, train_micro_ap=0.729, val_loss=0.191, val_micro_ap=0.767]Epoch 7: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 16/16 [00:50<00:00,  0.31it/s, v_num=8820, train_loss=0.190, train_micro_ap=0.752, val_loss=0.191, val_micro_ap=0.767][96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m

Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:01<00:03,  0.96it/s][A
Validation DataLoader 0:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:02<00:02,  0.84it/s][A
Validation DataLoader 0:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:03<00:01,  0.81it/s][A
Validation DataLoader 0: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:04<00:00,  0.81it/s][A
/faststorage/arne/mamba/envs/cl_lora_env/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py:4631: UserWarning: No device id is provided via `init_process_group` or `barrier `. Using the current device set by the user. 
  warnings.warn(  # warn only once
Epoch 7, global step 128: 'val_loss' reached 0.18391 (best 0.18391), saving model to 'saved_models/lightning_logs/version_8820/checkpoints/epoch=7-step=128.ckpt' as top 1
                                                                      [AEpoch 7: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 16/16 [01:01<00:00,  0.26it/s, v_num=8820, train_loss=0.190, train_micro_ap=0.752, val_loss=0.184, val_micro_ap=0.777]Epoch 7: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 16/16 [01:02<00:00,  0.26it/s, v_num=8820, train_loss=0.190, train_micro_ap=0.752, val_loss=0.184, val_micro_ap=0.777]Epoch 7:   0%|          | 0/16 [00:00<?, ?it/s, v_num=8820, train_loss=0.190, train_micro_ap=0.752, val_loss=0.184, val_micro_ap=0.777]         Epoch 8:   0%|          | 0/16 [00:00<?, ?it/s, v_num=8820, train_loss=0.190, train_micro_ap=0.752, val_loss=0.184, val_micro_ap=0.777][96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
Epoch 8:   6%|‚ñã         | 1/16 [00:07<01:48,  0.14it/s, v_num=8820, train_loss=0.190, train_micro_ap=0.752, val_loss=0.184, val_micro_ap=0.777]Epoch 8:   6%|‚ñã         | 1/16 [00:08<02:10,  0.11it/s, v_num=8820, train_loss=0.198, train_micro_ap=0.765, val_loss=0.184, val_micro_ap=0.777]Epoch 8:  12%|‚ñà‚ñé        | 2/16 [00:10<01:10,  0.20it/s, v_num=8820, train_loss=0.198, train_micro_ap=0.765, val_loss=0.184, val_micro_ap=0.777]Epoch 8:  12%|‚ñà‚ñé        | 2/16 [00:11<01:21,  0.17it/s, v_num=8820, train_loss=0.183, train_micro_ap=0.769, val_loss=0.184, val_micro_ap=0.777]Epoch 8:  19%|‚ñà‚ñâ        | 3/16 [00:12<00:56,  0.23it/s, v_num=8820, train_loss=0.183, train_micro_ap=0.769, val_loss=0.184, val_micro_ap=0.777]Epoch 8:  19%|‚ñà‚ñâ        | 3/16 [00:14<01:02,  0.21it/s, v_num=8820, train_loss=0.179, train_micro_ap=0.806, val_loss=0.184, val_micro_ap=0.777]Epoch 8:  25%|‚ñà‚ñà‚ñå       | 4/16 [00:15<00:47,  0.25it/s, v_num=8820, train_loss=0.179, train_micro_ap=0.806, val_loss=0.184, val_micro_ap=0.777]Epoch 8:  25%|‚ñà‚ñà‚ñå       | 4/16 [00:17<00:51,  0.23it/s, v_num=8820, train_loss=0.189, train_micro_ap=0.771, val_loss=0.184, val_micro_ap=0.777]Epoch 8:  31%|‚ñà‚ñà‚ñà‚ñè      | 5/16 [00:18<00:41,  0.27it/s, v_num=8820, train_loss=0.189, train_micro_ap=0.771, val_loss=0.184, val_micro_ap=0.777]Epoch 8:  31%|‚ñà‚ñà‚ñà‚ñè      | 5/16 [00:20<00:44,  0.25it/s, v_num=8820, train_loss=0.188, train_micro_ap=0.768, val_loss=0.184, val_micro_ap=0.777]Epoch 8:  38%|‚ñà‚ñà‚ñà‚ñä      | 6/16 [00:21<00:35,  0.28it/s, v_num=8820, train_loss=0.188, train_micro_ap=0.768, val_loss=0.184, val_micro_ap=0.777]Epoch 8:  38%|‚ñà‚ñà‚ñà‚ñä      | 6/16 [00:22<00:38,  0.26it/s, v_num=8820, train_loss=0.194, train_micro_ap=0.769, val_loss=0.184, val_micro_ap=0.777]Epoch 8:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 7/16 [00:24<00:31,  0.29it/s, v_num=8820, train_loss=0.194, train_micro_ap=0.769, val_loss=0.184, val_micro_ap=0.777]Epoch 8:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 7/16 [00:25<00:33,  0.27it/s, v_num=8820, train_loss=0.183, train_micro_ap=0.761, val_loss=0.184, val_micro_ap=0.777]Epoch 8:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 8/16 [00:27<00:27,  0.29it/s, v_num=8820, train_loss=0.183, train_micro_ap=0.761, val_loss=0.184, val_micro_ap=0.777]Epoch 8:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 8/16 [00:28<00:28,  0.28it/s, v_num=8820, train_loss=0.189, train_micro_ap=0.770, val_loss=0.184, val_micro_ap=0.777]Epoch 8:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 9/16 [00:30<00:23,  0.30it/s, v_num=8820, train_loss=0.189, train_micro_ap=0.770, val_loss=0.184, val_micro_ap=0.777]Epoch 8:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 9/16 [00:31<00:24,  0.29it/s, v_num=8820, train_loss=0.193, train_micro_ap=0.769, val_loss=0.184, val_micro_ap=0.777]Epoch 8:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 10/16 [00:32<00:19,  0.30it/s, v_num=8820, train_loss=0.193, train_micro_ap=0.769, val_loss=0.184, val_micro_ap=0.777]Epoch 8:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 10/16 [00:34<00:20,  0.29it/s, v_num=8820, train_loss=0.196, train_micro_ap=0.764, val_loss=0.184, val_micro_ap=0.777]Epoch 8:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 11/16 [00:35<00:16,  0.31it/s, v_num=8820, train_loss=0.196, train_micro_ap=0.764, val_loss=0.184, val_micro_ap=0.777]Epoch 8:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 11/16 [00:37<00:16,  0.30it/s, v_num=8820, train_loss=0.176, train_micro_ap=0.791, val_loss=0.184, val_micro_ap=0.777]Epoch 8:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 12/16 [00:38<00:12,  0.31it/s, v_num=8820, train_loss=0.176, train_micro_ap=0.791, val_loss=0.184, val_micro_ap=0.777]Epoch 8:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 12/16 [00:39<00:13,  0.30it/s, v_num=8820, train_loss=0.193, train_micro_ap=0.760, val_loss=0.184, val_micro_ap=0.777]Epoch 8:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 13/16 [00:41<00:09,  0.31it/s, v_num=8820, train_loss=0.193, train_micro_ap=0.760, val_loss=0.184, val_micro_ap=0.777]Epoch 8:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 13/16 [00:42<00:09,  0.30it/s, v_num=8820, train_loss=0.191, train_micro_ap=0.783, val_loss=0.184, val_micro_ap=0.777]Epoch 8:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 14/16 [00:44<00:06,  0.32it/s, v_num=8820, train_loss=0.191, train_micro_ap=0.783, val_loss=0.184, val_micro_ap=0.777]Epoch 8:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 14/16 [00:45<00:06,  0.31it/s, v_num=8820, train_loss=0.188, train_micro_ap=0.766, val_loss=0.184, val_micro_ap=0.777]Epoch 8:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 15/16 [00:47<00:03,  0.32it/s, v_num=8820, train_loss=0.188, train_micro_ap=0.766, val_loss=0.184, val_micro_ap=0.777]Epoch 8:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 15/16 [00:48<00:03,  0.31it/s, v_num=8820, train_loss=0.183, train_micro_ap=0.798, val_loss=0.184, val_micro_ap=0.777]Epoch 8: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 16/16 [00:49<00:00,  0.32it/s, v_num=8820, train_loss=0.183, train_micro_ap=0.798, val_loss=0.184, val_micro_ap=0.777]Epoch 8: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 16/16 [00:50<00:00,  0.32it/s, v_num=8820, train_loss=0.191, train_micro_ap=0.782, val_loss=0.184, val_micro_ap=0.777][96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m

Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:01<00:03,  0.98it/s][A
Validation DataLoader 0:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:02<00:02,  0.86it/s][A
Validation DataLoader 0:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:03<00:01,  0.82it/s][A
Validation DataLoader 0: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:04<00:00,  0.82it/s][A
/faststorage/arne/mamba/envs/cl_lora_env/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py:4631: UserWarning: No device id is provided via `init_process_group` or `barrier `. Using the current device set by the user. 
  warnings.warn(  # warn only once
Epoch 8, global step 144: 'val_loss' reached 0.18221 (best 0.18221), saving model to 'saved_models/lightning_logs/version_8820/checkpoints/epoch=8-step=144.ckpt' as top 1
                                                                      [AEpoch 8: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 16/16 [01:00<00:00,  0.26it/s, v_num=8820, train_loss=0.191, train_micro_ap=0.782, val_loss=0.182, val_micro_ap=0.780]Epoch 8: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 16/16 [01:00<00:00,  0.26it/s, v_num=8820, train_loss=0.191, train_micro_ap=0.782, val_loss=0.182, val_micro_ap=0.780]Epoch 8:   0%|          | 0/16 [00:00<?, ?it/s, v_num=8820, train_loss=0.191, train_micro_ap=0.782, val_loss=0.182, val_micro_ap=0.780]         Epoch 9:   0%|          | 0/16 [00:00<?, ?it/s, v_num=8820, train_loss=0.191, train_micro_ap=0.782, val_loss=0.182, val_micro_ap=0.780][96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
Epoch 9:   6%|‚ñã         | 1/16 [00:06<01:43,  0.14it/s, v_num=8820, train_loss=0.191, train_micro_ap=0.782, val_loss=0.182, val_micro_ap=0.780]Epoch 9:   6%|‚ñã         | 1/16 [00:08<02:06,  0.12it/s, v_num=8820, train_loss=0.197, train_micro_ap=0.759, val_loss=0.182, val_micro_ap=0.780]Epoch 9:  12%|‚ñà‚ñé        | 2/16 [00:09<01:08,  0.20it/s, v_num=8820, train_loss=0.197, train_micro_ap=0.759, val_loss=0.182, val_micro_ap=0.780]Epoch 9:  12%|‚ñà‚ñé        | 2/16 [00:11<01:18,  0.18it/s, v_num=8820, train_loss=0.181, train_micro_ap=0.782, val_loss=0.182, val_micro_ap=0.780]Epoch 9:  19%|‚ñà‚ñâ        | 3/16 [00:12<00:54,  0.24it/s, v_num=8820, train_loss=0.181, train_micro_ap=0.782, val_loss=0.182, val_micro_ap=0.780]Epoch 9:  19%|‚ñà‚ñâ        | 3/16 [00:14<01:01,  0.21it/s, v_num=8820, train_loss=0.180, train_micro_ap=0.782, val_loss=0.182, val_micro_ap=0.780]Epoch 9:  25%|‚ñà‚ñà‚ñå       | 4/16 [00:15<00:47,  0.25it/s, v_num=8820, train_loss=0.180, train_micro_ap=0.782, val_loss=0.182, val_micro_ap=0.780]Epoch 9:  25%|‚ñà‚ñà‚ñå       | 4/16 [00:17<00:51,  0.23it/s, v_num=8820, train_loss=0.175, train_micro_ap=0.796, val_loss=0.182, val_micro_ap=0.780]Epoch 9:  31%|‚ñà‚ñà‚ñà‚ñè      | 5/16 [00:18<00:41,  0.27it/s, v_num=8820, train_loss=0.175, train_micro_ap=0.796, val_loss=0.182, val_micro_ap=0.780]Epoch 9:  31%|‚ñà‚ñà‚ñà‚ñè      | 5/16 [00:20<00:44,  0.25it/s, v_num=8820, train_loss=0.180, train_micro_ap=0.783, val_loss=0.182, val_micro_ap=0.780]Epoch 9:  38%|‚ñà‚ñà‚ñà‚ñä      | 6/16 [00:21<00:35,  0.28it/s, v_num=8820, train_loss=0.180, train_micro_ap=0.783, val_loss=0.182, val_micro_ap=0.780]Epoch 9:  38%|‚ñà‚ñà‚ñà‚ñä      | 6/16 [00:22<00:38,  0.26it/s, v_num=8820, train_loss=0.197, train_micro_ap=0.774, val_loss=0.182, val_micro_ap=0.780]Epoch 9:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 7/16 [00:24<00:31,  0.29it/s, v_num=8820, train_loss=0.197, train_micro_ap=0.774, val_loss=0.182, val_micro_ap=0.780]Epoch 9:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 7/16 [00:25<00:33,  0.27it/s, v_num=8820, train_loss=0.196, train_micro_ap=0.746, val_loss=0.182, val_micro_ap=0.780]Epoch 9:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 8/16 [00:27<00:27,  0.29it/s, v_num=8820, train_loss=0.196, train_micro_ap=0.746, val_loss=0.182, val_micro_ap=0.780]Epoch 9:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 8/16 [00:28<00:28,  0.28it/s, v_num=8820, train_loss=0.196, train_micro_ap=0.754, val_loss=0.182, val_micro_ap=0.780]Epoch 9:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 9/16 [00:30<00:23,  0.30it/s, v_num=8820, train_loss=0.196, train_micro_ap=0.754, val_loss=0.182, val_micro_ap=0.780]Epoch 9:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 9/16 [00:31<00:24,  0.29it/s, v_num=8820, train_loss=0.182, train_micro_ap=0.787, val_loss=0.182, val_micro_ap=0.780]Epoch 9:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 10/16 [00:32<00:19,  0.30it/s, v_num=8820, train_loss=0.182, train_micro_ap=0.787, val_loss=0.182, val_micro_ap=0.780]Epoch 9:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 10/16 [00:34<00:20,  0.29it/s, v_num=8820, train_loss=0.189, train_micro_ap=0.779, val_loss=0.182, val_micro_ap=0.780]Epoch 9:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 11/16 [00:35<00:16,  0.31it/s, v_num=8820, train_loss=0.189, train_micro_ap=0.779, val_loss=0.182, val_micro_ap=0.780]Epoch 9:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 11/16 [00:37<00:16,  0.30it/s, v_num=8820, train_loss=0.175, train_micro_ap=0.809, val_loss=0.182, val_micro_ap=0.780]Epoch 9:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 12/16 [00:38<00:12,  0.31it/s, v_num=8820, train_loss=0.175, train_micro_ap=0.809, val_loss=0.182, val_micro_ap=0.780]Epoch 9:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 12/16 [00:40<00:13,  0.30it/s, v_num=8820, train_loss=0.181, train_micro_ap=0.801, val_loss=0.182, val_micro_ap=0.780]Epoch 9:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 13/16 [00:41<00:09,  0.31it/s, v_num=8820, train_loss=0.181, train_micro_ap=0.801, val_loss=0.182, val_micro_ap=0.780]Epoch 9:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 13/16 [00:42<00:09,  0.30it/s, v_num=8820, train_loss=0.192, train_micro_ap=0.774, val_loss=0.182, val_micro_ap=0.780]Epoch 9:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 14/16 [00:44<00:06,  0.32it/s, v_num=8820, train_loss=0.192, train_micro_ap=0.774, val_loss=0.182, val_micro_ap=0.780]Epoch 9:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 14/16 [00:45<00:06,  0.31it/s, v_num=8820, train_loss=0.192, train_micro_ap=0.753, val_loss=0.182, val_micro_ap=0.780]Epoch 9:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 15/16 [00:47<00:03,  0.32it/s, v_num=8820, train_loss=0.192, train_micro_ap=0.753, val_loss=0.182, val_micro_ap=0.780]Epoch 9:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 15/16 [00:48<00:03,  0.31it/s, v_num=8820, train_loss=0.189, train_micro_ap=0.773, val_loss=0.182, val_micro_ap=0.780]Epoch 9: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 16/16 [00:49<00:00,  0.32it/s, v_num=8820, train_loss=0.189, train_micro_ap=0.773, val_loss=0.182, val_micro_ap=0.780]Epoch 9: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 16/16 [00:50<00:00,  0.32it/s, v_num=8820, train_loss=0.190, train_micro_ap=0.765, val_loss=0.182, val_micro_ap=0.780][96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m

Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:01<00:03,  0.97it/s][A
Validation DataLoader 0:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:02<00:02,  0.85it/s][A
Validation DataLoader 0:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:03<00:01,  0.81it/s][A
Validation DataLoader 0: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:04<00:00,  0.81it/s][A
/faststorage/arne/mamba/envs/cl_lora_env/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py:4631: UserWarning: No device id is provided via `init_process_group` or `barrier `. Using the current device set by the user. 
  warnings.warn(  # warn only once
Monitored metric val_loss did not improve in the last 5 records. Best score: 0.184. Signaling Trainer to stop.
Epoch 9, global step 160: 'val_loss' reached 0.18157 (best 0.18157), saving model to 'saved_models/lightning_logs/version_8820/checkpoints/epoch=9-step=160.ckpt' as top 1
                                                                      [AEpoch 9: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 16/16 [01:01<00:00,  0.26it/s, v_num=8820, train_loss=0.190, train_micro_ap=0.765, val_loss=0.182, val_micro_ap=0.781]Epoch 9: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 16/16 [01:01<00:00,  0.26it/s, v_num=8820, train_loss=0.190, train_micro_ap=0.765, val_loss=0.182, val_micro_ap=0.781]Epoch 9: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 16/16 [01:02<00:00,  0.26it/s, v_num=8820, train_loss=0.190, train_micro_ap=0.765, val_loss=0.182, val_micro_ap=0.781][96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
2025-06-16 19:02:36,495 INFO Training time: 635.21s
2025-06-16 19:02:37,365 INFO Saved: ./saved_models/step1-Finland.pkl

[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
/faststorage/arne/mamba/envs/cl_lora_env/lib/python3.9/site-packages/sklearn/metrics/_ranking.py:1033: UserWarning: No positive class found in y_true, recall is set to one for all thresholds.
  warnings.warn(
/faststorage/arne/mamba/envs/cl_lora_env/lib/python3.9/site-packages/sklearn/metrics/_ranking.py:1033: UserWarning: No positive class found in y_true, recall is set to one for all thresholds.
  warnings.warn(
/faststorage/arne/mamba/envs/cl_lora_env/lib/python3.9/site-packages/sklearn/metrics/_ranking.py:1033: UserWarning: No positive class found in y_true, recall is set to one for all thresholds.
  warnings.warn(
/faststorage/arne/mamba/envs/cl_lora_env/lib/python3.9/site-packages/sklearn/metrics/_ranking.py:1033: UserWarning: No positive class found in y_true, recall is set to one for all thresholds.
  warnings.warn(
/faststorage/arne/mamba/envs/cl_lora_env/lib/python3.9/site-packages/sklearn/metrics/_ranking.py:1033: UserWarning: No positive class found in y_true, recall is set to one for all thresholds.
  warnings.warn(
/faststorage/arne/mamba/envs/cl_lora_env/lib/python3.9/site-packages/sklearn/metrics/_ranking.py:1033: UserWarning: No positive class found in y_true, recall is set to one for all thresholds.
  warnings.warn(
/faststorage/arne/mamba/envs/cl_lora_env/lib/python3.9/site-packages/sklearn/metrics/_ranking.py:1033: UserWarning: No positive class found in y_true, recall is set to one for all thresholds.
  warnings.warn(
2025-06-16 19:02:43,509 INFO Eval time: 6.14s
2025-06-16 19:02:44,657 INFO Result: {'step': 1, 'countries': ('Finland',), 'train_time_s': 635.2142519950867, 'eval_time_s': 6.143418550491333, 'Finland_micro_ap': np.float64(0.7900148122711992), 'Finland_macro_ap': np.float64(0.2543823244420425), 'Finland_accuracy': 92.76842105263158, 'mean_micro_ap': np.float64(0.7900148122711992), 'mean_macro_ap': np.float64(0.2543823244420425), 'mean_accuracy': 92.76842105263158}
2025-06-16 19:02:44,657 INFO Step 2: Countries ['Finland', 'Ireland']
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/faststorage/arne/mamba/envs/cl_lora_env/lib/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:654: Checkpoint directory saved_models/lightning_logs/version_8820/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name              | Type              | Params | Mode 
----------------------------------------------------------------
0 | feature_extractor | LoRA_ViT_timm     | 87.4 M | eval 
1 | classifier        | Linear            | 14.6 K | train
2 | criterion         | BCEWithLogitsLoss | 0      | train
----------------------------------------------------------------
162 K     Trainable params
87.2 M    Non-trainable params
87.4 M    Total params
349.572   Total estimated model params size (MB)
2         Modules in train mode
272       Modules in eval mode
SLURM auto-requeueing enabled. Setting signal handlers.
/faststorage/arne/mamba/envs/cl_lora_env/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py:4631: UserWarning: No device id is provided via `init_process_group` or `barrier `. Using the current device set by the user. 
  warnings.warn(  # warn only once
/faststorage/arne/mamba/envs/cl_lora_env/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py:4631: UserWarning: No device id is provided via `init_process_group` or `barrier `. Using the current device set by the user. 
  warnings.warn(  # warn only once
/faststorage/arne/mamba/envs/cl_lora_env/lib/python3.9/site-packages/pytorch_lightning/loops/fit_loop.py:310: The number of training batches (16) is smaller than the logging interval Trainer(log_every_n_steps=50). Set a lower value for log_every_n_steps if you want to see logs for the training epoch.
Sanity Checking: |          | 0/? [00:00<?, ?it/s]Sanity Checking:   0%|          | 0/2 [00:00<?, ?it/s]Sanity Checking DataLoader 0:   0%|          | 0/2 [00:00<?, ?it/s]Sanity Checking DataLoader 0:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:01<00:01,  0.99it/s]Sanity Checking DataLoader 0: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 2/2 [00:02<00:00,  0.86it/s]                                                                           Training: |          | 0/? [00:00<?, ?it/s]Training:   0%|          | 0/16 [00:00<?, ?it/s]Epoch 0:   0%|          | 0/16 [00:00<?, ?it/s] Epoch 0:   6%|‚ñã         | 1/16 [00:06<01:32,  0.16it/s]Epoch 0:   6%|‚ñã         | 1/16 [00:07<01:54,  0.13it/s, v_num=8820, train_loss=0.712, train_micro_ap=0.108]Epoch 0:  12%|‚ñà‚ñé        | 2/16 [00:09<01:05,  0.21it/s, v_num=8820, train_loss=0.712, train_micro_ap=0.108]Epoch 0:  12%|‚ñà‚ñé        | 2/16 [00:10<01:15,  0.18it/s, v_num=8820, train_loss=0.439, train_micro_ap=0.305]Epoch 0:  19%|‚ñà‚ñâ        | 3/16 [00:12<00:52,  0.25it/s, v_num=8820, train_loss=0.439, train_micro_ap=0.305]Epoch 0:  19%|‚ñà‚ñâ        | 3/16 [00:13<00:59,  0.22it/s, v_num=8820, train_loss=0.297, train_micro_ap=0.577]Epoch 0:  25%|‚ñà‚ñà‚ñå       | 4/16 [00:15<00:45,  0.27it/s, v_num=8820, train_loss=0.297, train_micro_ap=0.577]Epoch 0:  25%|‚ñà‚ñà‚ñå       | 4/16 [00:16<00:49,  0.24it/s, v_num=8820, train_loss=0.252, train_micro_ap=0.574]Epoch 0:  31%|‚ñà‚ñà‚ñà‚ñè      | 5/16 [00:17<00:39,  0.28it/s, v_num=8820, train_loss=0.252, train_micro_ap=0.574]Epoch 0:  31%|‚ñà‚ñà‚ñà‚ñè      | 5/16 [00:19<00:42,  0.26it/s, v_num=8820, train_loss=0.257, train_micro_ap=0.589]Epoch 0:  38%|‚ñà‚ñà‚ñà‚ñä      | 6/16 [00:20<00:34,  0.29it/s, v_num=8820, train_loss=0.257, train_micro_ap=0.589]Epoch 0:  38%|‚ñà‚ñà‚ñà‚ñä      | 6/16 [00:22<00:37,  0.27it/s, v_num=8820, train_loss=0.235, train_micro_ap=0.612]Epoch 0:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 7/16 [00:23<00:30,  0.30it/s, v_num=8820, train_loss=0.235, train_micro_ap=0.612]Epoch 0:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 7/16 [00:25<00:32,  0.28it/s, v_num=8820, train_loss=0.209, train_micro_ap=0.656]Epoch 0:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 8/16 [00:26<00:26,  0.30it/s, v_num=8820, train_loss=0.209, train_micro_ap=0.656]Epoch 0:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 8/16 [00:27<00:27,  0.29it/s, v_num=8820, train_loss=0.244, train_micro_ap=0.628]Epoch 0:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 9/16 [00:29<00:22,  0.31it/s, v_num=8820, train_loss=0.244, train_micro_ap=0.628]Epoch 0:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 9/16 [00:30<00:23,  0.29it/s, v_num=8820, train_loss=0.236, train_micro_ap=0.631]Epoch 0:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 10/16 [00:32<00:19,  0.31it/s, v_num=8820, train_loss=0.236, train_micro_ap=0.631]Epoch 0:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 10/16 [00:33<00:20,  0.30it/s, v_num=8820, train_loss=0.215, train_micro_ap=0.644]Epoch 0:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 11/16 [00:34<00:15,  0.31it/s, v_num=8820, train_loss=0.215, train_micro_ap=0.644]Epoch 0:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 11/16 [00:36<00:16,  0.30it/s, v_num=8820, train_loss=0.212, train_micro_ap=0.650]Epoch 0:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 12/16 [00:37<00:12,  0.32it/s, v_num=8820, train_loss=0.212, train_micro_ap=0.650]Epoch 0:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 12/16 [00:39<00:13,  0.31it/s, v_num=8820, train_loss=0.221, train_micro_ap=0.666]Epoch 0:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 13/16 [00:40<00:09,  0.32it/s, v_num=8820, train_loss=0.221, train_micro_ap=0.666]Epoch 0:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 13/16 [00:42<00:09,  0.31it/s, v_num=8820, train_loss=0.217, train_micro_ap=0.650]Epoch 0:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 14/16 [00:43<00:06,  0.32it/s, v_num=8820, train_loss=0.217, train_micro_ap=0.650]Epoch 0:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 14/16 [00:44<00:06,  0.31it/s, v_num=8820, train_loss=0.210, train_micro_ap=0.659]Epoch 0:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 15/16 [00:46<00:03,  0.32it/s, v_num=8820, train_loss=0.210, train_micro_ap=0.659]Epoch 0:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 15/16 [00:47<00:03,  0.31it/s, v_num=8820, train_loss=0.213, train_micro_ap=0.668]Epoch 0: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 16/16 [00:48<00:00,  0.33it/s, v_num=8820, train_loss=0.213, train_micro_ap=0.668]Epoch 0: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 16/16 [00:49<00:00,  0.32it/s, v_num=8820, train_loss=0.195, train_micro_ap=0.669][96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m

Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:01<00:03,  0.97it/s][A
Validation DataLoader 0:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:02<00:02,  0.85it/s][A
Validation DataLoader 0:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:03<00:01,  0.82it/s][A
Validation DataLoader 0: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:04<00:00,  0.82it/s][A
/faststorage/arne/mamba/envs/cl_lora_env/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py:4631: UserWarning: No device id is provided via `init_process_group` or `barrier `. Using the current device set by the user. 
  warnings.warn(  # warn only once
Metric val_loss improved. New best score: 0.195
Epoch 0, global step 16: 'val_loss' reached 0.19548 (best 0.19548), saving model to 'saved_models/lightning_logs/version_8820/checkpoints/epoch=0-step=16.ckpt' as top 1
                                                                      [AEpoch 0: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 16/16 [01:00<00:00,  0.26it/s, v_num=8820, train_loss=0.195, train_micro_ap=0.669, val_loss=0.195, val_micro_ap=0.683]Epoch 0: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 16/16 [01:00<00:00,  0.26it/s, v_num=8820, train_loss=0.195, train_micro_ap=0.669, val_loss=0.195, val_micro_ap=0.683]Epoch 0:   0%|          | 0/16 [00:00<?, ?it/s, v_num=8820, train_loss=0.195, train_micro_ap=0.669, val_loss=0.195, val_micro_ap=0.683]         Epoch 1:   0%|          | 0/16 [00:00<?, ?it/s, v_num=8820, train_loss=0.195, train_micro_ap=0.669, val_loss=0.195, val_micro_ap=0.683][96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
Epoch 1:   6%|‚ñã         | 1/16 [00:07<01:53,  0.13it/s, v_num=8820, train_loss=0.195, train_micro_ap=0.669, val_loss=0.195, val_micro_ap=0.683]Epoch 1:   6%|‚ñã         | 1/16 [00:09<02:15,  0.11it/s, v_num=8820, train_loss=0.204, train_micro_ap=0.682, val_loss=0.195, val_micro_ap=0.683]Epoch 1:  12%|‚ñà‚ñé        | 2/16 [00:10<01:13,  0.19it/s, v_num=8820, train_loss=0.204, train_micro_ap=0.682, val_loss=0.195, val_micro_ap=0.683]Epoch 1:  12%|‚ñà‚ñé        | 2/16 [00:11<01:23,  0.17it/s, v_num=8820, train_loss=0.206, train_micro_ap=0.667, val_loss=0.195, val_micro_ap=0.683]Epoch 1:  19%|‚ñà‚ñâ        | 3/16 [00:13<00:57,  0.23it/s, v_num=8820, train_loss=0.206, train_micro_ap=0.667, val_loss=0.195, val_micro_ap=0.683]Epoch 1:  19%|‚ñà‚ñâ        | 3/16 [00:14<01:04,  0.20it/s, v_num=8820, train_loss=0.197, train_micro_ap=0.662, val_loss=0.195, val_micro_ap=0.683]Epoch 1:  25%|‚ñà‚ñà‚ñå       | 4/16 [00:16<00:48,  0.25it/s, v_num=8820, train_loss=0.197, train_micro_ap=0.662, val_loss=0.195, val_micro_ap=0.683]Epoch 1:  25%|‚ñà‚ñà‚ñå       | 4/16 [00:17<00:52,  0.23it/s, v_num=8820, train_loss=0.201, train_micro_ap=0.679, val_loss=0.195, val_micro_ap=0.683]Epoch 1:  31%|‚ñà‚ñà‚ñà‚ñè      | 5/16 [00:18<00:41,  0.26it/s, v_num=8820, train_loss=0.201, train_micro_ap=0.679, val_loss=0.195, val_micro_ap=0.683]Epoch 1:  31%|‚ñà‚ñà‚ñà‚ñè      | 5/16 [00:20<00:44,  0.24it/s, v_num=8820, train_loss=0.192, train_micro_ap=0.675, val_loss=0.195, val_micro_ap=0.683]Epoch 1:  38%|‚ñà‚ñà‚ñà‚ñä      | 6/16 [00:21<00:36,  0.28it/s, v_num=8820, train_loss=0.192, train_micro_ap=0.675, val_loss=0.195, val_micro_ap=0.683]Epoch 1:  38%|‚ñà‚ñà‚ñà‚ñä      | 6/16 [00:23<00:38,  0.26it/s, v_num=8820, train_loss=0.189, train_micro_ap=0.692, val_loss=0.195, val_micro_ap=0.683]Epoch 1:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 7/16 [00:24<00:31,  0.28it/s, v_num=8820, train_loss=0.189, train_micro_ap=0.692, val_loss=0.195, val_micro_ap=0.683]Epoch 1:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 7/16 [00:26<00:33,  0.27it/s, v_num=8820, train_loss=0.186, train_micro_ap=0.693, val_loss=0.195, val_micro_ap=0.683]Epoch 1:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 8/16 [00:27<00:27,  0.29it/s, v_num=8820, train_loss=0.186, train_micro_ap=0.693, val_loss=0.195, val_micro_ap=0.683]Epoch 1:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 8/16 [00:28<00:28,  0.28it/s, v_num=8820, train_loss=0.171, train_micro_ap=0.726, val_loss=0.195, val_micro_ap=0.683]Epoch 1:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 9/16 [00:30<00:23,  0.30it/s, v_num=8820, train_loss=0.171, train_micro_ap=0.726, val_loss=0.195, val_micro_ap=0.683]Epoch 1:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 9/16 [00:31<00:24,  0.28it/s, v_num=8820, train_loss=0.192, train_micro_ap=0.681, val_loss=0.195, val_micro_ap=0.683]Epoch 1:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 10/16 [00:33<00:19,  0.30it/s, v_num=8820, train_loss=0.192, train_micro_ap=0.681, val_loss=0.195, val_micro_ap=0.683]Epoch 1:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 10/16 [00:34<00:20,  0.29it/s, v_num=8820, train_loss=0.176, train_micro_ap=0.722, val_loss=0.195, val_micro_ap=0.683]Epoch 1:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 11/16 [00:35<00:16,  0.31it/s, v_num=8820, train_loss=0.176, train_micro_ap=0.722, val_loss=0.195, val_micro_ap=0.683]Epoch 1:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 11/16 [00:37<00:17,  0.29it/s, v_num=8820, train_loss=0.191, train_micro_ap=0.690, val_loss=0.195, val_micro_ap=0.683]Epoch 1:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 12/16 [00:38<00:12,  0.31it/s, v_num=8820, train_loss=0.191, train_micro_ap=0.690, val_loss=0.195, val_micro_ap=0.683]Epoch 1:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 12/16 [00:40<00:13,  0.30it/s, v_num=8820, train_loss=0.209, train_micro_ap=0.673, val_loss=0.195, val_micro_ap=0.683]Epoch 1:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 13/16 [00:41<00:09,  0.31it/s, v_num=8820, train_loss=0.209, train_micro_ap=0.673, val_loss=0.195, val_micro_ap=0.683]Epoch 1:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 13/16 [00:43<00:09,  0.30it/s, v_num=8820, train_loss=0.186, train_micro_ap=0.714, val_loss=0.195, val_micro_ap=0.683]Epoch 1:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 14/16 [00:44<00:06,  0.32it/s, v_num=8820, train_loss=0.186, train_micro_ap=0.714, val_loss=0.195, val_micro_ap=0.683]Epoch 1:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 14/16 [00:45<00:06,  0.31it/s, v_num=8820, train_loss=0.208, train_micro_ap=0.665, val_loss=0.195, val_micro_ap=0.683]Epoch 1:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 15/16 [00:47<00:03,  0.32it/s, v_num=8820, train_loss=0.208, train_micro_ap=0.665, val_loss=0.195, val_micro_ap=0.683]Epoch 1:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 15/16 [00:48<00:03,  0.31it/s, v_num=8820, train_loss=0.189, train_micro_ap=0.711, val_loss=0.195, val_micro_ap=0.683]Epoch 1: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 16/16 [00:49<00:00,  0.32it/s, v_num=8820, train_loss=0.189, train_micro_ap=0.711, val_loss=0.195, val_micro_ap=0.683]Epoch 1: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 16/16 [00:50<00:00,  0.32it/s, v_num=8820, train_loss=0.171, train_micro_ap=0.714, val_loss=0.195, val_micro_ap=0.683][96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m

Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:01<00:03,  0.97it/s][A
Validation DataLoader 0:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:02<00:02,  0.85it/s][A
Validation DataLoader 0:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:03<00:01,  0.81it/s][A
Validation DataLoader 0: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:04<00:00,  0.81it/s][A
/faststorage/arne/mamba/envs/cl_lora_env/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py:4631: UserWarning: No device id is provided via `init_process_group` or `barrier `. Using the current device set by the user. 
  warnings.warn(  # warn only once
Metric val_loss improved by 0.019 >= min_delta = 0.01. New best score: 0.176
Epoch 1, global step 32: 'val_loss' reached 0.17605 (best 0.17605), saving model to 'saved_models/lightning_logs/version_8820/checkpoints/epoch=1-step=32.ckpt' as top 1
                                                                      [AEpoch 1: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 16/16 [01:01<00:00,  0.26it/s, v_num=8820, train_loss=0.171, train_micro_ap=0.714, val_loss=0.176, val_micro_ap=0.714]Epoch 1: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 16/16 [01:01<00:00,  0.26it/s, v_num=8820, train_loss=0.171, train_micro_ap=0.714, val_loss=0.176, val_micro_ap=0.714]Epoch 1:   0%|          | 0/16 [00:00<?, ?it/s, v_num=8820, train_loss=0.171, train_micro_ap=0.714, val_loss=0.176, val_micro_ap=0.714]         Epoch 2:   0%|          | 0/16 [00:00<?, ?it/s, v_num=8820, train_loss=0.171, train_micro_ap=0.714, val_loss=0.176, val_micro_ap=0.714][96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
Epoch 2:   6%|‚ñã         | 1/16 [00:07<01:49,  0.14it/s, v_num=8820, train_loss=0.171, train_micro_ap=0.714, val_loss=0.176, val_micro_ap=0.714]Epoch 2:   6%|‚ñã         | 1/16 [00:08<02:11,  0.11it/s, v_num=8820, train_loss=0.180, train_micro_ap=0.711, val_loss=0.176, val_micro_ap=0.714]Epoch 2:  12%|‚ñà‚ñé        | 2/16 [00:10<01:11,  0.20it/s, v_num=8820, train_loss=0.180, train_micro_ap=0.711, val_loss=0.176, val_micro_ap=0.714]Epoch 2:  12%|‚ñà‚ñé        | 2/16 [00:11<01:21,  0.17it/s, v_num=8820, train_loss=0.181, train_micro_ap=0.705, val_loss=0.176, val_micro_ap=0.714]Epoch 2:  19%|‚ñà‚ñâ        | 3/16 [00:13<00:56,  0.23it/s, v_num=8820, train_loss=0.181, train_micro_ap=0.705, val_loss=0.176, val_micro_ap=0.714]Epoch 2:  19%|‚ñà‚ñâ        | 3/16 [00:14<01:02,  0.21it/s, v_num=8820, train_loss=0.209, train_micro_ap=0.674, val_loss=0.176, val_micro_ap=0.714]Epoch 2:  25%|‚ñà‚ñà‚ñå       | 4/16 [00:16<00:48,  0.25it/s, v_num=8820, train_loss=0.209, train_micro_ap=0.674, val_loss=0.176, val_micro_ap=0.714]Epoch 2:  25%|‚ñà‚ñà‚ñå       | 4/16 [00:17<00:53,  0.23it/s, v_num=8820, train_loss=0.186, train_micro_ap=0.705, val_loss=0.176, val_micro_ap=0.714]Epoch 2:  31%|‚ñà‚ñà‚ñà‚ñè      | 5/16 [00:19<00:42,  0.26it/s, v_num=8820, train_loss=0.186, train_micro_ap=0.705, val_loss=0.176, val_micro_ap=0.714]Epoch 2:  31%|‚ñà‚ñà‚ñà‚ñè      | 5/16 [00:20<00:45,  0.24it/s, v_num=8820, train_loss=0.160, train_micro_ap=0.735, val_loss=0.176, val_micro_ap=0.714]Epoch 2:  38%|‚ñà‚ñà‚ñà‚ñä      | 6/16 [00:21<00:36,  0.27it/s, v_num=8820, train_loss=0.160, train_micro_ap=0.735, val_loss=0.176, val_micro_ap=0.714]Epoch 2:  38%|‚ñà‚ñà‚ñà‚ñä      | 6/16 [00:23<00:39,  0.26it/s, v_num=8820, train_loss=0.186, train_micro_ap=0.699, val_loss=0.176, val_micro_ap=0.714]Epoch 2:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 7/16 [00:24<00:31,  0.28it/s, v_num=8820, train_loss=0.186, train_micro_ap=0.699, val_loss=0.176, val_micro_ap=0.714]Epoch 2:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 7/16 [00:26<00:33,  0.27it/s, v_num=8820, train_loss=0.185, train_micro_ap=0.702, val_loss=0.176, val_micro_ap=0.714]Epoch 2:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 8/16 [00:27<00:27,  0.29it/s, v_num=8820, train_loss=0.185, train_micro_ap=0.702, val_loss=0.176, val_micro_ap=0.714]Epoch 2:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 8/16 [00:29<00:29,  0.27it/s, v_num=8820, train_loss=0.181, train_micro_ap=0.709, val_loss=0.176, val_micro_ap=0.714]Epoch 2:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 9/16 [00:30<00:23,  0.30it/s, v_num=8820, train_loss=0.181, train_micro_ap=0.709, val_loss=0.176, val_micro_ap=0.714]Epoch 2:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 9/16 [00:31<00:24,  0.28it/s, v_num=8820, train_loss=0.189, train_micro_ap=0.691, val_loss=0.176, val_micro_ap=0.714]Epoch 2:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 10/16 [00:33<00:19,  0.30it/s, v_num=8820, train_loss=0.189, train_micro_ap=0.691, val_loss=0.176, val_micro_ap=0.714]Epoch 2:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 10/16 [00:34<00:20,  0.29it/s, v_num=8820, train_loss=0.170, train_micro_ap=0.717, val_loss=0.176, val_micro_ap=0.714]Epoch 2:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 11/16 [00:36<00:16,  0.30it/s, v_num=8820, train_loss=0.170, train_micro_ap=0.717, val_loss=0.176, val_micro_ap=0.714]Epoch 2:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 11/16 [00:37<00:17,  0.29it/s, v_num=8820, train_loss=0.185, train_micro_ap=0.715, val_loss=0.176, val_micro_ap=0.714]Epoch 2:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 12/16 [00:39<00:13,  0.31it/s, v_num=8820, train_loss=0.185, train_micro_ap=0.715, val_loss=0.176, val_micro_ap=0.714]Epoch 2:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 12/16 [00:40<00:13,  0.30it/s, v_num=8820, train_loss=0.176, train_micro_ap=0.714, val_loss=0.176, val_micro_ap=0.714]Epoch 2:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 13/16 [00:41<00:09,  0.31it/s, v_num=8820, train_loss=0.176, train_micro_ap=0.714, val_loss=0.176, val_micro_ap=0.714]Epoch 2:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 13/16 [00:43<00:09,  0.30it/s, v_num=8820, train_loss=0.180, train_micro_ap=0.720, val_loss=0.176, val_micro_ap=0.714]Epoch 2:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 14/16 [00:44<00:06,  0.31it/s, v_num=8820, train_loss=0.180, train_micro_ap=0.720, val_loss=0.176, val_micro_ap=0.714]Epoch 2:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 14/16 [00:46<00:06,  0.30it/s, v_num=8820, train_loss=0.180, train_micro_ap=0.704, val_loss=0.176, val_micro_ap=0.714]Epoch 2:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 15/16 [00:47<00:03,  0.32it/s, v_num=8820, train_loss=0.180, train_micro_ap=0.704, val_loss=0.176, val_micro_ap=0.714]Epoch 2:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 15/16 [00:48<00:03,  0.31it/s, v_num=8820, train_loss=0.193, train_micro_ap=0.691, val_loss=0.176, val_micro_ap=0.714]Epoch 2: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 16/16 [00:49<00:00,  0.32it/s, v_num=8820, train_loss=0.193, train_micro_ap=0.691, val_loss=0.176, val_micro_ap=0.714]Epoch 2: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 16/16 [00:50<00:00,  0.32it/s, v_num=8820, train_loss=0.190, train_micro_ap=0.707, val_loss=0.176, val_micro_ap=0.714][96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m

Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:01<00:03,  0.98it/s][A
Validation DataLoader 0:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:02<00:02,  0.85it/s][A
Validation DataLoader 0:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:03<00:01,  0.81it/s][A
Validation DataLoader 0: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:04<00:00,  0.81it/s][A
/faststorage/arne/mamba/envs/cl_lora_env/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py:4631: UserWarning: No device id is provided via `init_process_group` or `barrier `. Using the current device set by the user. 
  warnings.warn(  # warn only once
Epoch 2, global step 48: 'val_loss' reached 0.17204 (best 0.17204), saving model to 'saved_models/lightning_logs/version_8820/checkpoints/epoch=2-step=48.ckpt' as top 1
                                                                      [AEpoch 2: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 16/16 [01:02<00:00,  0.26it/s, v_num=8820, train_loss=0.190, train_micro_ap=0.707, val_loss=0.172, val_micro_ap=0.720]Epoch 2: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 16/16 [01:02<00:00,  0.26it/s, v_num=8820, train_loss=0.190, train_micro_ap=0.707, val_loss=0.172, val_micro_ap=0.720]Epoch 2:   0%|          | 0/16 [00:00<?, ?it/s, v_num=8820, train_loss=0.190, train_micro_ap=0.707, val_loss=0.172, val_micro_ap=0.720]         Epoch 3:   0%|          | 0/16 [00:00<?, ?it/s, v_num=8820, train_loss=0.190, train_micro_ap=0.707, val_loss=0.172, val_micro_ap=0.720][96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
Epoch 3:   6%|‚ñã         | 1/16 [00:07<01:54,  0.13it/s, v_num=8820, train_loss=0.190, train_micro_ap=0.707, val_loss=0.172, val_micro_ap=0.720]Epoch 3:   6%|‚ñã         | 1/16 [00:09<02:16,  0.11it/s, v_num=8820, train_loss=0.214, train_micro_ap=0.653, val_loss=0.172, val_micro_ap=0.720]Epoch 3:  12%|‚ñà‚ñé        | 2/16 [00:10<01:15,  0.18it/s, v_num=8820, train_loss=0.214, train_micro_ap=0.653, val_loss=0.172, val_micro_ap=0.720]Epoch 3:  12%|‚ñà‚ñé        | 2/16 [00:12<01:26,  0.16it/s, v_num=8820, train_loss=0.197, train_micro_ap=0.682, val_loss=0.172, val_micro_ap=0.720]Epoch 3:  19%|‚ñà‚ñâ        | 3/16 [00:13<00:59,  0.22it/s, v_num=8820, train_loss=0.197, train_micro_ap=0.682, val_loss=0.172, val_micro_ap=0.720]Epoch 3:  19%|‚ñà‚ñâ        | 3/16 [00:15<01:05,  0.20it/s, v_num=8820, train_loss=0.175, train_micro_ap=0.734, val_loss=0.172, val_micro_ap=0.720]Epoch 3:  25%|‚ñà‚ñà‚ñå       | 4/16 [00:16<00:49,  0.24it/s, v_num=8820, train_loss=0.175, train_micro_ap=0.734, val_loss=0.172, val_micro_ap=0.720]Epoch 3:  25%|‚ñà‚ñà‚ñå       | 4/16 [00:18<00:54,  0.22it/s, v_num=8820, train_loss=0.164, train_micro_ap=0.738, val_loss=0.172, val_micro_ap=0.720]Epoch 3:  31%|‚ñà‚ñà‚ñà‚ñè      | 5/16 [00:19<00:42,  0.26it/s, v_num=8820, train_loss=0.164, train_micro_ap=0.738, val_loss=0.172, val_micro_ap=0.720]Epoch 3:  31%|‚ñà‚ñà‚ñà‚ñè      | 5/16 [00:20<00:45,  0.24it/s, v_num=8820, train_loss=0.188, train_micro_ap=0.695, val_loss=0.172, val_micro_ap=0.720]Epoch 3:  38%|‚ñà‚ñà‚ñà‚ñä      | 6/16 [00:22<00:37,  0.27it/s, v_num=8820, train_loss=0.188, train_micro_ap=0.695, val_loss=0.172, val_micro_ap=0.720]Epoch 3:  38%|‚ñà‚ñà‚ñà‚ñä      | 6/16 [00:23<00:39,  0.25it/s, v_num=8820, train_loss=0.167, train_micro_ap=0.724, val_loss=0.172, val_micro_ap=0.720]Epoch 3:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 7/16 [00:25<00:32,  0.28it/s, v_num=8820, train_loss=0.167, train_micro_ap=0.724, val_loss=0.172, val_micro_ap=0.720]Epoch 3:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 7/16 [00:26<00:34,  0.26it/s, v_num=8820, train_loss=0.189, train_micro_ap=0.690, val_loss=0.172, val_micro_ap=0.720]Epoch 3:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 8/16 [00:27<00:27,  0.29it/s, v_num=8820, train_loss=0.189, train_micro_ap=0.690, val_loss=0.172, val_micro_ap=0.720]Epoch 3:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 8/16 [00:29<00:29,  0.27it/s, v_num=8820, train_loss=0.179, train_micro_ap=0.716, val_loss=0.172, val_micro_ap=0.720]Epoch 3:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 9/16 [00:30<00:23,  0.29it/s, v_num=8820, train_loss=0.179, train_micro_ap=0.716, val_loss=0.172, val_micro_ap=0.720]Epoch 3:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 9/16 [00:32<00:25,  0.28it/s, v_num=8820, train_loss=0.166, train_micro_ap=0.748, val_loss=0.172, val_micro_ap=0.720]Epoch 3:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 10/16 [00:33<00:20,  0.30it/s, v_num=8820, train_loss=0.166, train_micro_ap=0.748, val_loss=0.172, val_micro_ap=0.720]Epoch 3:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 10/16 [00:35<00:21,  0.28it/s, v_num=8820, train_loss=0.182, train_micro_ap=0.713, val_loss=0.172, val_micro_ap=0.720]Epoch 3:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 11/16 [00:36<00:16,  0.30it/s, v_num=8820, train_loss=0.182, train_micro_ap=0.713, val_loss=0.172, val_micro_ap=0.720]Epoch 3:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 11/16 [00:37<00:17,  0.29it/s, v_num=8820, train_loss=0.178, train_micro_ap=0.721, val_loss=0.172, val_micro_ap=0.720]Epoch 3:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 12/16 [00:39<00:13,  0.31it/s, v_num=8820, train_loss=0.178, train_micro_ap=0.721, val_loss=0.172, val_micro_ap=0.720]Epoch 3:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 12/16 [00:40<00:13,  0.29it/s, v_num=8820, train_loss=0.186, train_micro_ap=0.701, val_loss=0.172, val_micro_ap=0.720]Epoch 3:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 13/16 [00:42<00:09,  0.31it/s, v_num=8820, train_loss=0.186, train_micro_ap=0.701, val_loss=0.172, val_micro_ap=0.720]Epoch 3:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 13/16 [00:43<00:10,  0.30it/s, v_num=8820, train_loss=0.175, train_micro_ap=0.705, val_loss=0.172, val_micro_ap=0.720]Epoch 3:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 14/16 [00:45<00:06,  0.31it/s, v_num=8820, train_loss=0.175, train_micro_ap=0.705, val_loss=0.172, val_micro_ap=0.720]Epoch 3:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 14/16 [00:46<00:06,  0.30it/s, v_num=8820, train_loss=0.173, train_micro_ap=0.735, val_loss=0.172, val_micro_ap=0.720]Epoch 3:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 15/16 [00:47<00:03,  0.31it/s, v_num=8820, train_loss=0.173, train_micro_ap=0.735, val_loss=0.172, val_micro_ap=0.720]Epoch 3:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 15/16 [00:49<00:03,  0.30it/s, v_num=8820, train_loss=0.192, train_micro_ap=0.686, val_loss=0.172, val_micro_ap=0.720]Epoch 3: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 16/16 [00:50<00:00,  0.32it/s, v_num=8820, train_loss=0.192, train_micro_ap=0.686, val_loss=0.172, val_micro_ap=0.720]Epoch 3: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 16/16 [00:51<00:00,  0.31it/s, v_num=8820, train_loss=0.174, train_micro_ap=0.724, val_loss=0.172, val_micro_ap=0.720][96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m

Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:01<00:03,  0.98it/s][A
Validation DataLoader 0:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:02<00:02,  0.85it/s][A
Validation DataLoader 0:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:03<00:01,  0.81it/s][A
Validation DataLoader 0: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:04<00:00,  0.82it/s][A
/faststorage/arne/mamba/envs/cl_lora_env/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py:4631: UserWarning: No device id is provided via `init_process_group` or `barrier `. Using the current device set by the user. 
  warnings.warn(  # warn only once
Epoch 3, global step 64: 'val_loss' was not in top 1
                                                                      [AEpoch 3: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 16/16 [01:02<00:00,  0.26it/s, v_num=8820, train_loss=0.174, train_micro_ap=0.724, val_loss=0.175, val_micro_ap=0.717]Epoch 3: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 16/16 [01:02<00:00,  0.26it/s, v_num=8820, train_loss=0.174, train_micro_ap=0.724, val_loss=0.175, val_micro_ap=0.717]Epoch 3:   0%|          | 0/16 [00:00<?, ?it/s, v_num=8820, train_loss=0.174, train_micro_ap=0.724, val_loss=0.175, val_micro_ap=0.717]         Epoch 4:   0%|          | 0/16 [00:00<?, ?it/s, v_num=8820, train_loss=0.174, train_micro_ap=0.724, val_loss=0.175, val_micro_ap=0.717][96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
Epoch 4:   6%|‚ñã         | 1/16 [00:08<02:01,  0.12it/s, v_num=8820, train_loss=0.174, train_micro_ap=0.724, val_loss=0.175, val_micro_ap=0.717]Epoch 4:   6%|‚ñã         | 1/16 [00:09<02:23,  0.10it/s, v_num=8820, train_loss=0.170, train_micro_ap=0.722, val_loss=0.175, val_micro_ap=0.717]Epoch 4:  12%|‚ñà‚ñé        | 2/16 [00:11<01:18,  0.18it/s, v_num=8820, train_loss=0.170, train_micro_ap=0.722, val_loss=0.175, val_micro_ap=0.717]Epoch 4:  12%|‚ñà‚ñé        | 2/16 [00:12<01:29,  0.16it/s, v_num=8820, train_loss=0.180, train_micro_ap=0.711, val_loss=0.175, val_micro_ap=0.717]Epoch 4:  19%|‚ñà‚ñâ        | 3/16 [00:14<01:01,  0.21it/s, v_num=8820, train_loss=0.180, train_micro_ap=0.711, val_loss=0.175, val_micro_ap=0.717]Epoch 4:  19%|‚ñà‚ñâ        | 3/16 [00:15<01:07,  0.19it/s, v_num=8820, train_loss=0.183, train_micro_ap=0.713, val_loss=0.175, val_micro_ap=0.717]Epoch 4:  25%|‚ñà‚ñà‚ñå       | 4/16 [00:17<00:51,  0.24it/s, v_num=8820, train_loss=0.183, train_micro_ap=0.713, val_loss=0.175, val_micro_ap=0.717]Epoch 4:  25%|‚ñà‚ñà‚ñå       | 4/16 [00:18<00:55,  0.22it/s, v_num=8820, train_loss=0.205, train_micro_ap=0.665, val_loss=0.175, val_micro_ap=0.717]Epoch 4:  31%|‚ñà‚ñà‚ñà‚ñè      | 5/16 [00:19<00:43,  0.25it/s, v_num=8820, train_loss=0.205, train_micro_ap=0.665, val_loss=0.175, val_micro_ap=0.717]Epoch 4:  31%|‚ñà‚ñà‚ñà‚ñè      | 5/16 [00:21<00:46,  0.23it/s, v_num=8820, train_loss=0.167, train_micro_ap=0.728, val_loss=0.175, val_micro_ap=0.717]Epoch 4:  38%|‚ñà‚ñà‚ñà‚ñä      | 6/16 [00:22<00:37,  0.26it/s, v_num=8820, train_loss=0.167, train_micro_ap=0.728, val_loss=0.175, val_micro_ap=0.717]Epoch 4:  38%|‚ñà‚ñà‚ñà‚ñä      | 6/16 [00:24<00:40,  0.25it/s, v_num=8820, train_loss=0.189, train_micro_ap=0.695, val_loss=0.175, val_micro_ap=0.717]Epoch 4:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 7/16 [00:25<00:32,  0.27it/s, v_num=8820, train_loss=0.189, train_micro_ap=0.695, val_loss=0.175, val_micro_ap=0.717]Epoch 4:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 7/16 [00:27<00:34,  0.26it/s, v_num=8820, train_loss=0.187, train_micro_ap=0.702, val_loss=0.175, val_micro_ap=0.717]Epoch 4:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 8/16 [00:28<00:28,  0.28it/s, v_num=8820, train_loss=0.187, train_micro_ap=0.702, val_loss=0.175, val_micro_ap=0.717]Epoch 4:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 8/16 [00:29<00:29,  0.27it/s, v_num=8820, train_loss=0.180, train_micro_ap=0.719, val_loss=0.175, val_micro_ap=0.717]Epoch 4:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 9/16 [00:31<00:24,  0.29it/s, v_num=8820, train_loss=0.180, train_micro_ap=0.719, val_loss=0.175, val_micro_ap=0.717]Epoch 4:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 9/16 [00:32<00:25,  0.28it/s, v_num=8820, train_loss=0.176, train_micro_ap=0.733, val_loss=0.175, val_micro_ap=0.717]Epoch 4:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 10/16 [00:34<00:20,  0.29it/s, v_num=8820, train_loss=0.176, train_micro_ap=0.733, val_loss=0.175, val_micro_ap=0.717]Epoch 4:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 10/16 [00:35<00:21,  0.28it/s, v_num=8820, train_loss=0.158, train_micro_ap=0.750, val_loss=0.175, val_micro_ap=0.717]Epoch 4:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 11/16 [00:36<00:16,  0.30it/s, v_num=8820, train_loss=0.158, train_micro_ap=0.750, val_loss=0.175, val_micro_ap=0.717]Epoch 4:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 11/16 [00:38<00:17,  0.29it/s, v_num=8820, train_loss=0.171, train_micro_ap=0.709, val_loss=0.175, val_micro_ap=0.717]Epoch 4:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 12/16 [00:39<00:13,  0.30it/s, v_num=8820, train_loss=0.171, train_micro_ap=0.709, val_loss=0.175, val_micro_ap=0.717]Epoch 4:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 12/16 [00:41<00:13,  0.29it/s, v_num=8820, train_loss=0.174, train_micro_ap=0.715, val_loss=0.175, val_micro_ap=0.717]Epoch 4:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 13/16 [00:42<00:09,  0.31it/s, v_num=8820, train_loss=0.174, train_micro_ap=0.715, val_loss=0.175, val_micro_ap=0.717]Epoch 4:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 13/16 [00:44<00:10,  0.29it/s, v_num=8820, train_loss=0.179, train_micro_ap=0.720, val_loss=0.175, val_micro_ap=0.717]Epoch 4:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 14/16 [00:45<00:06,  0.31it/s, v_num=8820, train_loss=0.179, train_micro_ap=0.720, val_loss=0.175, val_micro_ap=0.717]Epoch 4:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 14/16 [00:46<00:06,  0.30it/s, v_num=8820, train_loss=0.187, train_micro_ap=0.695, val_loss=0.175, val_micro_ap=0.717]Epoch 4:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 15/16 [00:48<00:03,  0.31it/s, v_num=8820, train_loss=0.187, train_micro_ap=0.695, val_loss=0.175, val_micro_ap=0.717]Epoch 4:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 15/16 [00:49<00:03,  0.30it/s, v_num=8820, train_loss=0.196, train_micro_ap=0.679, val_loss=0.175, val_micro_ap=0.717]Epoch 4: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 16/16 [00:50<00:00,  0.32it/s, v_num=8820, train_loss=0.196, train_micro_ap=0.679, val_loss=0.175, val_micro_ap=0.717]Epoch 4: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 16/16 [00:51<00:00,  0.31it/s, v_num=8820, train_loss=0.191, train_micro_ap=0.704, val_loss=0.175, val_micro_ap=0.717][96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m

Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:01<00:03,  0.97it/s][A
Validation DataLoader 0:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:02<00:02,  0.84it/s][A
Validation DataLoader 0:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:03<00:01,  0.81it/s][A
Validation DataLoader 0: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:04<00:00,  0.81it/s][A
/faststorage/arne/mamba/envs/cl_lora_env/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py:4631: UserWarning: No device id is provided via `init_process_group` or `barrier `. Using the current device set by the user. 
  warnings.warn(  # warn only once
Epoch 4, global step 80: 'val_loss' was not in top 1
                                                                      [AEpoch 4: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 16/16 [01:02<00:00,  0.26it/s, v_num=8820, train_loss=0.191, train_micro_ap=0.704, val_loss=0.174, val_micro_ap=0.721]Epoch 4: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 16/16 [01:02<00:00,  0.26it/s, v_num=8820, train_loss=0.191, train_micro_ap=0.704, val_loss=0.174, val_micro_ap=0.721]Epoch 4:   0%|          | 0/16 [00:00<?, ?it/s, v_num=8820, train_loss=0.191, train_micro_ap=0.704, val_loss=0.174, val_micro_ap=0.721]         Epoch 5:   0%|          | 0/16 [00:00<?, ?it/s, v_num=8820, train_loss=0.191, train_micro_ap=0.704, val_loss=0.174, val_micro_ap=0.721][96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
Epoch 5:   6%|‚ñã         | 1/16 [00:08<02:00,  0.12it/s, v_num=8820, train_loss=0.191, train_micro_ap=0.704, val_loss=0.174, val_micro_ap=0.721]Epoch 5:   6%|‚ñã         | 1/16 [00:09<02:22,  0.11it/s, v_num=8820, train_loss=0.186, train_micro_ap=0.702, val_loss=0.174, val_micro_ap=0.721]Epoch 5:  12%|‚ñà‚ñé        | 2/16 [00:11<01:18,  0.18it/s, v_num=8820, train_loss=0.186, train_micro_ap=0.702, val_loss=0.174, val_micro_ap=0.721]Epoch 5:  12%|‚ñà‚ñé        | 2/16 [00:12<01:29,  0.16it/s, v_num=8820, train_loss=0.175, train_micro_ap=0.724, val_loss=0.174, val_micro_ap=0.721]Epoch 5:  19%|‚ñà‚ñâ        | 3/16 [00:14<01:01,  0.21it/s, v_num=8820, train_loss=0.175, train_micro_ap=0.724, val_loss=0.174, val_micro_ap=0.721]Epoch 5:  19%|‚ñà‚ñâ        | 3/16 [00:15<01:07,  0.19it/s, v_num=8820, train_loss=0.181, train_micro_ap=0.702, val_loss=0.174, val_micro_ap=0.721]Epoch 5:  25%|‚ñà‚ñà‚ñå       | 4/16 [00:17<00:51,  0.23it/s, v_num=8820, train_loss=0.181, train_micro_ap=0.702, val_loss=0.174, val_micro_ap=0.721]Epoch 5:  25%|‚ñà‚ñà‚ñå       | 4/16 [00:18<00:55,  0.22it/s, v_num=8820, train_loss=0.184, train_micro_ap=0.696, val_loss=0.174, val_micro_ap=0.721]Epoch 5:  31%|‚ñà‚ñà‚ñà‚ñè      | 5/16 [00:19<00:43,  0.25it/s, v_num=8820, train_loss=0.184, train_micro_ap=0.696, val_loss=0.174, val_micro_ap=0.721]Epoch 5:  31%|‚ñà‚ñà‚ñà‚ñè      | 5/16 [00:21<00:46,  0.23it/s, v_num=8820, train_loss=0.192, train_micro_ap=0.697, val_loss=0.174, val_micro_ap=0.721]Epoch 5:  38%|‚ñà‚ñà‚ñà‚ñä      | 6/16 [00:22<00:37,  0.26it/s, v_num=8820, train_loss=0.192, train_micro_ap=0.697, val_loss=0.174, val_micro_ap=0.721]Epoch 5:  38%|‚ñà‚ñà‚ñà‚ñä      | 6/16 [00:24<00:40,  0.25it/s, v_num=8820, train_loss=0.172, train_micro_ap=0.733, val_loss=0.174, val_micro_ap=0.721]Epoch 5:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 7/16 [00:25<00:32,  0.27it/s, v_num=8820, train_loss=0.172, train_micro_ap=0.733, val_loss=0.174, val_micro_ap=0.721]Epoch 5:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 7/16 [00:27<00:34,  0.26it/s, v_num=8820, train_loss=0.175, train_micro_ap=0.718, val_loss=0.174, val_micro_ap=0.721]Epoch 5:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 8/16 [00:28<00:28,  0.28it/s, v_num=8820, train_loss=0.175, train_micro_ap=0.718, val_loss=0.174, val_micro_ap=0.721]Epoch 5:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 8/16 [00:29<00:29,  0.27it/s, v_num=8820, train_loss=0.181, train_micro_ap=0.713, val_loss=0.174, val_micro_ap=0.721]Epoch 5:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 9/16 [00:31<00:24,  0.29it/s, v_num=8820, train_loss=0.181, train_micro_ap=0.713, val_loss=0.174, val_micro_ap=0.721]Epoch 5:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 9/16 [00:32<00:25,  0.27it/s, v_num=8820, train_loss=0.175, train_micro_ap=0.707, val_loss=0.174, val_micro_ap=0.721]Epoch 5:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 10/16 [00:34<00:20,  0.29it/s, v_num=8820, train_loss=0.175, train_micro_ap=0.707, val_loss=0.174, val_micro_ap=0.721]Epoch 5:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 10/16 [00:35<00:21,  0.28it/s, v_num=8820, train_loss=0.163, train_micro_ap=0.751, val_loss=0.174, val_micro_ap=0.721]Epoch 5:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 11/16 [00:36<00:16,  0.30it/s, v_num=8820, train_loss=0.163, train_micro_ap=0.751, val_loss=0.174, val_micro_ap=0.721]Epoch 5:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 11/16 [00:38<00:17,  0.29it/s, v_num=8820, train_loss=0.193, train_micro_ap=0.688, val_loss=0.174, val_micro_ap=0.721]Epoch 5:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 12/16 [00:39<00:13,  0.30it/s, v_num=8820, train_loss=0.193, train_micro_ap=0.688, val_loss=0.174, val_micro_ap=0.721]Epoch 5:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 12/16 [00:41<00:13,  0.29it/s, v_num=8820, train_loss=0.188, train_micro_ap=0.697, val_loss=0.174, val_micro_ap=0.721]Epoch 5:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 13/16 [00:42<00:09,  0.30it/s, v_num=8820, train_loss=0.188, train_micro_ap=0.697, val_loss=0.174, val_micro_ap=0.721]Epoch 5:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 13/16 [00:44<00:10,  0.29it/s, v_num=8820, train_loss=0.175, train_micro_ap=0.714, val_loss=0.174, val_micro_ap=0.721]Epoch 5:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 14/16 [00:45<00:06,  0.31it/s, v_num=8820, train_loss=0.175, train_micro_ap=0.714, val_loss=0.174, val_micro_ap=0.721]Epoch 5:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 14/16 [00:46<00:06,  0.30it/s, v_num=8820, train_loss=0.188, train_micro_ap=0.702, val_loss=0.174, val_micro_ap=0.721]Epoch 5:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 15/16 [00:48<00:03,  0.31it/s, v_num=8820, train_loss=0.188, train_micro_ap=0.702, val_loss=0.174, val_micro_ap=0.721]Epoch 5:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 15/16 [00:49<00:03,  0.30it/s, v_num=8820, train_loss=0.179, train_micro_ap=0.708, val_loss=0.174, val_micro_ap=0.721]Epoch 5: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 16/16 [00:50<00:00,  0.32it/s, v_num=8820, train_loss=0.179, train_micro_ap=0.708, val_loss=0.174, val_micro_ap=0.721]Epoch 5: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 16/16 [00:51<00:00,  0.31it/s, v_num=8820, train_loss=0.170, train_micro_ap=0.720, val_loss=0.174, val_micro_ap=0.721][96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m

Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:01<00:03,  0.97it/s][A
Validation DataLoader 0:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:02<00:02,  0.84it/s][A
Validation DataLoader 0:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:03<00:01,  0.81it/s][A
Validation DataLoader 0: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:04<00:00,  0.81it/s][A
/faststorage/arne/mamba/envs/cl_lora_env/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py:4631: UserWarning: No device id is provided via `init_process_group` or `barrier `. Using the current device set by the user. 
  warnings.warn(  # warn only once
Epoch 5, global step 96: 'val_loss' reached 0.17143 (best 0.17143), saving model to 'saved_models/lightning_logs/version_8820/checkpoints/epoch=5-step=96.ckpt' as top 1
                                                                      [AEpoch 5: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 16/16 [01:03<00:00,  0.25it/s, v_num=8820, train_loss=0.170, train_micro_ap=0.720, val_loss=0.171, val_micro_ap=0.724]Epoch 5: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 16/16 [01:03<00:00,  0.25it/s, v_num=8820, train_loss=0.170, train_micro_ap=0.720, val_loss=0.171, val_micro_ap=0.724]Epoch 5:   0%|          | 0/16 [00:00<?, ?it/s, v_num=8820, train_loss=0.170, train_micro_ap=0.720, val_loss=0.171, val_micro_ap=0.724]         Epoch 6:   0%|          | 0/16 [00:00<?, ?it/s, v_num=8820, train_loss=0.170, train_micro_ap=0.720, val_loss=0.171, val_micro_ap=0.724][96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
Epoch 6:   6%|‚ñã         | 1/16 [00:07<01:58,  0.13it/s, v_num=8820, train_loss=0.170, train_micro_ap=0.720, val_loss=0.171, val_micro_ap=0.724]Epoch 6:   6%|‚ñã         | 1/16 [00:09<02:20,  0.11it/s, v_num=8820, train_loss=0.180, train_micro_ap=0.725, val_loss=0.171, val_micro_ap=0.724]Epoch 6:  12%|‚ñà‚ñé        | 2/16 [00:11<01:17,  0.18it/s, v_num=8820, train_loss=0.180, train_micro_ap=0.725, val_loss=0.171, val_micro_ap=0.724]Epoch 6:  12%|‚ñà‚ñé        | 2/16 [00:12<01:28,  0.16it/s, v_num=8820, train_loss=0.166, train_micro_ap=0.725, val_loss=0.171, val_micro_ap=0.724]Epoch 6:  19%|‚ñà‚ñâ        | 3/16 [00:13<01:00,  0.21it/s, v_num=8820, train_loss=0.166, train_micro_ap=0.725, val_loss=0.171, val_micro_ap=0.724]Epoch 6:  19%|‚ñà‚ñâ        | 3/16 [00:15<01:06,  0.19it/s, v_num=8820, train_loss=0.167, train_micro_ap=0.727, val_loss=0.171, val_micro_ap=0.724]Epoch 6:  25%|‚ñà‚ñà‚ñå       | 4/16 [00:16<00:50,  0.24it/s, v_num=8820, train_loss=0.167, train_micro_ap=0.727, val_loss=0.171, val_micro_ap=0.724]Epoch 6:  25%|‚ñà‚ñà‚ñå       | 4/16 [00:18<00:54,  0.22it/s, v_num=8820, train_loss=0.162, train_micro_ap=0.743, val_loss=0.171, val_micro_ap=0.724]Epoch 6:  31%|‚ñà‚ñà‚ñà‚ñè      | 5/16 [00:19<00:43,  0.25it/s, v_num=8820, train_loss=0.162, train_micro_ap=0.743, val_loss=0.171, val_micro_ap=0.724]Epoch 6:  31%|‚ñà‚ñà‚ñà‚ñè      | 5/16 [00:21<00:46,  0.24it/s, v_num=8820, train_loss=0.193, train_micro_ap=0.688, val_loss=0.171, val_micro_ap=0.724]Epoch 6:  38%|‚ñà‚ñà‚ñà‚ñä      | 6/16 [00:22<00:37,  0.27it/s, v_num=8820, train_loss=0.193, train_micro_ap=0.688, val_loss=0.171, val_micro_ap=0.724]Epoch 6:  38%|‚ñà‚ñà‚ñà‚ñä      | 6/16 [00:24<00:40,  0.25it/s, v_num=8820, train_loss=0.193, train_micro_ap=0.694, val_loss=0.171, val_micro_ap=0.724]Epoch 6:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 7/16 [00:25<00:32,  0.28it/s, v_num=8820, train_loss=0.193, train_micro_ap=0.694, val_loss=0.171, val_micro_ap=0.724]Epoch 6:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 7/16 [00:26<00:34,  0.26it/s, v_num=8820, train_loss=0.174, train_micro_ap=0.719, val_loss=0.171, val_micro_ap=0.724]Epoch 6:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 8/16 [00:28<00:28,  0.28it/s, v_num=8820, train_loss=0.174, train_micro_ap=0.719, val_loss=0.171, val_micro_ap=0.724]Epoch 6:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 8/16 [00:29<00:29,  0.27it/s, v_num=8820, train_loss=0.175, train_micro_ap=0.731, val_loss=0.171, val_micro_ap=0.724]Epoch 6:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 9/16 [00:31<00:24,  0.29it/s, v_num=8820, train_loss=0.175, train_micro_ap=0.731, val_loss=0.171, val_micro_ap=0.724]Epoch 6:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 9/16 [00:32<00:25,  0.28it/s, v_num=8820, train_loss=0.202, train_micro_ap=0.685, val_loss=0.171, val_micro_ap=0.724]Epoch 6:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 10/16 [00:33<00:20,  0.29it/s, v_num=8820, train_loss=0.202, train_micro_ap=0.685, val_loss=0.171, val_micro_ap=0.724]Epoch 6:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 10/16 [00:35<00:21,  0.28it/s, v_num=8820, train_loss=0.159, train_micro_ap=0.741, val_loss=0.171, val_micro_ap=0.724]Epoch 6:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 11/16 [00:36<00:16,  0.30it/s, v_num=8820, train_loss=0.159, train_micro_ap=0.741, val_loss=0.171, val_micro_ap=0.724]Epoch 6:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 11/16 [00:38<00:17,  0.29it/s, v_num=8820, train_loss=0.185, train_micro_ap=0.705, val_loss=0.171, val_micro_ap=0.724]Epoch 6:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 12/16 [00:39<00:13,  0.30it/s, v_num=8820, train_loss=0.185, train_micro_ap=0.705, val_loss=0.171, val_micro_ap=0.724]Epoch 6:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 12/16 [00:41<00:13,  0.29it/s, v_num=8820, train_loss=0.165, train_micro_ap=0.730, val_loss=0.171, val_micro_ap=0.724]Epoch 6:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 13/16 [00:42<00:09,  0.31it/s, v_num=8820, train_loss=0.165, train_micro_ap=0.730, val_loss=0.171, val_micro_ap=0.724]Epoch 6:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 13/16 [00:43<00:10,  0.30it/s, v_num=8820, train_loss=0.191, train_micro_ap=0.699, val_loss=0.171, val_micro_ap=0.724]Epoch 6:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 14/16 [00:45<00:06,  0.31it/s, v_num=8820, train_loss=0.191, train_micro_ap=0.699, val_loss=0.171, val_micro_ap=0.724]Epoch 6:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 14/16 [00:46<00:06,  0.30it/s, v_num=8820, train_loss=0.196, train_micro_ap=0.690, val_loss=0.171, val_micro_ap=0.724]Epoch 6:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 15/16 [00:48<00:03,  0.31it/s, v_num=8820, train_loss=0.196, train_micro_ap=0.690, val_loss=0.171, val_micro_ap=0.724]Epoch 6:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 15/16 [00:49<00:03,  0.30it/s, v_num=8820, train_loss=0.170, train_micro_ap=0.725, val_loss=0.171, val_micro_ap=0.724]Epoch 6: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 16/16 [00:50<00:00,  0.32it/s, v_num=8820, train_loss=0.170, train_micro_ap=0.725, val_loss=0.171, val_micro_ap=0.724]Epoch 6: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 16/16 [00:51<00:00,  0.31it/s, v_num=8820, train_loss=0.187, train_micro_ap=0.695, val_loss=0.171, val_micro_ap=0.724][96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m

Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:01<00:03,  0.97it/s][A
Validation DataLoader 0:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:02<00:02,  0.85it/s][A
Validation DataLoader 0:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:03<00:01,  0.81it/s][A
Validation DataLoader 0: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:04<00:00,  0.81it/s][A
/faststorage/arne/mamba/envs/cl_lora_env/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py:4631: UserWarning: No device id is provided via `init_process_group` or `barrier `. Using the current device set by the user. 
  warnings.warn(  # warn only once
Monitored metric val_loss did not improve in the last 5 records. Best score: 0.176. Signaling Trainer to stop.
Epoch 6, global step 112: 'val_loss' reached 0.17062 (best 0.17062), saving model to 'saved_models/lightning_logs/version_8820/checkpoints/epoch=6-step=112.ckpt' as top 1
                                                                      [AEpoch 6: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 16/16 [01:02<00:00,  0.26it/s, v_num=8820, train_loss=0.187, train_micro_ap=0.695, val_loss=0.171, val_micro_ap=0.724]Epoch 6: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 16/16 [01:02<00:00,  0.26it/s, v_num=8820, train_loss=0.187, train_micro_ap=0.695, val_loss=0.171, val_micro_ap=0.724]Epoch 6: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 16/16 [01:03<00:00,  0.25it/s, v_num=8820, train_loss=0.187, train_micro_ap=0.695, val_loss=0.171, val_micro_ap=0.724][96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
2025-06-16 19:10:16,522 INFO Training time: 451.84s
2025-06-16 19:10:17,198 INFO Saved: ./saved_models/step2-Ireland.pkl

[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
/faststorage/arne/mamba/envs/cl_lora_env/lib/python3.9/site-packages/sklearn/metrics/_ranking.py:1033: UserWarning: No positive class found in y_true, recall is set to one for all thresholds.
  warnings.warn(
/faststorage/arne/mamba/envs/cl_lora_env/lib/python3.9/site-packages/sklearn/metrics/_ranking.py:1033: UserWarning: No positive class found in y_true, recall is set to one for all thresholds.
  warnings.warn(
/faststorage/arne/mamba/envs/cl_lora_env/lib/python3.9/site-packages/sklearn/metrics/_ranking.py:1033: UserWarning: No positive class found in y_true, recall is set to one for all thresholds.
  warnings.warn(
/faststorage/arne/mamba/envs/cl_lora_env/lib/python3.9/site-packages/sklearn/metrics/_ranking.py:1033: UserWarning: No positive class found in y_true, recall is set to one for all thresholds.
  warnings.warn(
/faststorage/arne/mamba/envs/cl_lora_env/lib/python3.9/site-packages/sklearn/metrics/_ranking.py:1033: UserWarning: No positive class found in y_true, recall is set to one for all thresholds.
  warnings.warn(
/faststorage/arne/mamba/envs/cl_lora_env/lib/python3.9/site-packages/sklearn/metrics/_ranking.py:1033: UserWarning: No positive class found in y_true, recall is set to one for all thresholds.
  warnings.warn(
/faststorage/arne/mamba/envs/cl_lora_env/lib/python3.9/site-packages/sklearn/metrics/_ranking.py:1033: UserWarning: No positive class found in y_true, recall is set to one for all thresholds.
  warnings.warn(
[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
/faststorage/arne/mamba/envs/cl_lora_env/lib/python3.9/site-packages/sklearn/metrics/_ranking.py:1033: UserWarning: No positive class found in y_true, recall is set to one for all thresholds.
  warnings.warn(
/faststorage/arne/mamba/envs/cl_lora_env/lib/python3.9/site-packages/sklearn/metrics/_ranking.py:1033: UserWarning: No positive class found in y_true, recall is set to one for all thresholds.
  warnings.warn(
/faststorage/arne/mamba/envs/cl_lora_env/lib/python3.9/site-packages/sklearn/metrics/_ranking.py:1033: UserWarning: No positive class found in y_true, recall is set to one for all thresholds.
  warnings.warn(
/faststorage/arne/mamba/envs/cl_lora_env/lib/python3.9/site-packages/sklearn/metrics/_ranking.py:1033: UserWarning: No positive class found in y_true, recall is set to one for all thresholds.
  warnings.warn(
2025-06-16 19:10:28,937 INFO Eval time: 11.74s
2025-06-16 19:10:28,937 INFO Result: {'step': 2, 'countries': ('Finland', 'Ireland'), 'train_time_s': 451.84036111831665, 'eval_time_s': 11.738583326339722, 'Finland_micro_ap': np.float64(0.36903000277150444), 'Finland_macro_ap': np.float64(0.25874942416308433), 'Finland_accuracy': 83.41052631578947, 'Ireland_micro_ap': np.float64(0.7618393881870983), 'Ireland_macro_ap': np.float64(0.20478556967311398), 'Ireland_accuracy': 93.05263157894737, 'mean_micro_ap': np.float64(0.5654346954793014), 'mean_macro_ap': np.float64(0.23176749691809917), 'mean_accuracy': 88.23157894736842}
2025-06-16 19:10:28,937 INFO Step 3: Countries ['Finland', 'Ireland', 'Serbia']
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/faststorage/arne/mamba/envs/cl_lora_env/lib/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:654: Checkpoint directory saved_models/lightning_logs/version_8820/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name              | Type              | Params | Mode 
----------------------------------------------------------------
0 | feature_extractor | LoRA_ViT_timm     | 87.4 M | eval 
1 | classifier        | Linear            | 14.6 K | train
2 | criterion         | BCEWithLogitsLoss | 0      | train
----------------------------------------------------------------
162 K     Trainable params
87.2 M    Non-trainable params
87.4 M    Total params
349.572   Total estimated model params size (MB)
2         Modules in train mode
272       Modules in eval mode
SLURM auto-requeueing enabled. Setting signal handlers.
/faststorage/arne/mamba/envs/cl_lora_env/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py:4631: UserWarning: No device id is provided via `init_process_group` or `barrier `. Using the current device set by the user. 
  warnings.warn(  # warn only once
/faststorage/arne/mamba/envs/cl_lora_env/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py:4631: UserWarning: No device id is provided via `init_process_group` or `barrier `. Using the current device set by the user. 
  warnings.warn(  # warn only once
/faststorage/arne/mamba/envs/cl_lora_env/lib/python3.9/site-packages/pytorch_lightning/loops/fit_loop.py:310: The number of training batches (16) is smaller than the logging interval Trainer(log_every_n_steps=50). Set a lower value for log_every_n_steps if you want to see logs for the training epoch.
Sanity Checking: |          | 0/? [00:00<?, ?it/s]Sanity Checking:   0%|          | 0/2 [00:00<?, ?it/s]Sanity Checking DataLoader 0:   0%|          | 0/2 [00:00<?, ?it/s]Sanity Checking DataLoader 0:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:00<00:00,  1.00it/s]Sanity Checking DataLoader 0: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 2/2 [00:02<00:00,  0.86it/s]                                                                           Training: |          | 0/? [00:00<?, ?it/s]Training:   0%|          | 0/16 [00:00<?, ?it/s]Epoch 0:   0%|          | 0/16 [00:00<?, ?it/s] Epoch 0:   6%|‚ñã         | 1/16 [00:06<01:39,  0.15it/s]Epoch 0:   6%|‚ñã         | 1/16 [00:08<02:01,  0.12it/s, v_num=8820, train_loss=0.763, train_micro_ap=0.151]Epoch 0:  12%|‚ñà‚ñé        | 2/16 [00:09<01:08,  0.21it/s, v_num=8820, train_loss=0.763, train_micro_ap=0.151]Epoch 0:  12%|‚ñà‚ñé        | 2/16 [00:11<01:18,  0.18it/s, v_num=8820, train_loss=0.474, train_micro_ap=0.272]Epoch 0:  19%|‚ñà‚ñâ        | 3/16 [00:12<00:54,  0.24it/s, v_num=8820, train_loss=0.474, train_micro_ap=0.272]Epoch 0:  19%|‚ñà‚ñâ        | 3/16 [00:14<01:00,  0.21it/s, v_num=8820, train_loss=0.352, train_micro_ap=0.403]Epoch 0:  25%|‚ñà‚ñà‚ñå       | 4/16 [00:15<00:46,  0.26it/s, v_num=8820, train_loss=0.352, train_micro_ap=0.403]Epoch 0:  25%|‚ñà‚ñà‚ñå       | 4/16 [00:16<00:50,  0.24it/s, v_num=8820, train_loss=0.305, train_micro_ap=0.513]Epoch 0:  31%|‚ñà‚ñà‚ñà‚ñè      | 5/16 [00:18<00:40,  0.27it/s, v_num=8820, train_loss=0.305, train_micro_ap=0.513]Epoch 0:  31%|‚ñà‚ñà‚ñà‚ñè      | 5/16 [00:19<00:43,  0.25it/s, v_num=8820, train_loss=0.291, train_micro_ap=0.476]Epoch 0:  38%|‚ñà‚ñà‚ñà‚ñä      | 6/16 [00:21<00:35,  0.28it/s, v_num=8820, train_loss=0.291, train_micro_ap=0.476]Epoch 0:  38%|‚ñà‚ñà‚ñà‚ñä      | 6/16 [00:22<00:37,  0.27it/s, v_num=8820, train_loss=0.284, train_micro_ap=0.545]Epoch 0:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 7/16 [00:23<00:30,  0.29it/s, v_num=8820, train_loss=0.284, train_micro_ap=0.545]Epoch 0:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 7/16 [00:25<00:32,  0.28it/s, v_num=8820, train_loss=0.285, train_micro_ap=0.516]Epoch 0:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 8/16 [00:26<00:26,  0.30it/s, v_num=8820, train_loss=0.285, train_micro_ap=0.516]Epoch 0:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 8/16 [00:28<00:28,  0.28it/s, v_num=8820, train_loss=0.301, train_micro_ap=0.526]Epoch 0:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 9/16 [00:29<00:23,  0.30it/s, v_num=8820, train_loss=0.301, train_micro_ap=0.526]Epoch 0:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 9/16 [00:31<00:24,  0.29it/s, v_num=8820, train_loss=0.287, train_micro_ap=0.502]Epoch 0:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 10/16 [00:32<00:19,  0.31it/s, v_num=8820, train_loss=0.287, train_micro_ap=0.502]Epoch 0:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 10/16 [00:33<00:20,  0.29it/s, v_num=8820, train_loss=0.276, train_micro_ap=0.539]Epoch 0:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 11/16 [00:35<00:16,  0.31it/s, v_num=8820, train_loss=0.276, train_micro_ap=0.539]Epoch 0:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 11/16 [00:36<00:16,  0.30it/s, v_num=8820, train_loss=0.282, train_micro_ap=0.557]Epoch 0:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 12/16 [00:38<00:12,  0.31it/s, v_num=8820, train_loss=0.282, train_micro_ap=0.557]Epoch 0:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 12/16 [00:39<00:13,  0.30it/s, v_num=8820, train_loss=0.299, train_micro_ap=0.550]Epoch 0:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 13/16 [00:40<00:09,  0.32it/s, v_num=8820, train_loss=0.299, train_micro_ap=0.550]Epoch 0:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 13/16 [00:42<00:09,  0.31it/s, v_num=8820, train_loss=0.296, train_micro_ap=0.534]Epoch 0:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 14/16 [00:43<00:06,  0.32it/s, v_num=8820, train_loss=0.296, train_micro_ap=0.534]Epoch 0:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 14/16 [00:45<00:06,  0.31it/s, v_num=8820, train_loss=0.292, train_micro_ap=0.569]Epoch 0:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 15/16 [00:46<00:03,  0.32it/s, v_num=8820, train_loss=0.292, train_micro_ap=0.569]Epoch 0:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 15/16 [00:48<00:03,  0.31it/s, v_num=8820, train_loss=0.287, train_micro_ap=0.512]Epoch 0: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 16/16 [00:48<00:00,  0.33it/s, v_num=8820, train_loss=0.287, train_micro_ap=0.512]Epoch 0: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 16/16 [00:49<00:00,  0.32it/s, v_num=8820, train_loss=0.293, train_micro_ap=0.497][96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m

Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:01<00:03,  0.98it/s][A
Validation DataLoader 0:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:02<00:02,  0.85it/s][A
Validation DataLoader 0:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:03<00:01,  0.81it/s][A
Validation DataLoader 0: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:04<00:00,  0.81it/s][A
/faststorage/arne/mamba/envs/cl_lora_env/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py:4631: UserWarning: No device id is provided via `init_process_group` or `barrier `. Using the current device set by the user. 
  warnings.warn(  # warn only once
Metric val_loss improved. New best score: 0.282
Epoch 0, global step 16: 'val_loss' reached 0.28232 (best 0.28232), saving model to 'saved_models/lightning_logs/version_8820/checkpoints/epoch=0-step=16.ckpt' as top 1
                                                                      [AEpoch 0: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 16/16 [01:00<00:00,  0.26it/s, v_num=8820, train_loss=0.293, train_micro_ap=0.497, val_loss=0.282, val_micro_ap=0.539]Epoch 0: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 16/16 [01:01<00:00,  0.26it/s, v_num=8820, train_loss=0.293, train_micro_ap=0.497, val_loss=0.282, val_micro_ap=0.539]Epoch 0:   0%|          | 0/16 [00:00<?, ?it/s, v_num=8820, train_loss=0.293, train_micro_ap=0.497, val_loss=0.282, val_micro_ap=0.539]         Epoch 1:   0%|          | 0/16 [00:00<?, ?it/s, v_num=8820, train_loss=0.293, train_micro_ap=0.497, val_loss=0.282, val_micro_ap=0.539][96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
Epoch 1:   6%|‚ñã         | 1/16 [00:07<01:53,  0.13it/s, v_num=8820, train_loss=0.293, train_micro_ap=0.497, val_loss=0.282, val_micro_ap=0.539]Epoch 1:   6%|‚ñã         | 1/16 [00:09<02:15,  0.11it/s, v_num=8820, train_loss=0.282, train_micro_ap=0.554, val_loss=0.282, val_micro_ap=0.539]Epoch 1:  12%|‚ñà‚ñé        | 2/16 [00:10<01:15,  0.19it/s, v_num=8820, train_loss=0.282, train_micro_ap=0.554, val_loss=0.282, val_micro_ap=0.539]Epoch 1:  12%|‚ñà‚ñé        | 2/16 [00:12<01:25,  0.16it/s, v_num=8820, train_loss=0.287, train_micro_ap=0.534, val_loss=0.282, val_micro_ap=0.539]Epoch 1:  19%|‚ñà‚ñâ        | 3/16 [00:13<00:59,  0.22it/s, v_num=8820, train_loss=0.287, train_micro_ap=0.534, val_loss=0.282, val_micro_ap=0.539]Epoch 1:  19%|‚ñà‚ñâ        | 3/16 [00:15<01:05,  0.20it/s, v_num=8820, train_loss=0.283, train_micro_ap=0.529, val_loss=0.282, val_micro_ap=0.539]Epoch 1:  25%|‚ñà‚ñà‚ñå       | 4/16 [00:16<00:49,  0.24it/s, v_num=8820, train_loss=0.283, train_micro_ap=0.529, val_loss=0.282, val_micro_ap=0.539]Epoch 1:  25%|‚ñà‚ñà‚ñå       | 4/16 [00:18<00:54,  0.22it/s, v_num=8820, train_loss=0.285, train_micro_ap=0.529, val_loss=0.282, val_micro_ap=0.539]Epoch 1:  31%|‚ñà‚ñà‚ñà‚ñè      | 5/16 [00:19<00:42,  0.26it/s, v_num=8820, train_loss=0.285, train_micro_ap=0.529, val_loss=0.282, val_micro_ap=0.539]Epoch 1:  31%|‚ñà‚ñà‚ñà‚ñè      | 5/16 [00:20<00:45,  0.24it/s, v_num=8820, train_loss=0.284, train_micro_ap=0.535, val_loss=0.282, val_micro_ap=0.539]Epoch 1:  38%|‚ñà‚ñà‚ñà‚ñä      | 6/16 [00:22<00:37,  0.27it/s, v_num=8820, train_loss=0.284, train_micro_ap=0.535, val_loss=0.282, val_micro_ap=0.539]Epoch 1:  38%|‚ñà‚ñà‚ñà‚ñä      | 6/16 [00:23<00:39,  0.25it/s, v_num=8820, train_loss=0.285, train_micro_ap=0.577, val_loss=0.282, val_micro_ap=0.539]Epoch 1:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 7/16 [00:25<00:32,  0.28it/s, v_num=8820, train_loss=0.285, train_micro_ap=0.577, val_loss=0.282, val_micro_ap=0.539]Epoch 1:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 7/16 [00:26<00:34,  0.26it/s, v_num=8820, train_loss=0.285, train_micro_ap=0.508, val_loss=0.282, val_micro_ap=0.539]Epoch 1:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 8/16 [00:27<00:27,  0.29it/s, v_num=8820, train_loss=0.285, train_micro_ap=0.508, val_loss=0.282, val_micro_ap=0.539]Epoch 1:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 8/16 [00:29<00:29,  0.27it/s, v_num=8820, train_loss=0.297, train_micro_ap=0.526, val_loss=0.282, val_micro_ap=0.539]Epoch 1:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 9/16 [00:30<00:23,  0.29it/s, v_num=8820, train_loss=0.297, train_micro_ap=0.526, val_loss=0.282, val_micro_ap=0.539]Epoch 1:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 9/16 [00:32<00:25,  0.28it/s, v_num=8820, train_loss=0.287, train_micro_ap=0.503, val_loss=0.282, val_micro_ap=0.539]Epoch 1:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 10/16 [00:33<00:20,  0.30it/s, v_num=8820, train_loss=0.287, train_micro_ap=0.503, val_loss=0.282, val_micro_ap=0.539]Epoch 1:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 10/16 [00:35<00:21,  0.29it/s, v_num=8820, train_loss=0.273, train_micro_ap=0.556, val_loss=0.282, val_micro_ap=0.539]Epoch 1:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 11/16 [00:36<00:16,  0.30it/s, v_num=8820, train_loss=0.273, train_micro_ap=0.556, val_loss=0.282, val_micro_ap=0.539]Epoch 1:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 11/16 [00:37<00:17,  0.29it/s, v_num=8820, train_loss=0.284, train_micro_ap=0.539, val_loss=0.282, val_micro_ap=0.539]Epoch 1:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 12/16 [00:39<00:13,  0.31it/s, v_num=8820, train_loss=0.284, train_micro_ap=0.539, val_loss=0.282, val_micro_ap=0.539]Epoch 1:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 12/16 [00:40<00:13,  0.29it/s, v_num=8820, train_loss=0.289, train_micro_ap=0.526, val_loss=0.282, val_micro_ap=0.539]Epoch 1:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 13/16 [00:42<00:09,  0.31it/s, v_num=8820, train_loss=0.289, train_micro_ap=0.526, val_loss=0.282, val_micro_ap=0.539]Epoch 1:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 13/16 [00:43<00:10,  0.30it/s, v_num=8820, train_loss=0.273, train_micro_ap=0.515, val_loss=0.282, val_micro_ap=0.539]Epoch 1:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 14/16 [00:44<00:06,  0.31it/s, v_num=8820, train_loss=0.273, train_micro_ap=0.515, val_loss=0.282, val_micro_ap=0.539]Epoch 1:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 14/16 [00:46<00:06,  0.30it/s, v_num=8820, train_loss=0.290, train_micro_ap=0.518, val_loss=0.282, val_micro_ap=0.539]Epoch 1:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 15/16 [00:47<00:03,  0.31it/s, v_num=8820, train_loss=0.290, train_micro_ap=0.518, val_loss=0.282, val_micro_ap=0.539]Epoch 1:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 15/16 [00:49<00:03,  0.30it/s, v_num=8820, train_loss=0.282, train_micro_ap=0.517, val_loss=0.282, val_micro_ap=0.539]Epoch 1: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 16/16 [00:50<00:00,  0.32it/s, v_num=8820, train_loss=0.282, train_micro_ap=0.517, val_loss=0.282, val_micro_ap=0.539]Epoch 1: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 16/16 [00:51<00:00,  0.31it/s, v_num=8820, train_loss=0.287, train_micro_ap=0.583, val_loss=0.282, val_micro_ap=0.539][96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m

Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:01<00:03,  0.98it/s][A
Validation DataLoader 0:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:02<00:02,  0.85it/s][A
Validation DataLoader 0:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:03<00:01,  0.81it/s][A
Validation DataLoader 0: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:04<00:00,  0.81it/s][A
/faststorage/arne/mamba/envs/cl_lora_env/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py:4631: UserWarning: No device id is provided via `init_process_group` or `barrier `. Using the current device set by the user. 
  warnings.warn(  # warn only once
Epoch 1, global step 32: 'val_loss' reached 0.28181 (best 0.28181), saving model to 'saved_models/lightning_logs/version_8820/checkpoints/epoch=1-step=32.ckpt' as top 1
                                                                      [AEpoch 1: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 16/16 [01:02<00:00,  0.26it/s, v_num=8820, train_loss=0.287, train_micro_ap=0.583, val_loss=0.282, val_micro_ap=0.490]Epoch 1: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 16/16 [01:02<00:00,  0.26it/s, v_num=8820, train_loss=0.287, train_micro_ap=0.583, val_loss=0.282, val_micro_ap=0.490]Epoch 1:   0%|          | 0/16 [00:00<?, ?it/s, v_num=8820, train_loss=0.287, train_micro_ap=0.583, val_loss=0.282, val_micro_ap=0.490]         Epoch 2:   0%|          | 0/16 [00:00<?, ?it/s, v_num=8820, train_loss=0.287, train_micro_ap=0.583, val_loss=0.282, val_micro_ap=0.490][96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
Epoch 2:   6%|‚ñã         | 1/16 [00:07<01:55,  0.13it/s, v_num=8820, train_loss=0.287, train_micro_ap=0.583, val_loss=0.282, val_micro_ap=0.490]Epoch 2:   6%|‚ñã         | 1/16 [00:09<02:17,  0.11it/s, v_num=8820, train_loss=0.299, train_micro_ap=0.510, val_loss=0.282, val_micro_ap=0.490]Epoch 2:  12%|‚ñà‚ñé        | 2/16 [00:10<01:16,  0.18it/s, v_num=8820, train_loss=0.299, train_micro_ap=0.510, val_loss=0.282, val_micro_ap=0.490]Epoch 2:  12%|‚ñà‚ñé        | 2/16 [00:12<01:26,  0.16it/s, v_num=8820, train_loss=0.272, train_micro_ap=0.524, val_loss=0.282, val_micro_ap=0.490]Epoch 2:  19%|‚ñà‚ñâ        | 3/16 [00:13<00:59,  0.22it/s, v_num=8820, train_loss=0.272, train_micro_ap=0.524, val_loss=0.282, val_micro_ap=0.490]Epoch 2:  19%|‚ñà‚ñâ        | 3/16 [00:15<01:06,  0.20it/s, v_num=8820, train_loss=0.279, train_micro_ap=0.559, val_loss=0.282, val_micro_ap=0.490]Epoch 2:  25%|‚ñà‚ñà‚ñå       | 4/16 [00:16<00:49,  0.24it/s, v_num=8820, train_loss=0.279, train_micro_ap=0.559, val_loss=0.282, val_micro_ap=0.490]Epoch 2:  25%|‚ñà‚ñà‚ñå       | 4/16 [00:18<00:54,  0.22it/s, v_num=8820, train_loss=0.273, train_micro_ap=0.578, val_loss=0.282, val_micro_ap=0.490]Epoch 2:  31%|‚ñà‚ñà‚ñà‚ñè      | 5/16 [00:19<00:42,  0.26it/s, v_num=8820, train_loss=0.273, train_micro_ap=0.578, val_loss=0.282, val_micro_ap=0.490]Epoch 2:  31%|‚ñà‚ñà‚ñà‚ñè      | 5/16 [00:20<00:46,  0.24it/s, v_num=8820, train_loss=0.280, train_micro_ap=0.527, val_loss=0.282, val_micro_ap=0.490]Epoch 2:  38%|‚ñà‚ñà‚ñà‚ñä      | 6/16 [00:22<00:37,  0.27it/s, v_num=8820, train_loss=0.280, train_micro_ap=0.527, val_loss=0.282, val_micro_ap=0.490]Epoch 2:  38%|‚ñà‚ñà‚ñà‚ñä      | 6/16 [00:23<00:39,  0.25it/s, v_num=8820, train_loss=0.279, train_micro_ap=0.539, val_loss=0.282, val_micro_ap=0.490]Epoch 2:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 7/16 [00:25<00:32,  0.28it/s, v_num=8820, train_loss=0.279, train_micro_ap=0.539, val_loss=0.282, val_micro_ap=0.490]Epoch 2:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 7/16 [00:26<00:34,  0.26it/s, v_num=8820, train_loss=0.301, train_micro_ap=0.552, val_loss=0.282, val_micro_ap=0.490]Epoch 2:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 8/16 [00:28<00:28,  0.28it/s, v_num=8820, train_loss=0.301, train_micro_ap=0.552, val_loss=0.282, val_micro_ap=0.490]Epoch 2:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 8/16 [00:29<00:29,  0.27it/s, v_num=8820, train_loss=0.288, train_micro_ap=0.541, val_loss=0.282, val_micro_ap=0.490]Epoch 2:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 9/16 [00:30<00:24,  0.29it/s, v_num=8820, train_loss=0.288, train_micro_ap=0.541, val_loss=0.282, val_micro_ap=0.490]Epoch 2:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 9/16 [00:32<00:25,  0.28it/s, v_num=8820, train_loss=0.282, train_micro_ap=0.569, val_loss=0.282, val_micro_ap=0.490]Epoch 2:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 10/16 [00:33<00:20,  0.30it/s, v_num=8820, train_loss=0.282, train_micro_ap=0.569, val_loss=0.282, val_micro_ap=0.490]Epoch 2:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 10/16 [00:35<00:21,  0.28it/s, v_num=8820, train_loss=0.279, train_micro_ap=0.560, val_loss=0.282, val_micro_ap=0.490]Epoch 2:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 11/16 [00:36<00:16,  0.30it/s, v_num=8820, train_loss=0.279, train_micro_ap=0.560, val_loss=0.282, val_micro_ap=0.490]Epoch 2:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 11/16 [00:38<00:17,  0.29it/s, v_num=8820, train_loss=0.291, train_micro_ap=0.542, val_loss=0.282, val_micro_ap=0.490]Epoch 2:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 12/16 [00:39<00:13,  0.30it/s, v_num=8820, train_loss=0.291, train_micro_ap=0.542, val_loss=0.282, val_micro_ap=0.490]Epoch 2:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 12/16 [00:40<00:13,  0.29it/s, v_num=8820, train_loss=0.305, train_micro_ap=0.521, val_loss=0.282, val_micro_ap=0.490]Epoch 2:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 13/16 [00:42<00:09,  0.31it/s, v_num=8820, train_loss=0.305, train_micro_ap=0.521, val_loss=0.282, val_micro_ap=0.490]Epoch 2:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 13/16 [00:43<00:10,  0.30it/s, v_num=8820, train_loss=0.279, train_micro_ap=0.532, val_loss=0.282, val_micro_ap=0.490]Epoch 2:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 14/16 [00:45<00:06,  0.31it/s, v_num=8820, train_loss=0.279, train_micro_ap=0.532, val_loss=0.282, val_micro_ap=0.490]Epoch 2:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 14/16 [00:46<00:06,  0.30it/s, v_num=8820, train_loss=0.267, train_micro_ap=0.554, val_loss=0.282, val_micro_ap=0.490]Epoch 2:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 15/16 [00:48<00:03,  0.31it/s, v_num=8820, train_loss=0.267, train_micro_ap=0.554, val_loss=0.282, val_micro_ap=0.490]Epoch 2:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 15/16 [00:49<00:03,  0.30it/s, v_num=8820, train_loss=0.299, train_micro_ap=0.496, val_loss=0.282, val_micro_ap=0.490]Epoch 2: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 16/16 [00:50<00:00,  0.32it/s, v_num=8820, train_loss=0.299, train_micro_ap=0.496, val_loss=0.282, val_micro_ap=0.490]Epoch 2: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 16/16 [00:51<00:00,  0.31it/s, v_num=8820, train_loss=0.282, train_micro_ap=0.548, val_loss=0.282, val_micro_ap=0.490][96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m

Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:01<00:03,  0.98it/s][A
Validation DataLoader 0:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:02<00:02,  0.84it/s][A
Validation DataLoader 0:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:03<00:01,  0.80it/s][A
Validation DataLoader 0: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:04<00:00,  0.81it/s][A
/faststorage/arne/mamba/envs/cl_lora_env/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py:4631: UserWarning: No device id is provided via `init_process_group` or `barrier `. Using the current device set by the user. 
  warnings.warn(  # warn only once
Epoch 2, global step 48: 'val_loss' was not in top 1
                                                                      [AEpoch 2: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 16/16 [01:02<00:00,  0.26it/s, v_num=8820, train_loss=0.282, train_micro_ap=0.548, val_loss=0.282, val_micro_ap=0.547]Epoch 2: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 16/16 [01:02<00:00,  0.26it/s, v_num=8820, train_loss=0.282, train_micro_ap=0.548, val_loss=0.282, val_micro_ap=0.547]Epoch 2:   0%|          | 0/16 [00:00<?, ?it/s, v_num=8820, train_loss=0.282, train_micro_ap=0.548, val_loss=0.282, val_micro_ap=0.547]         Epoch 3:   0%|          | 0/16 [00:00<?, ?it/s, v_num=8820, train_loss=0.282, train_micro_ap=0.548, val_loss=0.282, val_micro_ap=0.547][96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
Epoch 3:   6%|‚ñã         | 1/16 [00:08<02:02,  0.12it/s, v_num=8820, train_loss=0.282, train_micro_ap=0.548, val_loss=0.282, val_micro_ap=0.547]Epoch 3:   6%|‚ñã         | 1/16 [00:09<02:24,  0.10it/s, v_num=8820, train_loss=0.282, train_micro_ap=0.569, val_loss=0.282, val_micro_ap=0.547]Epoch 3:  12%|‚ñà‚ñé        | 2/16 [00:11<01:19,  0.18it/s, v_num=8820, train_loss=0.282, train_micro_ap=0.569, val_loss=0.282, val_micro_ap=0.547]Epoch 3:  12%|‚ñà‚ñé        | 2/16 [00:12<01:29,  0.16it/s, v_num=8820, train_loss=0.266, train_micro_ap=0.571, val_loss=0.282, val_micro_ap=0.547]Epoch 3:  19%|‚ñà‚ñâ        | 3/16 [00:14<01:01,  0.21it/s, v_num=8820, train_loss=0.266, train_micro_ap=0.571, val_loss=0.282, val_micro_ap=0.547]Epoch 3:  19%|‚ñà‚ñâ        | 3/16 [00:15<01:08,  0.19it/s, v_num=8820, train_loss=0.298, train_micro_ap=0.539, val_loss=0.282, val_micro_ap=0.547]Epoch 3:  25%|‚ñà‚ñà‚ñå       | 4/16 [00:17<00:51,  0.23it/s, v_num=8820, train_loss=0.298, train_micro_ap=0.539, val_loss=0.282, val_micro_ap=0.547]Epoch 3:  25%|‚ñà‚ñà‚ñå       | 4/16 [00:18<00:55,  0.22it/s, v_num=8820, train_loss=0.292, train_micro_ap=0.528, val_loss=0.282, val_micro_ap=0.547]Epoch 3:  31%|‚ñà‚ñà‚ñà‚ñè      | 5/16 [00:19<00:43,  0.25it/s, v_num=8820, train_loss=0.292, train_micro_ap=0.528, val_loss=0.282, val_micro_ap=0.547]Epoch 3:  31%|‚ñà‚ñà‚ñà‚ñè      | 5/16 [00:21<00:47,  0.23it/s, v_num=8820, train_loss=0.283, train_micro_ap=0.573, val_loss=0.282, val_micro_ap=0.547]Epoch 3:  38%|‚ñà‚ñà‚ñà‚ñä      | 6/16 [00:22<00:38,  0.26it/s, v_num=8820, train_loss=0.283, train_micro_ap=0.573, val_loss=0.282, val_micro_ap=0.547]Epoch 3:  38%|‚ñà‚ñà‚ñà‚ñä      | 6/16 [00:24<00:40,  0.25it/s, v_num=8820, train_loss=0.277, train_micro_ap=0.552, val_loss=0.282, val_micro_ap=0.547]Epoch 3:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 7/16 [00:25<00:33,  0.27it/s, v_num=8820, train_loss=0.277, train_micro_ap=0.552, val_loss=0.282, val_micro_ap=0.547]Epoch 3:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 7/16 [00:27<00:34,  0.26it/s, v_num=8820, train_loss=0.288, train_micro_ap=0.540, val_loss=0.282, val_micro_ap=0.547]Epoch 3:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 8/16 [00:28<00:28,  0.28it/s, v_num=8820, train_loss=0.288, train_micro_ap=0.540, val_loss=0.282, val_micro_ap=0.547]Epoch 3:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 8/16 [00:29<00:29,  0.27it/s, v_num=8820, train_loss=0.283, train_micro_ap=0.522, val_loss=0.282, val_micro_ap=0.547]Epoch 3:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 9/16 [00:31<00:24,  0.29it/s, v_num=8820, train_loss=0.283, train_micro_ap=0.522, val_loss=0.282, val_micro_ap=0.547]Epoch 3:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 9/16 [00:32<00:25,  0.27it/s, v_num=8820, train_loss=0.280, train_micro_ap=0.486, val_loss=0.282, val_micro_ap=0.547]Epoch 3:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 10/16 [00:34<00:20,  0.29it/s, v_num=8820, train_loss=0.280, train_micro_ap=0.486, val_loss=0.282, val_micro_ap=0.547]Epoch 3:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 10/16 [00:35<00:21,  0.28it/s, v_num=8820, train_loss=0.281, train_micro_ap=0.541, val_loss=0.282, val_micro_ap=0.547]Epoch 3:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 11/16 [00:37<00:16,  0.30it/s, v_num=8820, train_loss=0.281, train_micro_ap=0.541, val_loss=0.282, val_micro_ap=0.547]Epoch 3:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 11/16 [00:38<00:17,  0.29it/s, v_num=8820, train_loss=0.287, train_micro_ap=0.539, val_loss=0.282, val_micro_ap=0.547]Epoch 3:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 12/16 [00:39<00:13,  0.30it/s, v_num=8820, train_loss=0.287, train_micro_ap=0.539, val_loss=0.282, val_micro_ap=0.547]Epoch 3:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 12/16 [00:41<00:13,  0.29it/s, v_num=8820, train_loss=0.288, train_micro_ap=0.532, val_loss=0.282, val_micro_ap=0.547]Epoch 3:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 13/16 [00:42<00:09,  0.30it/s, v_num=8820, train_loss=0.288, train_micro_ap=0.532, val_loss=0.282, val_micro_ap=0.547]Epoch 3:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 13/16 [00:44<00:10,  0.29it/s, v_num=8820, train_loss=0.291, train_micro_ap=0.553, val_loss=0.282, val_micro_ap=0.547]Epoch 3:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 14/16 [00:45<00:06,  0.31it/s, v_num=8820, train_loss=0.291, train_micro_ap=0.553, val_loss=0.282, val_micro_ap=0.547]Epoch 3:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 14/16 [00:47<00:06,  0.30it/s, v_num=8820, train_loss=0.284, train_micro_ap=0.554, val_loss=0.282, val_micro_ap=0.547]Epoch 3:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 15/16 [00:48<00:03,  0.31it/s, v_num=8820, train_loss=0.284, train_micro_ap=0.554, val_loss=0.282, val_micro_ap=0.547]Epoch 3:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 15/16 [00:49<00:03,  0.30it/s, v_num=8820, train_loss=0.279, train_micro_ap=0.538, val_loss=0.282, val_micro_ap=0.547]Epoch 3: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 16/16 [00:50<00:00,  0.32it/s, v_num=8820, train_loss=0.279, train_micro_ap=0.538, val_loss=0.282, val_micro_ap=0.547]Epoch 3: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 16/16 [00:51<00:00,  0.31it/s, v_num=8820, train_loss=0.279, train_micro_ap=0.536, val_loss=0.282, val_micro_ap=0.547][96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m

Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:01<00:03,  0.98it/s][A
Validation DataLoader 0:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:02<00:02,  0.85it/s][A
Validation DataLoader 0:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:03<00:01,  0.82it/s][A
Validation DataLoader 0: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:04<00:00,  0.82it/s][A
/faststorage/arne/mamba/envs/cl_lora_env/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py:4631: UserWarning: No device id is provided via `init_process_group` or `barrier `. Using the current device set by the user. 
  warnings.warn(  # warn only once
Epoch 3, global step 64: 'val_loss' reached 0.28116 (best 0.28116), saving model to 'saved_models/lightning_logs/version_8820/checkpoints/epoch=3-step=64.ckpt' as top 1
                                                                      [AEpoch 3: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 16/16 [01:02<00:00,  0.25it/s, v_num=8820, train_loss=0.279, train_micro_ap=0.536, val_loss=0.281, val_micro_ap=0.549]Epoch 3: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 16/16 [01:03<00:00,  0.25it/s, v_num=8820, train_loss=0.279, train_micro_ap=0.536, val_loss=0.281, val_micro_ap=0.549]Epoch 3:   0%|          | 0/16 [00:00<?, ?it/s, v_num=8820, train_loss=0.279, train_micro_ap=0.536, val_loss=0.281, val_micro_ap=0.549]         Epoch 4:   0%|          | 0/16 [00:00<?, ?it/s, v_num=8820, train_loss=0.279, train_micro_ap=0.536, val_loss=0.281, val_micro_ap=0.549][96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
Epoch 4:   6%|‚ñã         | 1/16 [00:07<01:59,  0.13it/s, v_num=8820, train_loss=0.279, train_micro_ap=0.536, val_loss=0.281, val_micro_ap=0.549]Epoch 4:   6%|‚ñã         | 1/16 [00:09<02:21,  0.11it/s, v_num=8820, train_loss=0.293, train_micro_ap=0.536, val_loss=0.281, val_micro_ap=0.549]Epoch 4:  12%|‚ñà‚ñé        | 2/16 [00:11<01:18,  0.18it/s, v_num=8820, train_loss=0.293, train_micro_ap=0.536, val_loss=0.281, val_micro_ap=0.549]Epoch 4:  12%|‚ñà‚ñé        | 2/16 [00:12<01:28,  0.16it/s, v_num=8820, train_loss=0.275, train_micro_ap=0.577, val_loss=0.281, val_micro_ap=0.549]Epoch 4:  19%|‚ñà‚ñâ        | 3/16 [00:14<01:00,  0.21it/s, v_num=8820, train_loss=0.275, train_micro_ap=0.577, val_loss=0.281, val_micro_ap=0.549]Epoch 4:  19%|‚ñà‚ñâ        | 3/16 [00:15<01:07,  0.19it/s, v_num=8820, train_loss=0.287, train_micro_ap=0.568, val_loss=0.281, val_micro_ap=0.549]Epoch 4:  25%|‚ñà‚ñà‚ñå       | 4/16 [00:16<00:50,  0.24it/s, v_num=8820, train_loss=0.287, train_micro_ap=0.568, val_loss=0.281, val_micro_ap=0.549]Epoch 4:  25%|‚ñà‚ñà‚ñå       | 4/16 [00:18<00:55,  0.22it/s, v_num=8820, train_loss=0.278, train_micro_ap=0.548, val_loss=0.281, val_micro_ap=0.549]Epoch 4:  31%|‚ñà‚ñà‚ñà‚ñè      | 5/16 [00:19<00:43,  0.25it/s, v_num=8820, train_loss=0.278, train_micro_ap=0.548, val_loss=0.281, val_micro_ap=0.549]Epoch 4:  31%|‚ñà‚ñà‚ñà‚ñè      | 5/16 [00:21<00:46,  0.24it/s, v_num=8820, train_loss=0.285, train_micro_ap=0.528, val_loss=0.281, val_micro_ap=0.549]Epoch 4:  38%|‚ñà‚ñà‚ñà‚ñä      | 6/16 [00:22<00:37,  0.27it/s, v_num=8820, train_loss=0.285, train_micro_ap=0.528, val_loss=0.281, val_micro_ap=0.549]Epoch 4:  38%|‚ñà‚ñà‚ñà‚ñä      | 6/16 [00:24<00:40,  0.25it/s, v_num=8820, train_loss=0.287, train_micro_ap=0.554, val_loss=0.281, val_micro_ap=0.549]Epoch 4:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 7/16 [00:25<00:32,  0.27it/s, v_num=8820, train_loss=0.287, train_micro_ap=0.554, val_loss=0.281, val_micro_ap=0.549]Epoch 4:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 7/16 [00:26<00:34,  0.26it/s, v_num=8820, train_loss=0.278, train_micro_ap=0.571, val_loss=0.281, val_micro_ap=0.549]Epoch 4:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 8/16 [00:28<00:28,  0.28it/s, v_num=8820, train_loss=0.278, train_micro_ap=0.571, val_loss=0.281, val_micro_ap=0.549]Epoch 4:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 8/16 [00:29<00:29,  0.27it/s, v_num=8820, train_loss=0.276, train_micro_ap=0.559, val_loss=0.281, val_micro_ap=0.549]Epoch 4:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 9/16 [00:31<00:24,  0.29it/s, v_num=8820, train_loss=0.276, train_micro_ap=0.559, val_loss=0.281, val_micro_ap=0.549]Epoch 4:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 9/16 [00:32<00:25,  0.28it/s, v_num=8820, train_loss=0.283, train_micro_ap=0.522, val_loss=0.281, val_micro_ap=0.549]Epoch 4:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 10/16 [00:34<00:20,  0.29it/s, v_num=8820, train_loss=0.283, train_micro_ap=0.522, val_loss=0.281, val_micro_ap=0.549]Epoch 4:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 10/16 [00:35<00:21,  0.28it/s, v_num=8820, train_loss=0.286, train_micro_ap=0.543, val_loss=0.281, val_micro_ap=0.549]Epoch 4:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 11/16 [00:36<00:16,  0.30it/s, v_num=8820, train_loss=0.286, train_micro_ap=0.543, val_loss=0.281, val_micro_ap=0.549]Epoch 4:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 11/16 [00:38<00:17,  0.29it/s, v_num=8820, train_loss=0.284, train_micro_ap=0.567, val_loss=0.281, val_micro_ap=0.549]Epoch 4:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 12/16 [00:39<00:13,  0.30it/s, v_num=8820, train_loss=0.284, train_micro_ap=0.567, val_loss=0.281, val_micro_ap=0.549]Epoch 4:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 12/16 [00:41<00:13,  0.29it/s, v_num=8820, train_loss=0.274, train_micro_ap=0.546, val_loss=0.281, val_micro_ap=0.549]Epoch 4:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 13/16 [00:42<00:09,  0.31it/s, v_num=8820, train_loss=0.274, train_micro_ap=0.546, val_loss=0.281, val_micro_ap=0.549]Epoch 4:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 13/16 [00:43<00:10,  0.30it/s, v_num=8820, train_loss=0.301, train_micro_ap=0.502, val_loss=0.281, val_micro_ap=0.549]Epoch 4:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 14/16 [00:45<00:06,  0.31it/s, v_num=8820, train_loss=0.301, train_micro_ap=0.502, val_loss=0.281, val_micro_ap=0.549]Epoch 4:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 14/16 [00:46<00:06,  0.30it/s, v_num=8820, train_loss=0.269, train_micro_ap=0.553, val_loss=0.281, val_micro_ap=0.549]Epoch 4:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 15/16 [00:48<00:03,  0.31it/s, v_num=8820, train_loss=0.269, train_micro_ap=0.553, val_loss=0.281, val_micro_ap=0.549]Epoch 4:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 15/16 [00:49<00:03,  0.30it/s, v_num=8820, train_loss=0.277, train_micro_ap=0.550, val_loss=0.281, val_micro_ap=0.549]Epoch 4: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 16/16 [00:50<00:00,  0.32it/s, v_num=8820, train_loss=0.277, train_micro_ap=0.550, val_loss=0.281, val_micro_ap=0.549]Epoch 4: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 16/16 [00:51<00:00,  0.31it/s, v_num=8820, train_loss=0.272, train_micro_ap=0.576, val_loss=0.281, val_micro_ap=0.549][96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m

Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:01<00:03,  0.98it/s][A
Validation DataLoader 0:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:02<00:02,  0.85it/s][A
Validation DataLoader 0:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:03<00:01,  0.81it/s][A
Validation DataLoader 0: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:04<00:00,  0.81it/s][A
/faststorage/arne/mamba/envs/cl_lora_env/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py:4631: UserWarning: No device id is provided via `init_process_group` or `barrier `. Using the current device set by the user. 
  warnings.warn(  # warn only once
Epoch 4, global step 80: 'val_loss' reached 0.27984 (best 0.27984), saving model to 'saved_models/lightning_logs/version_8820/checkpoints/epoch=4-step=80.ckpt' as top 1
                                                                      [AEpoch 4: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 16/16 [01:02<00:00,  0.26it/s, v_num=8820, train_loss=0.272, train_micro_ap=0.576, val_loss=0.280, val_micro_ap=0.549]Epoch 4: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 16/16 [01:02<00:00,  0.25it/s, v_num=8820, train_loss=0.272, train_micro_ap=0.576, val_loss=0.280, val_micro_ap=0.549]Epoch 4:   0%|          | 0/16 [00:00<?, ?it/s, v_num=8820, train_loss=0.272, train_micro_ap=0.576, val_loss=0.280, val_micro_ap=0.549]         Epoch 5:   0%|          | 0/16 [00:00<?, ?it/s, v_num=8820, train_loss=0.272, train_micro_ap=0.576, val_loss=0.280, val_micro_ap=0.549][96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
Epoch 5:   6%|‚ñã         | 1/16 [00:07<01:53,  0.13it/s, v_num=8820, train_loss=0.272, train_micro_ap=0.576, val_loss=0.280, val_micro_ap=0.549]Epoch 5:   6%|‚ñã         | 1/16 [00:09<02:15,  0.11it/s, v_num=8820, train_loss=0.281, train_micro_ap=0.561, val_loss=0.280, val_micro_ap=0.549]Epoch 5:  12%|‚ñà‚ñé        | 2/16 [00:10<01:14,  0.19it/s, v_num=8820, train_loss=0.281, train_micro_ap=0.561, val_loss=0.280, val_micro_ap=0.549]Epoch 5:  12%|‚ñà‚ñé        | 2/16 [00:12<01:25,  0.16it/s, v_num=8820, train_loss=0.285, train_micro_ap=0.540, val_loss=0.280, val_micro_ap=0.549]Epoch 5:  19%|‚ñà‚ñâ        | 3/16 [00:13<00:58,  0.22it/s, v_num=8820, train_loss=0.285, train_micro_ap=0.540, val_loss=0.280, val_micro_ap=0.549]Epoch 5:  19%|‚ñà‚ñâ        | 3/16 [00:15<01:05,  0.20it/s, v_num=8820, train_loss=0.285, train_micro_ap=0.547, val_loss=0.280, val_micro_ap=0.549]Epoch 5:  25%|‚ñà‚ñà‚ñå       | 4/16 [00:16<00:49,  0.24it/s, v_num=8820, train_loss=0.285, train_micro_ap=0.547, val_loss=0.280, val_micro_ap=0.549]Epoch 5:  25%|‚ñà‚ñà‚ñå       | 4/16 [00:17<00:53,  0.22it/s, v_num=8820, train_loss=0.272, train_micro_ap=0.553, val_loss=0.280, val_micro_ap=0.549]Epoch 5:  31%|‚ñà‚ñà‚ñà‚ñè      | 5/16 [00:19<00:42,  0.26it/s, v_num=8820, train_loss=0.272, train_micro_ap=0.553, val_loss=0.280, val_micro_ap=0.549]Epoch 5:  31%|‚ñà‚ñà‚ñà‚ñè      | 5/16 [00:20<00:45,  0.24it/s, v_num=8820, train_loss=0.287, train_micro_ap=0.537, val_loss=0.280, val_micro_ap=0.549]Epoch 5:  38%|‚ñà‚ñà‚ñà‚ñä      | 6/16 [00:22<00:36,  0.27it/s, v_num=8820, train_loss=0.287, train_micro_ap=0.537, val_loss=0.280, val_micro_ap=0.549]Epoch 5:  38%|‚ñà‚ñà‚ñà‚ñä      | 6/16 [00:23<00:39,  0.25it/s, v_num=8820, train_loss=0.274, train_micro_ap=0.547, val_loss=0.280, val_micro_ap=0.549]Epoch 5:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 7/16 [00:24<00:32,  0.28it/s, v_num=8820, train_loss=0.274, train_micro_ap=0.547, val_loss=0.280, val_micro_ap=0.549]Epoch 5:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 7/16 [00:26<00:34,  0.26it/s, v_num=8820, train_loss=0.290, train_micro_ap=0.568, val_loss=0.280, val_micro_ap=0.549]Epoch 5:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 8/16 [00:27<00:27,  0.29it/s, v_num=8820, train_loss=0.290, train_micro_ap=0.568, val_loss=0.280, val_micro_ap=0.549]Epoch 5:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 8/16 [00:29<00:29,  0.27it/s, v_num=8820, train_loss=0.277, train_micro_ap=0.551, val_loss=0.280, val_micro_ap=0.549]Epoch 5:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 9/16 [00:30<00:23,  0.29it/s, v_num=8820, train_loss=0.277, train_micro_ap=0.551, val_loss=0.280, val_micro_ap=0.549]Epoch 5:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 9/16 [00:32<00:25,  0.28it/s, v_num=8820, train_loss=0.287, train_micro_ap=0.539, val_loss=0.280, val_micro_ap=0.549]Epoch 5:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 10/16 [00:33<00:20,  0.30it/s, v_num=8820, train_loss=0.287, train_micro_ap=0.539, val_loss=0.280, val_micro_ap=0.549]Epoch 5:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 10/16 [00:34<00:20,  0.29it/s, v_num=8820, train_loss=0.272, train_micro_ap=0.577, val_loss=0.280, val_micro_ap=0.549]Epoch 5:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 11/16 [00:36<00:16,  0.30it/s, v_num=8820, train_loss=0.272, train_micro_ap=0.577, val_loss=0.280, val_micro_ap=0.549]Epoch 5:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 11/16 [00:37<00:17,  0.29it/s, v_num=8820, train_loss=0.275, train_micro_ap=0.557, val_loss=0.280, val_micro_ap=0.549]Epoch 5:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 12/16 [00:39<00:13,  0.31it/s, v_num=8820, train_loss=0.275, train_micro_ap=0.557, val_loss=0.280, val_micro_ap=0.549]Epoch 5:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 12/16 [00:40<00:13,  0.30it/s, v_num=8820, train_loss=0.284, train_micro_ap=0.572, val_loss=0.280, val_micro_ap=0.549]Epoch 5:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 13/16 [00:42<00:09,  0.31it/s, v_num=8820, train_loss=0.284, train_micro_ap=0.572, val_loss=0.280, val_micro_ap=0.549]Epoch 5:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 13/16 [00:43<00:10,  0.30it/s, v_num=8820, train_loss=0.278, train_micro_ap=0.531, val_loss=0.280, val_micro_ap=0.549]Epoch 5:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 14/16 [00:44<00:06,  0.31it/s, v_num=8820, train_loss=0.278, train_micro_ap=0.531, val_loss=0.280, val_micro_ap=0.549]Epoch 5:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 14/16 [00:46<00:06,  0.30it/s, v_num=8820, train_loss=0.280, train_micro_ap=0.544, val_loss=0.280, val_micro_ap=0.549]Epoch 5:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 15/16 [00:47<00:03,  0.31it/s, v_num=8820, train_loss=0.280, train_micro_ap=0.544, val_loss=0.280, val_micro_ap=0.549]Epoch 5:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 15/16 [00:49<00:03,  0.31it/s, v_num=8820, train_loss=0.291, train_micro_ap=0.543, val_loss=0.280, val_micro_ap=0.549]Epoch 5: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 16/16 [00:50<00:00,  0.32it/s, v_num=8820, train_loss=0.291, train_micro_ap=0.543, val_loss=0.280, val_micro_ap=0.549]Epoch 5: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 16/16 [00:50<00:00,  0.31it/s, v_num=8820, train_loss=0.273, train_micro_ap=0.564, val_loss=0.280, val_micro_ap=0.549][96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m

Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:01<00:03,  0.98it/s][A
Validation DataLoader 0:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:02<00:02,  0.85it/s][A
Validation DataLoader 0:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:03<00:01,  0.82it/s][A
Validation DataLoader 0: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:04<00:00,  0.82it/s][A
/faststorage/arne/mamba/envs/cl_lora_env/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py:4631: UserWarning: No device id is provided via `init_process_group` or `barrier `. Using the current device set by the user. 
  warnings.warn(  # warn only once
Monitored metric val_loss did not improve in the last 5 records. Best score: 0.282. Signaling Trainer to stop.
Epoch 5, global step 96: 'val_loss' reached 0.27911 (best 0.27911), saving model to 'saved_models/lightning_logs/version_8820/checkpoints/epoch=5-step=96.ckpt' as top 1
                                                                      [AEpoch 5: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 16/16 [01:02<00:00,  0.26it/s, v_num=8820, train_loss=0.273, train_micro_ap=0.564, val_loss=0.279, val_micro_ap=0.554]Epoch 5: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 16/16 [01:02<00:00,  0.26it/s, v_num=8820, train_loss=0.273, train_micro_ap=0.564, val_loss=0.279, val_micro_ap=0.554]Epoch 5: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 16/16 [01:03<00:00,  0.25it/s, v_num=8820, train_loss=0.273, train_micro_ap=0.564, val_loss=0.279, val_micro_ap=0.554][96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
2025-06-16 19:16:59,011 INFO Training time: 390.05s
2025-06-16 19:16:59,678 INFO Saved: ./saved_models/step3-Serbia.pkl

[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
/faststorage/arne/mamba/envs/cl_lora_env/lib/python3.9/site-packages/sklearn/metrics/_ranking.py:1033: UserWarning: No positive class found in y_true, recall is set to one for all thresholds.
  warnings.warn(
/faststorage/arne/mamba/envs/cl_lora_env/lib/python3.9/site-packages/sklearn/metrics/_ranking.py:1033: UserWarning: No positive class found in y_true, recall is set to one for all thresholds.
  warnings.warn(
/faststorage/arne/mamba/envs/cl_lora_env/lib/python3.9/site-packages/sklearn/metrics/_ranking.py:1033: UserWarning: No positive class found in y_true, recall is set to one for all thresholds.
  warnings.warn(
/faststorage/arne/mamba/envs/cl_lora_env/lib/python3.9/site-packages/sklearn/metrics/_ranking.py:1033: UserWarning: No positive class found in y_true, recall is set to one for all thresholds.
  warnings.warn(
/faststorage/arne/mamba/envs/cl_lora_env/lib/python3.9/site-packages/sklearn/metrics/_ranking.py:1033: UserWarning: No positive class found in y_true, recall is set to one for all thresholds.
  warnings.warn(
/faststorage/arne/mamba/envs/cl_lora_env/lib/python3.9/site-packages/sklearn/metrics/_ranking.py:1033: UserWarning: No positive class found in y_true, recall is set to one for all thresholds.
  warnings.warn(
/faststorage/arne/mamba/envs/cl_lora_env/lib/python3.9/site-packages/sklearn/metrics/_ranking.py:1033: UserWarning: No positive class found in y_true, recall is set to one for all thresholds.
  warnings.warn(
[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
/faststorage/arne/mamba/envs/cl_lora_env/lib/python3.9/site-packages/sklearn/metrics/_ranking.py:1033: UserWarning: No positive class found in y_true, recall is set to one for all thresholds.
  warnings.warn(
/faststorage/arne/mamba/envs/cl_lora_env/lib/python3.9/site-packages/sklearn/metrics/_ranking.py:1033: UserWarning: No positive class found in y_true, recall is set to one for all thresholds.
  warnings.warn(
/faststorage/arne/mamba/envs/cl_lora_env/lib/python3.9/site-packages/sklearn/metrics/_ranking.py:1033: UserWarning: No positive class found in y_true, recall is set to one for all thresholds.
  warnings.warn(
/faststorage/arne/mamba/envs/cl_lora_env/lib/python3.9/site-packages/sklearn/metrics/_ranking.py:1033: UserWarning: No positive class found in y_true, recall is set to one for all thresholds.
  warnings.warn(
[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
/faststorage/arne/mamba/envs/cl_lora_env/lib/python3.9/site-packages/sklearn/metrics/_ranking.py:1033: UserWarning: No positive class found in y_true, recall is set to one for all thresholds.
  warnings.warn(
/faststorage/arne/mamba/envs/cl_lora_env/lib/python3.9/site-packages/sklearn/metrics/_ranking.py:1033: UserWarning: No positive class found in y_true, recall is set to one for all thresholds.
  warnings.warn(
/faststorage/arne/mamba/envs/cl_lora_env/lib/python3.9/site-packages/sklearn/metrics/_ranking.py:1033: UserWarning: No positive class found in y_true, recall is set to one for all thresholds.
  warnings.warn(
/faststorage/arne/mamba/envs/cl_lora_env/lib/python3.9/site-packages/sklearn/metrics/_ranking.py:1033: UserWarning: No positive class found in y_true, recall is set to one for all thresholds.
  warnings.warn(
/faststorage/arne/mamba/envs/cl_lora_env/lib/python3.9/site-packages/sklearn/metrics/_ranking.py:1033: UserWarning: No positive class found in y_true, recall is set to one for all thresholds.
  warnings.warn(
2025-06-16 19:17:17,972 INFO Eval time: 18.29s
2025-06-16 19:17:17,972 INFO Result: {'step': 3, 'countries': ('Finland', 'Ireland', 'Serbia'), 'train_time_s': 390.0502359867096, 'eval_time_s': 18.29371166229248, 'Finland_micro_ap': np.float64(0.13500162840453192), 'Finland_macro_ap': np.float64(0.1550532324335787), 'Finland_accuracy': 78.69473684210526, 'Ireland_micro_ap': np.float64(0.1569617062282197), 'Ireland_macro_ap': np.float64(0.16390827848357203), 'Ireland_accuracy': 82.63157894736842, 'Serbia_micro_ap': np.float64(0.5405174795299584), 'Serbia_macro_ap': np.float64(0.20594962287470323), 'Serbia_accuracy': 85.23157894736842, 'mean_micro_ap': np.float64(0.27749360472090334), 'mean_macro_ap': np.float64(0.17497037793061798), 'mean_accuracy': 82.18596491228071}
2025-06-16 19:17:17,972 INFO Step 4: Countries ['Finland', 'Ireland', 'Serbia', 'Austria']
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/faststorage/arne/mamba/envs/cl_lora_env/lib/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:654: Checkpoint directory saved_models/lightning_logs/version_8820/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name              | Type              | Params | Mode 
----------------------------------------------------------------
0 | feature_extractor | LoRA_ViT_timm     | 87.4 M | eval 
1 | classifier        | Linear            | 14.6 K | train
2 | criterion         | BCEWithLogitsLoss | 0      | train
----------------------------------------------------------------
162 K     Trainable params
87.2 M    Non-trainable params
87.4 M    Total params
349.572   Total estimated model params size (MB)
2         Modules in train mode
272       Modules in eval mode
SLURM auto-requeueing enabled. Setting signal handlers.
/faststorage/arne/mamba/envs/cl_lora_env/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py:4631: UserWarning: No device id is provided via `init_process_group` or `barrier `. Using the current device set by the user. 
  warnings.warn(  # warn only once
/faststorage/arne/mamba/envs/cl_lora_env/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py:4631: UserWarning: No device id is provided via `init_process_group` or `barrier `. Using the current device set by the user. 
  warnings.warn(  # warn only once
/faststorage/arne/mamba/envs/cl_lora_env/lib/python3.9/site-packages/pytorch_lightning/loops/fit_loop.py:310: The number of training batches (16) is smaller than the logging interval Trainer(log_every_n_steps=50). Set a lower value for log_every_n_steps if you want to see logs for the training epoch.
Sanity Checking: |          | 0/? [00:00<?, ?it/s]Sanity Checking:   0%|          | 0/2 [00:00<?, ?it/s]Sanity Checking DataLoader 0:   0%|          | 0/2 [00:00<?, ?it/s]Sanity Checking DataLoader 0:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:01<00:01,  0.99it/s]Sanity Checking DataLoader 0: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 2/2 [00:02<00:00,  0.86it/s]                                                                           Training: |          | 0/? [00:00<?, ?it/s]Training:   0%|          | 0/16 [00:00<?, ?it/s]Epoch 0:   0%|          | 0/16 [00:00<?, ?it/s] Epoch 0:   6%|‚ñã         | 1/16 [00:06<01:40,  0.15it/s]Epoch 0:   6%|‚ñã         | 1/16 [00:08<02:02,  0.12it/s, v_num=8820, train_loss=0.668, train_micro_ap=0.190]Epoch 0:  12%|‚ñà‚ñé        | 2/16 [00:09<01:07,  0.21it/s, v_num=8820, train_loss=0.668, train_micro_ap=0.190]Epoch 0:  12%|‚ñà‚ñé        | 2/16 [00:11<01:17,  0.18it/s, v_num=8820, train_loss=0.431, train_micro_ap=0.437]Epoch 0:  19%|‚ñà‚ñâ        | 3/16 [00:12<00:53,  0.24it/s, v_num=8820, train_loss=0.431, train_micro_ap=0.437]Epoch 0:  19%|‚ñà‚ñâ        | 3/16 [00:13<01:00,  0.22it/s, v_num=8820, train_loss=0.363, train_micro_ap=0.476]Epoch 0:  25%|‚ñà‚ñà‚ñå       | 4/16 [00:15<00:46,  0.26it/s, v_num=8820, train_loss=0.363, train_micro_ap=0.476]Epoch 0:  25%|‚ñà‚ñà‚ñå       | 4/16 [00:16<00:50,  0.24it/s, v_num=8820, train_loss=0.346, train_micro_ap=0.500]Epoch 0:  31%|‚ñà‚ñà‚ñà‚ñè      | 5/16 [00:18<00:40,  0.27it/s, v_num=8820, train_loss=0.346, train_micro_ap=0.500]Epoch 0:  31%|‚ñà‚ñà‚ñà‚ñè      | 5/16 [00:19<00:43,  0.25it/s, v_num=8820, train_loss=0.346, train_micro_ap=0.457]Epoch 0:  38%|‚ñà‚ñà‚ñà‚ñä      | 6/16 [00:21<00:35,  0.28it/s, v_num=8820, train_loss=0.346, train_micro_ap=0.457]Epoch 0:  38%|‚ñà‚ñà‚ñà‚ñä      | 6/16 [00:22<00:37,  0.26it/s, v_num=8820, train_loss=0.339, train_micro_ap=0.468]Epoch 0:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 7/16 [00:24<00:30,  0.29it/s, v_num=8820, train_loss=0.339, train_micro_ap=0.468]Epoch 0:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 7/16 [00:25<00:32,  0.27it/s, v_num=8820, train_loss=0.342, train_micro_ap=0.454]Epoch 0:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 8/16 [00:26<00:26,  0.30it/s, v_num=8820, train_loss=0.342, train_micro_ap=0.454]Epoch 0:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 8/16 [00:28<00:28,  0.28it/s, v_num=8820, train_loss=0.341, train_micro_ap=0.485]Epoch 0:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 9/16 [00:29<00:23,  0.30it/s, v_num=8820, train_loss=0.341, train_micro_ap=0.485]Epoch 0:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 9/16 [00:31<00:24,  0.29it/s, v_num=8820, train_loss=0.347, train_micro_ap=0.495]Epoch 0:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 10/16 [00:32<00:19,  0.31it/s, v_num=8820, train_loss=0.347, train_micro_ap=0.495]Epoch 0:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 10/16 [00:34<00:20,  0.29it/s, v_num=8820, train_loss=0.342, train_micro_ap=0.498]Epoch 0:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 11/16 [00:35<00:16,  0.31it/s, v_num=8820, train_loss=0.342, train_micro_ap=0.498]Epoch 0:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 11/16 [00:36<00:16,  0.30it/s, v_num=8820, train_loss=0.318, train_micro_ap=0.515]Epoch 0:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 12/16 [00:38<00:12,  0.31it/s, v_num=8820, train_loss=0.318, train_micro_ap=0.515]Epoch 0:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 12/16 [00:39<00:13,  0.30it/s, v_num=8820, train_loss=0.324, train_micro_ap=0.502]Epoch 0:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 13/16 [00:41<00:09,  0.32it/s, v_num=8820, train_loss=0.324, train_micro_ap=0.502]Epoch 0:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 13/16 [00:42<00:09,  0.31it/s, v_num=8820, train_loss=0.329, train_micro_ap=0.495]Epoch 0:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 14/16 [00:43<00:06,  0.32it/s, v_num=8820, train_loss=0.329, train_micro_ap=0.495]Epoch 0:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 14/16 [00:45<00:06,  0.31it/s, v_num=8820, train_loss=0.325, train_micro_ap=0.486]Epoch 0:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 15/16 [00:46<00:03,  0.32it/s, v_num=8820, train_loss=0.325, train_micro_ap=0.486]Epoch 0:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 15/16 [00:48<00:03,  0.31it/s, v_num=8820, train_loss=0.312, train_micro_ap=0.502]Epoch 0: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 16/16 [00:49<00:00,  0.33it/s, v_num=8820, train_loss=0.312, train_micro_ap=0.502]Epoch 0: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 16/16 [00:49<00:00,  0.32it/s, v_num=8820, train_loss=0.323, train_micro_ap=0.488][96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m

Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:01<00:03,  0.97it/s][A
Validation DataLoader 0:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:02<00:02,  0.80it/s][A
Validation DataLoader 0:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:03<00:01,  0.78it/s][A
Validation DataLoader 0: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:05<00:00,  0.79it/s][A
/faststorage/arne/mamba/envs/cl_lora_env/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py:4631: UserWarning: No device id is provided via `init_process_group` or `barrier `. Using the current device set by the user. 
  warnings.warn(  # warn only once
Metric val_loss improved. New best score: 0.327
Epoch 0, global step 16: 'val_loss' reached 0.32734 (best 0.32734), saving model to 'saved_models/lightning_logs/version_8820/checkpoints/epoch=0-step=16.ckpt' as top 1
                                                                      [AEpoch 0: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 16/16 [01:01<00:00,  0.26it/s, v_num=8820, train_loss=0.323, train_micro_ap=0.488, val_loss=0.327, val_micro_ap=0.523]Epoch 0: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 16/16 [01:01<00:00,  0.26it/s, v_num=8820, train_loss=0.323, train_micro_ap=0.488, val_loss=0.327, val_micro_ap=0.523]Epoch 0:   0%|          | 0/16 [00:00<?, ?it/s, v_num=8820, train_loss=0.323, train_micro_ap=0.488, val_loss=0.327, val_micro_ap=0.523]         Epoch 1:   0%|          | 0/16 [00:00<?, ?it/s, v_num=8820, train_loss=0.323, train_micro_ap=0.488, val_loss=0.327, val_micro_ap=0.523][96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
Epoch 1:   6%|‚ñã         | 1/16 [00:07<01:58,  0.13it/s, v_num=8820, train_loss=0.323, train_micro_ap=0.488, val_loss=0.327, val_micro_ap=0.523]Epoch 1:   6%|‚ñã         | 1/16 [00:09<02:20,  0.11it/s, v_num=8820, train_loss=0.322, train_micro_ap=0.502, val_loss=0.327, val_micro_ap=0.523]Epoch 1:  12%|‚ñà‚ñé        | 2/16 [00:11<01:17,  0.18it/s, v_num=8820, train_loss=0.322, train_micro_ap=0.502, val_loss=0.327, val_micro_ap=0.523]Epoch 1:  12%|‚ñà‚ñé        | 2/16 [00:12<01:27,  0.16it/s, v_num=8820, train_loss=0.319, train_micro_ap=0.518, val_loss=0.327, val_micro_ap=0.523]Epoch 1:  19%|‚ñà‚ñâ        | 3/16 [00:13<01:00,  0.22it/s, v_num=8820, train_loss=0.319, train_micro_ap=0.518, val_loss=0.327, val_micro_ap=0.523]Epoch 1:  19%|‚ñà‚ñâ        | 3/16 [00:15<01:06,  0.19it/s, v_num=8820, train_loss=0.319, train_micro_ap=0.494, val_loss=0.327, val_micro_ap=0.523]Epoch 1:  25%|‚ñà‚ñà‚ñå       | 4/16 [00:16<00:50,  0.24it/s, v_num=8820, train_loss=0.319, train_micro_ap=0.494, val_loss=0.327, val_micro_ap=0.523]Epoch 1:  25%|‚ñà‚ñà‚ñå       | 4/16 [00:18<00:54,  0.22it/s, v_num=8820, train_loss=0.314, train_micro_ap=0.492, val_loss=0.327, val_micro_ap=0.523]Epoch 1:  31%|‚ñà‚ñà‚ñà‚ñè      | 5/16 [00:19<00:43,  0.25it/s, v_num=8820, train_loss=0.314, train_micro_ap=0.492, val_loss=0.327, val_micro_ap=0.523]Epoch 1:  31%|‚ñà‚ñà‚ñà‚ñè      | 5/16 [00:21<00:46,  0.24it/s, v_num=8820, train_loss=0.327, train_micro_ap=0.496, val_loss=0.327, val_micro_ap=0.523]Epoch 1:  38%|‚ñà‚ñà‚ñà‚ñä      | 6/16 [00:22<00:37,  0.27it/s, v_num=8820, train_loss=0.327, train_micro_ap=0.496, val_loss=0.327, val_micro_ap=0.523]Epoch 1:  38%|‚ñà‚ñà‚ñà‚ñä      | 6/16 [00:23<00:39,  0.25it/s, v_num=8820, train_loss=0.313, train_micro_ap=0.512, val_loss=0.327, val_micro_ap=0.523]Epoch 1:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 7/16 [00:25<00:32,  0.28it/s, v_num=8820, train_loss=0.313, train_micro_ap=0.512, val_loss=0.327, val_micro_ap=0.523]Epoch 1:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 7/16 [00:26<00:34,  0.26it/s, v_num=8820, train_loss=0.324, train_micro_ap=0.512, val_loss=0.327, val_micro_ap=0.523]Epoch 1:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 8/16 [00:28<00:28,  0.28it/s, v_num=8820, train_loss=0.324, train_micro_ap=0.512, val_loss=0.327, val_micro_ap=0.523]Epoch 1:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 8/16 [00:29<00:29,  0.27it/s, v_num=8820, train_loss=0.330, train_micro_ap=0.521, val_loss=0.327, val_micro_ap=0.523]Epoch 1:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 9/16 [00:30<00:24,  0.29it/s, v_num=8820, train_loss=0.330, train_micro_ap=0.521, val_loss=0.327, val_micro_ap=0.523]Epoch 1:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 9/16 [00:32<00:25,  0.28it/s, v_num=8820, train_loss=0.312, train_micro_ap=0.534, val_loss=0.327, val_micro_ap=0.523]Epoch 1:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 10/16 [00:33<00:20,  0.30it/s, v_num=8820, train_loss=0.312, train_micro_ap=0.534, val_loss=0.327, val_micro_ap=0.523]Epoch 1:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 10/16 [00:35<00:21,  0.28it/s, v_num=8820, train_loss=0.320, train_micro_ap=0.515, val_loss=0.327, val_micro_ap=0.523]Epoch 1:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 11/16 [00:36<00:16,  0.30it/s, v_num=8820, train_loss=0.320, train_micro_ap=0.515, val_loss=0.327, val_micro_ap=0.523]Epoch 1:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 11/16 [00:38<00:17,  0.29it/s, v_num=8820, train_loss=0.319, train_micro_ap=0.517, val_loss=0.327, val_micro_ap=0.523]Epoch 1:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 12/16 [00:39<00:13,  0.30it/s, v_num=8820, train_loss=0.319, train_micro_ap=0.517, val_loss=0.327, val_micro_ap=0.523]Epoch 1:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 12/16 [00:40<00:13,  0.29it/s, v_num=8820, train_loss=0.331, train_micro_ap=0.489, val_loss=0.327, val_micro_ap=0.523]Epoch 1:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 13/16 [00:42<00:09,  0.31it/s, v_num=8820, train_loss=0.331, train_micro_ap=0.489, val_loss=0.327, val_micro_ap=0.523]Epoch 1:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 13/16 [00:43<00:10,  0.30it/s, v_num=8820, train_loss=0.312, train_micro_ap=0.522, val_loss=0.327, val_micro_ap=0.523]Epoch 1:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 14/16 [00:45<00:06,  0.31it/s, v_num=8820, train_loss=0.312, train_micro_ap=0.522, val_loss=0.327, val_micro_ap=0.523]Epoch 1:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 14/16 [00:46<00:06,  0.30it/s, v_num=8820, train_loss=0.323, train_micro_ap=0.504, val_loss=0.327, val_micro_ap=0.523]Epoch 1:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 15/16 [00:48<00:03,  0.31it/s, v_num=8820, train_loss=0.323, train_micro_ap=0.504, val_loss=0.327, val_micro_ap=0.523]Epoch 1:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 15/16 [00:49<00:03,  0.30it/s, v_num=8820, train_loss=0.328, train_micro_ap=0.501, val_loss=0.327, val_micro_ap=0.523]Epoch 1: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 16/16 [00:50<00:00,  0.32it/s, v_num=8820, train_loss=0.328, train_micro_ap=0.501, val_loss=0.327, val_micro_ap=0.523]Epoch 1: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 16/16 [00:51<00:00,  0.31it/s, v_num=8820, train_loss=0.320, train_micro_ap=0.534, val_loss=0.327, val_micro_ap=0.523][96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m

Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:01<00:03,  0.98it/s][A
Validation DataLoader 0:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:02<00:02,  0.85it/s][A
Validation DataLoader 0:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:03<00:01,  0.81it/s][A
Validation DataLoader 0: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:04<00:00,  0.82it/s][A
/faststorage/arne/mamba/envs/cl_lora_env/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py:4631: UserWarning: No device id is provided via `init_process_group` or `barrier `. Using the current device set by the user. 
  warnings.warn(  # warn only once
Epoch 1, global step 32: 'val_loss' reached 0.32368 (best 0.32368), saving model to 'saved_models/lightning_logs/version_8820/checkpoints/epoch=1-step=32.ckpt' as top 1
                                                                      [AEpoch 1: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 16/16 [01:02<00:00,  0.25it/s, v_num=8820, train_loss=0.320, train_micro_ap=0.534, val_loss=0.324, val_micro_ap=0.523]Epoch 1: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 16/16 [01:02<00:00,  0.25it/s, v_num=8820, train_loss=0.320, train_micro_ap=0.534, val_loss=0.324, val_micro_ap=0.523]Epoch 1:   0%|          | 0/16 [00:00<?, ?it/s, v_num=8820, train_loss=0.320, train_micro_ap=0.534, val_loss=0.324, val_micro_ap=0.523]         Epoch 2:   0%|          | 0/16 [00:00<?, ?it/s, v_num=8820, train_loss=0.320, train_micro_ap=0.534, val_loss=0.324, val_micro_ap=0.523][96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
Epoch 2:   6%|‚ñã         | 1/16 [00:07<01:59,  0.13it/s, v_num=8820, train_loss=0.320, train_micro_ap=0.534, val_loss=0.324, val_micro_ap=0.523]Epoch 2:   6%|‚ñã         | 1/16 [00:09<02:21,  0.11it/s, v_num=8820, train_loss=0.322, train_micro_ap=0.516, val_loss=0.324, val_micro_ap=0.523]Epoch 2:  12%|‚ñà‚ñé        | 2/16 [00:10<01:15,  0.18it/s, v_num=8820, train_loss=0.322, train_micro_ap=0.516, val_loss=0.324, val_micro_ap=0.523]Epoch 2:  12%|‚ñà‚ñé        | 2/16 [00:12<01:26,  0.16it/s, v_num=8820, train_loss=0.328, train_micro_ap=0.483, val_loss=0.324, val_micro_ap=0.523]Epoch 2:  19%|‚ñà‚ñâ        | 3/16 [00:13<00:59,  0.22it/s, v_num=8820, train_loss=0.328, train_micro_ap=0.483, val_loss=0.324, val_micro_ap=0.523]Epoch 2:  19%|‚ñà‚ñâ        | 3/16 [00:15<01:05,  0.20it/s, v_num=8820, train_loss=0.317, train_micro_ap=0.517, val_loss=0.324, val_micro_ap=0.523]Epoch 2:  25%|‚ñà‚ñà‚ñå       | 4/16 [00:16<00:49,  0.24it/s, v_num=8820, train_loss=0.317, train_micro_ap=0.517, val_loss=0.324, val_micro_ap=0.523]Epoch 2:  25%|‚ñà‚ñà‚ñå       | 4/16 [00:17<00:53,  0.22it/s, v_num=8820, train_loss=0.302, train_micro_ap=0.530, val_loss=0.324, val_micro_ap=0.523]Epoch 2:  31%|‚ñà‚ñà‚ñà‚ñè      | 5/16 [00:19<00:42,  0.26it/s, v_num=8820, train_loss=0.302, train_micro_ap=0.530, val_loss=0.324, val_micro_ap=0.523]Epoch 2:  31%|‚ñà‚ñà‚ñà‚ñè      | 5/16 [00:20<00:45,  0.24it/s, v_num=8820, train_loss=0.323, train_micro_ap=0.509, val_loss=0.324, val_micro_ap=0.523]Epoch 2:  38%|‚ñà‚ñà‚ñà‚ñä      | 6/16 [00:22<00:37,  0.27it/s, v_num=8820, train_loss=0.323, train_micro_ap=0.509, val_loss=0.324, val_micro_ap=0.523]Epoch 2:  38%|‚ñà‚ñà‚ñà‚ñä      | 6/16 [00:23<00:39,  0.25it/s, v_num=8820, train_loss=0.316, train_micro_ap=0.530, val_loss=0.324, val_micro_ap=0.523]Epoch 2:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 7/16 [00:25<00:32,  0.28it/s, v_num=8820, train_loss=0.316, train_micro_ap=0.530, val_loss=0.324, val_micro_ap=0.523]Epoch 2:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 7/16 [00:26<00:34,  0.26it/s, v_num=8820, train_loss=0.319, train_micro_ap=0.536, val_loss=0.324, val_micro_ap=0.523]Epoch 2:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 8/16 [00:27<00:27,  0.29it/s, v_num=8820, train_loss=0.319, train_micro_ap=0.536, val_loss=0.324, val_micro_ap=0.523]Epoch 2:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 8/16 [00:29<00:29,  0.27it/s, v_num=8820, train_loss=0.321, train_micro_ap=0.536, val_loss=0.324, val_micro_ap=0.523]Epoch 2:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 9/16 [00:30<00:23,  0.29it/s, v_num=8820, train_loss=0.321, train_micro_ap=0.536, val_loss=0.324, val_micro_ap=0.523]Epoch 2:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 9/16 [00:32<00:25,  0.28it/s, v_num=8820, train_loss=0.313, train_micro_ap=0.537, val_loss=0.324, val_micro_ap=0.523]Epoch 2:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 10/16 [00:33<00:20,  0.30it/s, v_num=8820, train_loss=0.313, train_micro_ap=0.537, val_loss=0.324, val_micro_ap=0.523]Epoch 2:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 10/16 [00:35<00:21,  0.29it/s, v_num=8820, train_loss=0.316, train_micro_ap=0.509, val_loss=0.324, val_micro_ap=0.523]Epoch 2:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 11/16 [00:36<00:16,  0.30it/s, v_num=8820, train_loss=0.316, train_micro_ap=0.509, val_loss=0.324, val_micro_ap=0.523]Epoch 2:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 11/16 [00:37<00:17,  0.29it/s, v_num=8820, train_loss=0.322, train_micro_ap=0.487, val_loss=0.324, val_micro_ap=0.523]Epoch 2:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 12/16 [00:39<00:13,  0.31it/s, v_num=8820, train_loss=0.322, train_micro_ap=0.487, val_loss=0.324, val_micro_ap=0.523]Epoch 2:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 12/16 [00:40<00:13,  0.29it/s, v_num=8820, train_loss=0.312, train_micro_ap=0.523, val_loss=0.324, val_micro_ap=0.523]Epoch 2:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 13/16 [00:42<00:09,  0.31it/s, v_num=8820, train_loss=0.312, train_micro_ap=0.523, val_loss=0.324, val_micro_ap=0.523]Epoch 2:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 13/16 [00:43<00:10,  0.30it/s, v_num=8820, train_loss=0.320, train_micro_ap=0.477, val_loss=0.324, val_micro_ap=0.523]Epoch 2:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 14/16 [00:44<00:06,  0.31it/s, v_num=8820, train_loss=0.320, train_micro_ap=0.477, val_loss=0.324, val_micro_ap=0.523]Epoch 2:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 14/16 [00:46<00:06,  0.30it/s, v_num=8820, train_loss=0.323, train_micro_ap=0.532, val_loss=0.324, val_micro_ap=0.523]Epoch 2:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 15/16 [00:47<00:03,  0.31it/s, v_num=8820, train_loss=0.323, train_micro_ap=0.532, val_loss=0.324, val_micro_ap=0.523]Epoch 2:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 15/16 [00:49<00:03,  0.30it/s, v_num=8820, train_loss=0.317, train_micro_ap=0.529, val_loss=0.324, val_micro_ap=0.523]Epoch 2: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 16/16 [00:50<00:00,  0.32it/s, v_num=8820, train_loss=0.317, train_micro_ap=0.529, val_loss=0.324, val_micro_ap=0.523]Epoch 2: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 16/16 [00:50<00:00,  0.31it/s, v_num=8820, train_loss=0.329, train_micro_ap=0.476, val_loss=0.324, val_micro_ap=0.523][96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m

Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:01<00:03,  0.97it/s][A
Validation DataLoader 0:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:02<00:02,  0.85it/s][A
Validation DataLoader 0:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:03<00:01,  0.81it/s][A
Validation DataLoader 0: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:04<00:00,  0.82it/s][A
/faststorage/arne/mamba/envs/cl_lora_env/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py:4631: UserWarning: No device id is provided via `init_process_group` or `barrier `. Using the current device set by the user. 
  warnings.warn(  # warn only once
Epoch 2, global step 48: 'val_loss' reached 0.32270 (best 0.32270), saving model to 'saved_models/lightning_logs/version_8820/checkpoints/epoch=2-step=48.ckpt' as top 1
                                                                      [AEpoch 2: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 16/16 [01:02<00:00,  0.26it/s, v_num=8820, train_loss=0.329, train_micro_ap=0.476, val_loss=0.323, val_micro_ap=0.521]Epoch 2: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 16/16 [01:02<00:00,  0.26it/s, v_num=8820, train_loss=0.329, train_micro_ap=0.476, val_loss=0.323, val_micro_ap=0.521]Epoch 2:   0%|          | 0/16 [00:00<?, ?it/s, v_num=8820, train_loss=0.329, train_micro_ap=0.476, val_loss=0.323, val_micro_ap=0.521]         Epoch 3:   0%|          | 0/16 [00:00<?, ?it/s, v_num=8820, train_loss=0.329, train_micro_ap=0.476, val_loss=0.323, val_micro_ap=0.521][96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
Epoch 3:   6%|‚ñã         | 1/16 [00:07<01:57,  0.13it/s, v_num=8820, train_loss=0.329, train_micro_ap=0.476, val_loss=0.323, val_micro_ap=0.521]Epoch 3:   6%|‚ñã         | 1/16 [00:09<02:19,  0.11it/s, v_num=8820, train_loss=0.313, train_micro_ap=0.494, val_loss=0.323, val_micro_ap=0.521]Epoch 3:  12%|‚ñà‚ñé        | 2/16 [00:11<01:17,  0.18it/s, v_num=8820, train_loss=0.313, train_micro_ap=0.494, val_loss=0.323, val_micro_ap=0.521]Epoch 3:  12%|‚ñà‚ñé        | 2/16 [00:12<01:27,  0.16it/s, v_num=8820, train_loss=0.318, train_micro_ap=0.515, val_loss=0.323, val_micro_ap=0.521]Epoch 3:  19%|‚ñà‚ñâ        | 3/16 [00:13<01:00,  0.22it/s, v_num=8820, train_loss=0.318, train_micro_ap=0.515, val_loss=0.323, val_micro_ap=0.521]Epoch 3:  19%|‚ñà‚ñâ        | 3/16 [00:15<01:06,  0.20it/s, v_num=8820, train_loss=0.323, train_micro_ap=0.490, val_loss=0.323, val_micro_ap=0.521]Epoch 3:  25%|‚ñà‚ñà‚ñå       | 4/16 [00:16<00:50,  0.24it/s, v_num=8820, train_loss=0.323, train_micro_ap=0.490, val_loss=0.323, val_micro_ap=0.521]Epoch 3:  25%|‚ñà‚ñà‚ñå       | 4/16 [00:18<00:54,  0.22it/s, v_num=8820, train_loss=0.320, train_micro_ap=0.513, val_loss=0.323, val_micro_ap=0.521]Epoch 3:  31%|‚ñà‚ñà‚ñà‚ñè      | 5/16 [00:19<00:43,  0.26it/s, v_num=8820, train_loss=0.320, train_micro_ap=0.513, val_loss=0.323, val_micro_ap=0.521]Epoch 3:  31%|‚ñà‚ñà‚ñà‚ñè      | 5/16 [00:21<00:46,  0.24it/s, v_num=8820, train_loss=0.323, train_micro_ap=0.498, val_loss=0.323, val_micro_ap=0.521]Epoch 3:  38%|‚ñà‚ñà‚ñà‚ñä      | 6/16 [00:22<00:37,  0.27it/s, v_num=8820, train_loss=0.323, train_micro_ap=0.498, val_loss=0.323, val_micro_ap=0.521]Epoch 3:  38%|‚ñà‚ñà‚ñà‚ñä      | 6/16 [00:23<00:39,  0.25it/s, v_num=8820, train_loss=0.304, train_micro_ap=0.521, val_loss=0.323, val_micro_ap=0.521]Epoch 3:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 7/16 [00:25<00:32,  0.28it/s, v_num=8820, train_loss=0.304, train_micro_ap=0.521, val_loss=0.323, val_micro_ap=0.521]Epoch 3:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 7/16 [00:26<00:34,  0.26it/s, v_num=8820, train_loss=0.317, train_micro_ap=0.511, val_loss=0.323, val_micro_ap=0.521]Epoch 3:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 8/16 [00:28<00:28,  0.28it/s, v_num=8820, train_loss=0.317, train_micro_ap=0.511, val_loss=0.323, val_micro_ap=0.521]Epoch 3:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 8/16 [00:29<00:29,  0.27it/s, v_num=8820, train_loss=0.316, train_micro_ap=0.521, val_loss=0.323, val_micro_ap=0.521]Epoch 3:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 9/16 [00:30<00:24,  0.29it/s, v_num=8820, train_loss=0.316, train_micro_ap=0.521, val_loss=0.323, val_micro_ap=0.521]Epoch 3:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 9/16 [00:32<00:25,  0.28it/s, v_num=8820, train_loss=0.315, train_micro_ap=0.523, val_loss=0.323, val_micro_ap=0.521]Epoch 3:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 10/16 [00:33<00:20,  0.30it/s, v_num=8820, train_loss=0.315, train_micro_ap=0.523, val_loss=0.323, val_micro_ap=0.521]Epoch 3:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 10/16 [00:35<00:21,  0.28it/s, v_num=8820, train_loss=0.313, train_micro_ap=0.507, val_loss=0.323, val_micro_ap=0.521]Epoch 3:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 11/16 [00:36<00:16,  0.30it/s, v_num=8820, train_loss=0.313, train_micro_ap=0.507, val_loss=0.323, val_micro_ap=0.521]Epoch 3:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 11/16 [00:38<00:17,  0.29it/s, v_num=8820, train_loss=0.309, train_micro_ap=0.557, val_loss=0.323, val_micro_ap=0.521]Epoch 3:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 12/16 [00:39<00:13,  0.30it/s, v_num=8820, train_loss=0.309, train_micro_ap=0.557, val_loss=0.323, val_micro_ap=0.521]Epoch 3:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 12/16 [00:40<00:13,  0.29it/s, v_num=8820, train_loss=0.324, train_micro_ap=0.530, val_loss=0.323, val_micro_ap=0.521]Epoch 3:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 13/16 [00:42<00:09,  0.31it/s, v_num=8820, train_loss=0.324, train_micro_ap=0.530, val_loss=0.323, val_micro_ap=0.521]Epoch 3:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 13/16 [00:43<00:10,  0.30it/s, v_num=8820, train_loss=0.316, train_micro_ap=0.504, val_loss=0.323, val_micro_ap=0.521]Epoch 3:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 14/16 [00:45<00:06,  0.31it/s, v_num=8820, train_loss=0.316, train_micro_ap=0.504, val_loss=0.323, val_micro_ap=0.521]Epoch 3:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 14/16 [00:46<00:06,  0.30it/s, v_num=8820, train_loss=0.340, train_micro_ap=0.503, val_loss=0.323, val_micro_ap=0.521]Epoch 3:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 15/16 [00:47<00:03,  0.31it/s, v_num=8820, train_loss=0.340, train_micro_ap=0.503, val_loss=0.323, val_micro_ap=0.521]Epoch 3:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 15/16 [00:49<00:03,  0.30it/s, v_num=8820, train_loss=0.317, train_micro_ap=0.524, val_loss=0.323, val_micro_ap=0.521]Epoch 3: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 16/16 [00:50<00:00,  0.32it/s, v_num=8820, train_loss=0.317, train_micro_ap=0.524, val_loss=0.323, val_micro_ap=0.521]Epoch 3: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 16/16 [00:51<00:00,  0.31it/s, v_num=8820, train_loss=0.307, train_micro_ap=0.534, val_loss=0.323, val_micro_ap=0.521][96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m

Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:01<00:03,  0.99it/s][A
Validation DataLoader 0:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:02<00:02,  0.86it/s][A
Validation DataLoader 0:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:03<00:01,  0.82it/s][A
Validation DataLoader 0: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:04<00:00,  0.82it/s][A
/faststorage/arne/mamba/envs/cl_lora_env/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py:4631: UserWarning: No device id is provided via `init_process_group` or `barrier `. Using the current device set by the user. 
  warnings.warn(  # warn only once
Epoch 3, global step 64: 'val_loss' reached 0.32177 (best 0.32177), saving model to 'saved_models/lightning_logs/version_8820/checkpoints/epoch=3-step=64.ckpt' as top 1
                                                                      [AEpoch 3: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 16/16 [01:02<00:00,  0.25it/s, v_num=8820, train_loss=0.307, train_micro_ap=0.534, val_loss=0.322, val_micro_ap=0.524]Epoch 3: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 16/16 [01:02<00:00,  0.25it/s, v_num=8820, train_loss=0.307, train_micro_ap=0.534, val_loss=0.322, val_micro_ap=0.524]Epoch 3:   0%|          | 0/16 [00:00<?, ?it/s, v_num=8820, train_loss=0.307, train_micro_ap=0.534, val_loss=0.322, val_micro_ap=0.524]         Epoch 4:   0%|          | 0/16 [00:00<?, ?it/s, v_num=8820, train_loss=0.307, train_micro_ap=0.534, val_loss=0.322, val_micro_ap=0.524][96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
Epoch 4:   6%|‚ñã         | 1/16 [00:07<01:57,  0.13it/s, v_num=8820, train_loss=0.307, train_micro_ap=0.534, val_loss=0.322, val_micro_ap=0.524]Epoch 4:   6%|‚ñã         | 1/16 [00:09<02:19,  0.11it/s, v_num=8820, train_loss=0.319, train_micro_ap=0.510, val_loss=0.322, val_micro_ap=0.524]Epoch 4:  12%|‚ñà‚ñé        | 2/16 [00:10<01:16,  0.18it/s, v_num=8820, train_loss=0.319, train_micro_ap=0.510, val_loss=0.322, val_micro_ap=0.524]Epoch 4:  12%|‚ñà‚ñé        | 2/16 [00:12<01:26,  0.16it/s, v_num=8820, train_loss=0.312, train_micro_ap=0.533, val_loss=0.322, val_micro_ap=0.524]Epoch 4:  19%|‚ñà‚ñâ        | 3/16 [00:13<00:59,  0.22it/s, v_num=8820, train_loss=0.312, train_micro_ap=0.533, val_loss=0.322, val_micro_ap=0.524]Epoch 4:  19%|‚ñà‚ñâ        | 3/16 [00:15<01:05,  0.20it/s, v_num=8820, train_loss=0.315, train_micro_ap=0.520, val_loss=0.322, val_micro_ap=0.524]Epoch 4:  25%|‚ñà‚ñà‚ñå       | 4/16 [00:16<00:49,  0.24it/s, v_num=8820, train_loss=0.315, train_micro_ap=0.520, val_loss=0.322, val_micro_ap=0.524]Epoch 4:  25%|‚ñà‚ñà‚ñå       | 4/16 [00:18<00:54,  0.22it/s, v_num=8820, train_loss=0.332, train_micro_ap=0.482, val_loss=0.322, val_micro_ap=0.524]Epoch 4:  31%|‚ñà‚ñà‚ñà‚ñè      | 5/16 [00:19<00:42,  0.26it/s, v_num=8820, train_loss=0.332, train_micro_ap=0.482, val_loss=0.322, val_micro_ap=0.524]Epoch 4:  31%|‚ñà‚ñà‚ñà‚ñè      | 5/16 [00:20<00:46,  0.24it/s, v_num=8820, train_loss=0.315, train_micro_ap=0.519, val_loss=0.322, val_micro_ap=0.524]Epoch 4:  38%|‚ñà‚ñà‚ñà‚ñä      | 6/16 [00:22<00:37,  0.27it/s, v_num=8820, train_loss=0.315, train_micro_ap=0.519, val_loss=0.322, val_micro_ap=0.524]Epoch 4:  38%|‚ñà‚ñà‚ñà‚ñä      | 6/16 [00:23<00:39,  0.25it/s, v_num=8820, train_loss=0.320, train_micro_ap=0.515, val_loss=0.322, val_micro_ap=0.524]Epoch 4:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 7/16 [00:25<00:32,  0.28it/s, v_num=8820, train_loss=0.320, train_micro_ap=0.515, val_loss=0.322, val_micro_ap=0.524]Epoch 4:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 7/16 [00:26<00:34,  0.26it/s, v_num=8820, train_loss=0.318, train_micro_ap=0.514, val_loss=0.322, val_micro_ap=0.524]Epoch 4:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 8/16 [00:27<00:27,  0.29it/s, v_num=8820, train_loss=0.318, train_micro_ap=0.514, val_loss=0.322, val_micro_ap=0.524]Epoch 4:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 8/16 [00:29<00:29,  0.27it/s, v_num=8820, train_loss=0.305, train_micro_ap=0.521, val_loss=0.322, val_micro_ap=0.524]Epoch 4:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 9/16 [00:30<00:23,  0.29it/s, v_num=8820, train_loss=0.305, train_micro_ap=0.521, val_loss=0.322, val_micro_ap=0.524]Epoch 4:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 9/16 [00:32<00:25,  0.28it/s, v_num=8820, train_loss=0.315, train_micro_ap=0.485, val_loss=0.322, val_micro_ap=0.524]Epoch 4:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 10/16 [00:33<00:20,  0.30it/s, v_num=8820, train_loss=0.315, train_micro_ap=0.485, val_loss=0.322, val_micro_ap=0.524]Epoch 4:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 10/16 [00:35<00:21,  0.28it/s, v_num=8820, train_loss=0.309, train_micro_ap=0.524, val_loss=0.322, val_micro_ap=0.524]Epoch 4:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 11/16 [00:36<00:16,  0.30it/s, v_num=8820, train_loss=0.309, train_micro_ap=0.524, val_loss=0.322, val_micro_ap=0.524]Epoch 4:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 11/16 [00:37<00:17,  0.29it/s, v_num=8820, train_loss=0.322, train_micro_ap=0.487, val_loss=0.322, val_micro_ap=0.524]Epoch 4:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 12/16 [00:39<00:13,  0.31it/s, v_num=8820, train_loss=0.322, train_micro_ap=0.487, val_loss=0.322, val_micro_ap=0.524]Epoch 4:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 12/16 [00:40<00:13,  0.29it/s, v_num=8820, train_loss=0.325, train_micro_ap=0.512, val_loss=0.322, val_micro_ap=0.524]Epoch 4:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 13/16 [00:42<00:09,  0.31it/s, v_num=8820, train_loss=0.325, train_micro_ap=0.512, val_loss=0.322, val_micro_ap=0.524]Epoch 4:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 13/16 [00:43<00:10,  0.30it/s, v_num=8820, train_loss=0.317, train_micro_ap=0.536, val_loss=0.322, val_micro_ap=0.524]Epoch 4:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 14/16 [00:44<00:06,  0.31it/s, v_num=8820, train_loss=0.317, train_micro_ap=0.536, val_loss=0.322, val_micro_ap=0.524]Epoch 4:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 14/16 [00:46<00:06,  0.30it/s, v_num=8820, train_loss=0.316, train_micro_ap=0.535, val_loss=0.322, val_micro_ap=0.524]Epoch 4:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 15/16 [00:47<00:03,  0.31it/s, v_num=8820, train_loss=0.316, train_micro_ap=0.535, val_loss=0.322, val_micro_ap=0.524]Epoch 4:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 15/16 [00:49<00:03,  0.30it/s, v_num=8820, train_loss=0.319, train_micro_ap=0.529, val_loss=0.322, val_micro_ap=0.524]Epoch 4: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 16/16 [00:50<00:00,  0.32it/s, v_num=8820, train_loss=0.319, train_micro_ap=0.529, val_loss=0.322, val_micro_ap=0.524]Epoch 4: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 16/16 [00:51<00:00,  0.31it/s, v_num=8820, train_loss=0.317, train_micro_ap=0.505, val_loss=0.322, val_micro_ap=0.524][96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m

Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:01<00:03,  0.96it/s][A
Validation DataLoader 0:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:02<00:02,  0.84it/s][A
Validation DataLoader 0:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:03<00:01,  0.81it/s][A
Validation DataLoader 0: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:04<00:00,  0.81it/s][A
/faststorage/arne/mamba/envs/cl_lora_env/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py:4631: UserWarning: No device id is provided via `init_process_group` or `barrier `. Using the current device set by the user. 
  warnings.warn(  # warn only once
Epoch 4, global step 80: 'val_loss' was not in top 1
                                                                      [AEpoch 4: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 16/16 [01:02<00:00,  0.26it/s, v_num=8820, train_loss=0.317, train_micro_ap=0.505, val_loss=0.322, val_micro_ap=0.531]Epoch 4: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 16/16 [01:02<00:00,  0.26it/s, v_num=8820, train_loss=0.317, train_micro_ap=0.505, val_loss=0.322, val_micro_ap=0.531]Epoch 4:   0%|          | 0/16 [00:00<?, ?it/s, v_num=8820, train_loss=0.317, train_micro_ap=0.505, val_loss=0.322, val_micro_ap=0.531]         Epoch 5:   0%|          | 0/16 [00:00<?, ?it/s, v_num=8820, train_loss=0.317, train_micro_ap=0.505, val_loss=0.322, val_micro_ap=0.531][96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
Epoch 5:   6%|‚ñã         | 1/16 [00:07<01:58,  0.13it/s, v_num=8820, train_loss=0.317, train_micro_ap=0.505, val_loss=0.322, val_micro_ap=0.531]Epoch 5:   6%|‚ñã         | 1/16 [00:09<02:20,  0.11it/s, v_num=8820, train_loss=0.309, train_micro_ap=0.555, val_loss=0.322, val_micro_ap=0.531]Epoch 5:  12%|‚ñà‚ñé        | 2/16 [00:11<01:17,  0.18it/s, v_num=8820, train_loss=0.309, train_micro_ap=0.555, val_loss=0.322, val_micro_ap=0.531]Epoch 5:  12%|‚ñà‚ñé        | 2/16 [00:12<01:28,  0.16it/s, v_num=8820, train_loss=0.315, train_micro_ap=0.542, val_loss=0.322, val_micro_ap=0.531]Epoch 5:  19%|‚ñà‚ñâ        | 3/16 [00:13<01:00,  0.21it/s, v_num=8820, train_loss=0.315, train_micro_ap=0.542, val_loss=0.322, val_micro_ap=0.531]Epoch 5:  19%|‚ñà‚ñâ        | 3/16 [00:15<01:06,  0.19it/s, v_num=8820, train_loss=0.314, train_micro_ap=0.492, val_loss=0.322, val_micro_ap=0.531]Epoch 5:  25%|‚ñà‚ñà‚ñå       | 4/16 [00:16<00:50,  0.24it/s, v_num=8820, train_loss=0.314, train_micro_ap=0.492, val_loss=0.322, val_micro_ap=0.531]Epoch 5:  25%|‚ñà‚ñà‚ñå       | 4/16 [00:18<00:54,  0.22it/s, v_num=8820, train_loss=0.311, train_micro_ap=0.540, val_loss=0.322, val_micro_ap=0.531]Epoch 5:  31%|‚ñà‚ñà‚ñà‚ñè      | 5/16 [00:19<00:43,  0.25it/s, v_num=8820, train_loss=0.311, train_micro_ap=0.540, val_loss=0.322, val_micro_ap=0.531]Epoch 5:  31%|‚ñà‚ñà‚ñà‚ñè      | 5/16 [00:21<00:46,  0.24it/s, v_num=8820, train_loss=0.319, train_micro_ap=0.514, val_loss=0.322, val_micro_ap=0.531]Epoch 5:  38%|‚ñà‚ñà‚ñà‚ñä      | 6/16 [00:22<00:37,  0.27it/s, v_num=8820, train_loss=0.319, train_micro_ap=0.514, val_loss=0.322, val_micro_ap=0.531]Epoch 5:  38%|‚ñà‚ñà‚ñà‚ñä      | 6/16 [00:23<00:39,  0.25it/s, v_num=8820, train_loss=0.314, train_micro_ap=0.549, val_loss=0.322, val_micro_ap=0.531]Epoch 5:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 7/16 [00:25<00:32,  0.28it/s, v_num=8820, train_loss=0.314, train_micro_ap=0.549, val_loss=0.322, val_micro_ap=0.531]Epoch 5:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 7/16 [00:26<00:34,  0.26it/s, v_num=8820, train_loss=0.311, train_micro_ap=0.509, val_loss=0.322, val_micro_ap=0.531]Epoch 5:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 8/16 [00:28<00:28,  0.28it/s, v_num=8820, train_loss=0.311, train_micro_ap=0.509, val_loss=0.322, val_micro_ap=0.531]Epoch 5:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 8/16 [00:29<00:29,  0.27it/s, v_num=8820, train_loss=0.316, train_micro_ap=0.521, val_loss=0.322, val_micro_ap=0.531]Epoch 5:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 9/16 [00:31<00:24,  0.29it/s, v_num=8820, train_loss=0.316, train_micro_ap=0.521, val_loss=0.322, val_micro_ap=0.531]Epoch 5:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 9/16 [00:32<00:25,  0.28it/s, v_num=8820, train_loss=0.314, train_micro_ap=0.525, val_loss=0.322, val_micro_ap=0.531]Epoch 5:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 10/16 [00:33<00:20,  0.30it/s, v_num=8820, train_loss=0.314, train_micro_ap=0.525, val_loss=0.322, val_micro_ap=0.531]Epoch 5:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 10/16 [00:35<00:21,  0.28it/s, v_num=8820, train_loss=0.315, train_micro_ap=0.520, val_loss=0.322, val_micro_ap=0.531]Epoch 5:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 11/16 [00:36<00:16,  0.30it/s, v_num=8820, train_loss=0.315, train_micro_ap=0.520, val_loss=0.322, val_micro_ap=0.531]Epoch 5:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 11/16 [00:38<00:17,  0.29it/s, v_num=8820, train_loss=0.318, train_micro_ap=0.527, val_loss=0.322, val_micro_ap=0.531]Epoch 5:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 12/16 [00:39<00:13,  0.30it/s, v_num=8820, train_loss=0.318, train_micro_ap=0.527, val_loss=0.322, val_micro_ap=0.531]Epoch 5:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 12/16 [00:41<00:13,  0.29it/s, v_num=8820, train_loss=0.318, train_micro_ap=0.493, val_loss=0.322, val_micro_ap=0.531]Epoch 5:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 13/16 [00:42<00:09,  0.31it/s, v_num=8820, train_loss=0.318, train_micro_ap=0.493, val_loss=0.322, val_micro_ap=0.531]Epoch 5:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 13/16 [00:43<00:10,  0.30it/s, v_num=8820, train_loss=0.326, train_micro_ap=0.511, val_loss=0.322, val_micro_ap=0.531]Epoch 5:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 14/16 [00:45<00:06,  0.31it/s, v_num=8820, train_loss=0.326, train_micro_ap=0.511, val_loss=0.322, val_micro_ap=0.531]Epoch 5:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 14/16 [00:46<00:06,  0.30it/s, v_num=8820, train_loss=0.315, train_micro_ap=0.506, val_loss=0.322, val_micro_ap=0.531]Epoch 5:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 15/16 [00:48<00:03,  0.31it/s, v_num=8820, train_loss=0.315, train_micro_ap=0.506, val_loss=0.322, val_micro_ap=0.531]Epoch 5:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 15/16 [00:49<00:03,  0.30it/s, v_num=8820, train_loss=0.319, train_micro_ap=0.501, val_loss=0.322, val_micro_ap=0.531]Epoch 5: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 16/16 [00:50<00:00,  0.32it/s, v_num=8820, train_loss=0.319, train_micro_ap=0.501, val_loss=0.322, val_micro_ap=0.531]Epoch 5: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 16/16 [00:51<00:00,  0.31it/s, v_num=8820, train_loss=0.316, train_micro_ap=0.537, val_loss=0.322, val_micro_ap=0.531][96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m

Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:01<00:03,  0.98it/s][A
Validation DataLoader 0:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:02<00:02,  0.85it/s][A
Validation DataLoader 0:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:03<00:01,  0.82it/s][A
Validation DataLoader 0: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:04<00:00,  0.82it/s][A
/faststorage/arne/mamba/envs/cl_lora_env/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py:4631: UserWarning: No device id is provided via `init_process_group` or `barrier `. Using the current device set by the user. 
  warnings.warn(  # warn only once
Monitored metric val_loss did not improve in the last 5 records. Best score: 0.327. Signaling Trainer to stop.
Epoch 5, global step 96: 'val_loss' reached 0.32054 (best 0.32054), saving model to 'saved_models/lightning_logs/version_8820/checkpoints/epoch=5-step=96-v1.ckpt' as top 1
                                                                      [AEpoch 5: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 16/16 [01:02<00:00,  0.26it/s, v_num=8820, train_loss=0.316, train_micro_ap=0.537, val_loss=0.321, val_micro_ap=0.530]Epoch 5: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 16/16 [01:02<00:00,  0.26it/s, v_num=8820, train_loss=0.316, train_micro_ap=0.537, val_loss=0.321, val_micro_ap=0.530]Epoch 5: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 16/16 [01:03<00:00,  0.25it/s, v_num=8820, train_loss=0.316, train_micro_ap=0.537, val_loss=0.321, val_micro_ap=0.530][96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
2025-06-16 19:23:48,650 INFO Training time: 390.65s
2025-06-16 19:23:49,324 INFO Saved: ./saved_models/step4-Austria.pkl

[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
/faststorage/arne/mamba/envs/cl_lora_env/lib/python3.9/site-packages/sklearn/metrics/_ranking.py:1033: UserWarning: No positive class found in y_true, recall is set to one for all thresholds.
  warnings.warn(
/faststorage/arne/mamba/envs/cl_lora_env/lib/python3.9/site-packages/sklearn/metrics/_ranking.py:1033: UserWarning: No positive class found in y_true, recall is set to one for all thresholds.
  warnings.warn(
/faststorage/arne/mamba/envs/cl_lora_env/lib/python3.9/site-packages/sklearn/metrics/_ranking.py:1033: UserWarning: No positive class found in y_true, recall is set to one for all thresholds.
  warnings.warn(
/faststorage/arne/mamba/envs/cl_lora_env/lib/python3.9/site-packages/sklearn/metrics/_ranking.py:1033: UserWarning: No positive class found in y_true, recall is set to one for all thresholds.
  warnings.warn(
/faststorage/arne/mamba/envs/cl_lora_env/lib/python3.9/site-packages/sklearn/metrics/_ranking.py:1033: UserWarning: No positive class found in y_true, recall is set to one for all thresholds.
  warnings.warn(
/faststorage/arne/mamba/envs/cl_lora_env/lib/python3.9/site-packages/sklearn/metrics/_ranking.py:1033: UserWarning: No positive class found in y_true, recall is set to one for all thresholds.
  warnings.warn(
/faststorage/arne/mamba/envs/cl_lora_env/lib/python3.9/site-packages/sklearn/metrics/_ranking.py:1033: UserWarning: No positive class found in y_true, recall is set to one for all thresholds.
  warnings.warn(
[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
/faststorage/arne/mamba/envs/cl_lora_env/lib/python3.9/site-packages/sklearn/metrics/_ranking.py:1033: UserWarning: No positive class found in y_true, recall is set to one for all thresholds.
  warnings.warn(
/faststorage/arne/mamba/envs/cl_lora_env/lib/python3.9/site-packages/sklearn/metrics/_ranking.py:1033: UserWarning: No positive class found in y_true, recall is set to one for all thresholds.
  warnings.warn(
/faststorage/arne/mamba/envs/cl_lora_env/lib/python3.9/site-packages/sklearn/metrics/_ranking.py:1033: UserWarning: No positive class found in y_true, recall is set to one for all thresholds.
  warnings.warn(
/faststorage/arne/mamba/envs/cl_lora_env/lib/python3.9/site-packages/sklearn/metrics/_ranking.py:1033: UserWarning: No positive class found in y_true, recall is set to one for all thresholds.
  warnings.warn(
[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
/faststorage/arne/mamba/envs/cl_lora_env/lib/python3.9/site-packages/sklearn/metrics/_ranking.py:1033: UserWarning: No positive class found in y_true, recall is set to one for all thresholds.
  warnings.warn(
/faststorage/arne/mamba/envs/cl_lora_env/lib/python3.9/site-packages/sklearn/metrics/_ranking.py:1033: UserWarning: No positive class found in y_true, recall is set to one for all thresholds.
  warnings.warn(
/faststorage/arne/mamba/envs/cl_lora_env/lib/python3.9/site-packages/sklearn/metrics/_ranking.py:1033: UserWarning: No positive class found in y_true, recall is set to one for all thresholds.
  warnings.warn(
/faststorage/arne/mamba/envs/cl_lora_env/lib/python3.9/site-packages/sklearn/metrics/_ranking.py:1033: UserWarning: No positive class found in y_true, recall is set to one for all thresholds.
  warnings.warn(
/faststorage/arne/mamba/envs/cl_lora_env/lib/python3.9/site-packages/sklearn/metrics/_ranking.py:1033: UserWarning: No positive class found in y_true, recall is set to one for all thresholds.
  warnings.warn(
[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
/faststorage/arne/mamba/envs/cl_lora_env/lib/python3.9/site-packages/sklearn/metrics/_ranking.py:1033: UserWarning: No positive class found in y_true, recall is set to one for all thresholds.
  warnings.warn(
/faststorage/arne/mamba/envs/cl_lora_env/lib/python3.9/site-packages/sklearn/metrics/_ranking.py:1033: UserWarning: No positive class found in y_true, recall is set to one for all thresholds.
  warnings.warn(
/faststorage/arne/mamba/envs/cl_lora_env/lib/python3.9/site-packages/sklearn/metrics/_ranking.py:1033: UserWarning: No positive class found in y_true, recall is set to one for all thresholds.
  warnings.warn(
/faststorage/arne/mamba/envs/cl_lora_env/lib/python3.9/site-packages/sklearn/metrics/_ranking.py:1033: UserWarning: No positive class found in y_true, recall is set to one for all thresholds.
  warnings.warn(
2025-06-16 19:24:13,070 INFO Eval time: 23.75s
2025-06-16 19:24:13,070 INFO Result: {'step': 4, 'countries': ('Finland', 'Ireland', 'Serbia', 'Austria'), 'train_time_s': 390.65232157707214, 'eval_time_s': 23.745357036590576, 'Finland_micro_ap': np.float64(0.25620157871509447), 'Finland_macro_ap': np.float64(0.20316090386447386), 'Finland_accuracy': 83.2421052631579, 'Ireland_micro_ap': np.float64(0.2648846571649042), 'Ireland_macro_ap': np.float64(0.14465602311949172), 'Ireland_accuracy': 88.6842105263158, 'Serbia_micro_ap': np.float64(0.3779196497826171), 'Serbia_macro_ap': np.float64(0.17830292733254177), 'Serbia_accuracy': 85.08421052631579, 'Austria_micro_ap': np.float64(0.47474074965610563), 'Austria_macro_ap': np.float64(0.21889058571774844), 'Austria_accuracy': 83.08421052631579, 'mean_micro_ap': np.float64(0.34343665882968033), 'mean_macro_ap': np.float64(0.18625261000856394), 'mean_accuracy': 85.02368421052631}
2025-06-16 19:24:13,070 INFO Step 5: Countries ['Finland', 'Ireland', 'Serbia', 'Austria', 'Portugal']
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/faststorage/arne/mamba/envs/cl_lora_env/lib/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:654: Checkpoint directory saved_models/lightning_logs/version_8820/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name              | Type              | Params | Mode 
----------------------------------------------------------------
0 | feature_extractor | LoRA_ViT_timm     | 87.4 M | eval 
1 | classifier        | Linear            | 14.6 K | train
2 | criterion         | BCEWithLogitsLoss | 0      | train
----------------------------------------------------------------
162 K     Trainable params
87.2 M    Non-trainable params
87.4 M    Total params
349.572   Total estimated model params size (MB)
2         Modules in train mode
272       Modules in eval mode
SLURM auto-requeueing enabled. Setting signal handlers.
/faststorage/arne/mamba/envs/cl_lora_env/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py:4631: UserWarning: No device id is provided via `init_process_group` or `barrier `. Using the current device set by the user. 
  warnings.warn(  # warn only once
/faststorage/arne/mamba/envs/cl_lora_env/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py:4631: UserWarning: No device id is provided via `init_process_group` or `barrier `. Using the current device set by the user. 
  warnings.warn(  # warn only once
/faststorage/arne/mamba/envs/cl_lora_env/lib/python3.9/site-packages/pytorch_lightning/loops/fit_loop.py:310: The number of training batches (16) is smaller than the logging interval Trainer(log_every_n_steps=50). Set a lower value for log_every_n_steps if you want to see logs for the training epoch.
Sanity Checking: |          | 0/? [00:00<?, ?it/s]Sanity Checking:   0%|          | 0/2 [00:00<?, ?it/s]Sanity Checking DataLoader 0:   0%|          | 0/2 [00:00<?, ?it/s]Sanity Checking DataLoader 0:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:01<00:01,  0.99it/s]Sanity Checking DataLoader 0: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 2/2 [00:02<00:00,  0.85it/s]                                                                           Training: |          | 0/? [00:00<?, ?it/s]Training:   0%|          | 0/16 [00:00<?, ?it/s]Epoch 0:   0%|          | 0/16 [00:00<?, ?it/s] Epoch 0:   6%|‚ñã         | 1/16 [00:06<01:39,  0.15it/s]Epoch 0:   6%|‚ñã         | 1/16 [00:08<02:02,  0.12it/s, v_num=8820, train_loss=0.713, train_micro_ap=0.208]Epoch 0:  12%|‚ñà‚ñé        | 2/16 [00:09<01:06,  0.21it/s, v_num=8820, train_loss=0.713, train_micro_ap=0.208]Epoch 0:  12%|‚ñà‚ñé        | 2/16 [00:10<01:16,  0.18it/s, v_num=8820, train_loss=0.484, train_micro_ap=0.282]Epoch 0:  19%|‚ñà‚ñâ        | 3/16 [00:12<00:53,  0.24it/s, v_num=8820, train_loss=0.484, train_micro_ap=0.282]Epoch 0:  19%|‚ñà‚ñâ        | 3/16 [00:13<00:59,  0.22it/s, v_num=8820, train_loss=0.384, train_micro_ap=0.393]Epoch 0:  25%|‚ñà‚ñà‚ñå       | 4/16 [00:15<00:45,  0.26it/s, v_num=8820, train_loss=0.384, train_micro_ap=0.393]Epoch 0:  25%|‚ñà‚ñà‚ñå       | 4/16 [00:16<00:50,  0.24it/s, v_num=8820, train_loss=0.372, train_micro_ap=0.399]Epoch 0:  31%|‚ñà‚ñà‚ñà‚ñè      | 5/16 [00:18<00:39,  0.28it/s, v_num=8820, train_loss=0.372, train_micro_ap=0.399]Epoch 0:  31%|‚ñà‚ñà‚ñà‚ñè      | 5/16 [00:19<00:42,  0.26it/s, v_num=8820, train_loss=0.352, train_micro_ap=0.426]Epoch 0:  38%|‚ñà‚ñà‚ñà‚ñä      | 6/16 [00:20<00:34,  0.29it/s, v_num=8820, train_loss=0.352, train_micro_ap=0.426]Epoch 0:  38%|‚ñà‚ñà‚ñà‚ñä      | 6/16 [00:22<00:37,  0.27it/s, v_num=8820, train_loss=0.357, train_micro_ap=0.469]Epoch 0:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 7/16 [00:23<00:30,  0.29it/s, v_num=8820, train_loss=0.357, train_micro_ap=0.469]Epoch 0:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 7/16 [00:25<00:32,  0.28it/s, v_num=8820, train_loss=0.320, train_micro_ap=0.475]Epoch 0:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 8/16 [00:26<00:26,  0.30it/s, v_num=8820, train_loss=0.320, train_micro_ap=0.475]Epoch 0:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 8/16 [00:28<00:28,  0.29it/s, v_num=8820, train_loss=0.355, train_micro_ap=0.454]Epoch 0:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 9/16 [00:29<00:22,  0.31it/s, v_num=8820, train_loss=0.355, train_micro_ap=0.454]Epoch 0:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 9/16 [00:30<00:24,  0.29it/s, v_num=8820, train_loss=0.335, train_micro_ap=0.462]Epoch 0:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 10/16 [00:32<00:19,  0.31it/s, v_num=8820, train_loss=0.335, train_micro_ap=0.462]Epoch 0:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 10/16 [00:33<00:20,  0.30it/s, v_num=8820, train_loss=0.322, train_micro_ap=0.494]Epoch 0:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 11/16 [00:35<00:15,  0.31it/s, v_num=8820, train_loss=0.322, train_micro_ap=0.494]Epoch 0:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 11/16 [00:36<00:16,  0.30it/s, v_num=8820, train_loss=0.331, train_micro_ap=0.471]Epoch 0:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 12/16 [00:37<00:12,  0.32it/s, v_num=8820, train_loss=0.331, train_micro_ap=0.471]Epoch 0:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 12/16 [00:39<00:13,  0.30it/s, v_num=8820, train_loss=0.333, train_micro_ap=0.474]Epoch 0:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 13/16 [00:40<00:09,  0.32it/s, v_num=8820, train_loss=0.333, train_micro_ap=0.474]Epoch 0:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 13/16 [00:42<00:09,  0.31it/s, v_num=8820, train_loss=0.318, train_micro_ap=0.486]Epoch 0:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 14/16 [00:43<00:06,  0.32it/s, v_num=8820, train_loss=0.318, train_micro_ap=0.486]Epoch 0:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 14/16 [00:45<00:06,  0.31it/s, v_num=8820, train_loss=0.306, train_micro_ap=0.494]Epoch 0:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 15/16 [00:46<00:03,  0.32it/s, v_num=8820, train_loss=0.306, train_micro_ap=0.494]Epoch 0:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 15/16 [00:47<00:03,  0.31it/s, v_num=8820, train_loss=0.319, train_micro_ap=0.484]Epoch 0: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 16/16 [00:48<00:00,  0.33it/s, v_num=8820, train_loss=0.319, train_micro_ap=0.484]Epoch 0: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 16/16 [00:49<00:00,  0.32it/s, v_num=8820, train_loss=0.318, train_micro_ap=0.495][96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m

Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:01<00:03,  0.97it/s][A
Validation DataLoader 0:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:02<00:02,  0.85it/s][A
Validation DataLoader 0:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:03<00:01,  0.81it/s][A
Validation DataLoader 0: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:04<00:00,  0.82it/s][A
/faststorage/arne/mamba/envs/cl_lora_env/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py:4631: UserWarning: No device id is provided via `init_process_group` or `barrier `. Using the current device set by the user. 
  warnings.warn(  # warn only once
Metric val_loss improved. New best score: 0.324
Epoch 0, global step 16: 'val_loss' reached 0.32359 (best 0.32359), saving model to 'saved_models/lightning_logs/version_8820/checkpoints/epoch=0-step=16.ckpt' as top 1
                                                                      [AEpoch 0: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 16/16 [01:00<00:00,  0.26it/s, v_num=8820, train_loss=0.318, train_micro_ap=0.495, val_loss=0.324, val_micro_ap=0.485]Epoch 0: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 16/16 [01:01<00:00,  0.26it/s, v_num=8820, train_loss=0.318, train_micro_ap=0.495, val_loss=0.324, val_micro_ap=0.485]Epoch 0:   0%|          | 0/16 [00:00<?, ?it/s, v_num=8820, train_loss=0.318, train_micro_ap=0.495, val_loss=0.324, val_micro_ap=0.485]         Epoch 1:   0%|          | 0/16 [00:00<?, ?it/s, v_num=8820, train_loss=0.318, train_micro_ap=0.495, val_loss=0.324, val_micro_ap=0.485][96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
Epoch 1:   6%|‚ñã         | 1/16 [00:08<02:01,  0.12it/s, v_num=8820, train_loss=0.318, train_micro_ap=0.495, val_loss=0.324, val_micro_ap=0.485]Epoch 1:   6%|‚ñã         | 1/16 [00:09<02:23,  0.10it/s, v_num=8820, train_loss=0.309, train_micro_ap=0.522, val_loss=0.324, val_micro_ap=0.485]Epoch 1:  12%|‚ñà‚ñé        | 2/16 [00:10<01:16,  0.18it/s, v_num=8820, train_loss=0.309, train_micro_ap=0.522, val_loss=0.324, val_micro_ap=0.485]Epoch 1:  12%|‚ñà‚ñé        | 2/16 [00:12<01:27,  0.16it/s, v_num=8820, train_loss=0.318, train_micro_ap=0.463, val_loss=0.324, val_micro_ap=0.485]Epoch 1:  19%|‚ñà‚ñâ        | 3/16 [00:13<00:59,  0.22it/s, v_num=8820, train_loss=0.318, train_micro_ap=0.463, val_loss=0.324, val_micro_ap=0.485]Epoch 1:  19%|‚ñà‚ñâ        | 3/16 [00:15<01:06,  0.20it/s, v_num=8820, train_loss=0.311, train_micro_ap=0.478, val_loss=0.324, val_micro_ap=0.485]Epoch 1:  25%|‚ñà‚ñà‚ñå       | 4/16 [00:16<00:49,  0.24it/s, v_num=8820, train_loss=0.311, train_micro_ap=0.478, val_loss=0.324, val_micro_ap=0.485]Epoch 1:  25%|‚ñà‚ñà‚ñå       | 4/16 [00:18<00:54,  0.22it/s, v_num=8820, train_loss=0.319, train_micro_ap=0.477, val_loss=0.324, val_micro_ap=0.485]Epoch 1:  31%|‚ñà‚ñà‚ñà‚ñè      | 5/16 [00:19<00:42,  0.26it/s, v_num=8820, train_loss=0.319, train_micro_ap=0.477, val_loss=0.324, val_micro_ap=0.485]Epoch 1:  31%|‚ñà‚ñà‚ñà‚ñè      | 5/16 [00:20<00:46,  0.24it/s, v_num=8820, train_loss=0.309, train_micro_ap=0.474, val_loss=0.324, val_micro_ap=0.485]Epoch 1:  38%|‚ñà‚ñà‚ñà‚ñä      | 6/16 [00:22<00:37,  0.27it/s, v_num=8820, train_loss=0.309, train_micro_ap=0.474, val_loss=0.324, val_micro_ap=0.485]Epoch 1:  38%|‚ñà‚ñà‚ñà‚ñä      | 6/16 [00:23<00:39,  0.25it/s, v_num=8820, train_loss=0.316, train_micro_ap=0.473, val_loss=0.324, val_micro_ap=0.485]Epoch 1:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 7/16 [00:25<00:32,  0.28it/s, v_num=8820, train_loss=0.316, train_micro_ap=0.473, val_loss=0.324, val_micro_ap=0.485]Epoch 1:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 7/16 [00:26<00:34,  0.26it/s, v_num=8820, train_loss=0.316, train_micro_ap=0.482, val_loss=0.324, val_micro_ap=0.485]Epoch 1:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 8/16 [00:27<00:27,  0.29it/s, v_num=8820, train_loss=0.316, train_micro_ap=0.482, val_loss=0.324, val_micro_ap=0.485]Epoch 1:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 8/16 [00:29<00:29,  0.27it/s, v_num=8820, train_loss=0.310, train_micro_ap=0.520, val_loss=0.324, val_micro_ap=0.485]Epoch 1:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 9/16 [00:30<00:23,  0.29it/s, v_num=8820, train_loss=0.310, train_micro_ap=0.520, val_loss=0.324, val_micro_ap=0.485]Epoch 1:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 9/16 [00:32<00:25,  0.28it/s, v_num=8820, train_loss=0.318, train_micro_ap=0.492, val_loss=0.324, val_micro_ap=0.485]Epoch 1:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 10/16 [00:33<00:20,  0.30it/s, v_num=8820, train_loss=0.318, train_micro_ap=0.492, val_loss=0.324, val_micro_ap=0.485]Epoch 1:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 10/16 [00:35<00:21,  0.28it/s, v_num=8820, train_loss=0.289, train_micro_ap=0.521, val_loss=0.324, val_micro_ap=0.485]Epoch 1:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 11/16 [00:36<00:16,  0.30it/s, v_num=8820, train_loss=0.289, train_micro_ap=0.521, val_loss=0.324, val_micro_ap=0.485]Epoch 1:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 11/16 [00:37<00:17,  0.29it/s, v_num=8820, train_loss=0.288, train_micro_ap=0.542, val_loss=0.324, val_micro_ap=0.485]Epoch 1:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 12/16 [00:39<00:13,  0.31it/s, v_num=8820, train_loss=0.288, train_micro_ap=0.542, val_loss=0.324, val_micro_ap=0.485]Epoch 1:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 12/16 [00:40<00:13,  0.29it/s, v_num=8820, train_loss=0.313, train_micro_ap=0.504, val_loss=0.324, val_micro_ap=0.485]Epoch 1:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 13/16 [00:42<00:09,  0.31it/s, v_num=8820, train_loss=0.313, train_micro_ap=0.504, val_loss=0.324, val_micro_ap=0.485]Epoch 1:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 13/16 [00:43<00:10,  0.30it/s, v_num=8820, train_loss=0.310, train_micro_ap=0.471, val_loss=0.324, val_micro_ap=0.485]Epoch 1:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 14/16 [00:44<00:06,  0.31it/s, v_num=8820, train_loss=0.310, train_micro_ap=0.471, val_loss=0.324, val_micro_ap=0.485]Epoch 1:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 14/16 [00:46<00:06,  0.30it/s, v_num=8820, train_loss=0.328, train_micro_ap=0.467, val_loss=0.324, val_micro_ap=0.485]Epoch 1:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 15/16 [00:47<00:03,  0.31it/s, v_num=8820, train_loss=0.328, train_micro_ap=0.467, val_loss=0.324, val_micro_ap=0.485]Epoch 1:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 15/16 [00:49<00:03,  0.30it/s, v_num=8820, train_loss=0.304, train_micro_ap=0.518, val_loss=0.324, val_micro_ap=0.485]Epoch 1: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 16/16 [00:50<00:00,  0.32it/s, v_num=8820, train_loss=0.304, train_micro_ap=0.518, val_loss=0.324, val_micro_ap=0.485]Epoch 1: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 16/16 [00:51<00:00,  0.31it/s, v_num=8820, train_loss=0.303, train_micro_ap=0.435, val_loss=0.324, val_micro_ap=0.485][96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m

Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:01<00:03,  0.98it/s][A
Validation DataLoader 0:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:02<00:02,  0.85it/s][A
Validation DataLoader 0:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:03<00:01,  0.82it/s][A
Validation DataLoader 0: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:04<00:00,  0.82it/s][A
/faststorage/arne/mamba/envs/cl_lora_env/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py:4631: UserWarning: No device id is provided via `init_process_group` or `barrier `. Using the current device set by the user. 
  warnings.warn(  # warn only once
Epoch 1, global step 32: 'val_loss' reached 0.31753 (best 0.31753), saving model to 'saved_models/lightning_logs/version_8820/checkpoints/epoch=1-step=32.ckpt' as top 1
                                                                      [AEpoch 1: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 16/16 [01:02<00:00,  0.26it/s, v_num=8820, train_loss=0.303, train_micro_ap=0.435, val_loss=0.318, val_micro_ap=0.490]Epoch 1: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 16/16 [01:02<00:00,  0.26it/s, v_num=8820, train_loss=0.303, train_micro_ap=0.435, val_loss=0.318, val_micro_ap=0.490]Epoch 1:   0%|          | 0/16 [00:00<?, ?it/s, v_num=8820, train_loss=0.303, train_micro_ap=0.435, val_loss=0.318, val_micro_ap=0.490]         Epoch 2:   0%|          | 0/16 [00:00<?, ?it/s, v_num=8820, train_loss=0.303, train_micro_ap=0.435, val_loss=0.318, val_micro_ap=0.490][96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
Epoch 2:   6%|‚ñã         | 1/16 [00:08<02:00,  0.12it/s, v_num=8820, train_loss=0.303, train_micro_ap=0.435, val_loss=0.318, val_micro_ap=0.490]Epoch 2:   6%|‚ñã         | 1/16 [00:09<02:22,  0.11it/s, v_num=8820, train_loss=0.315, train_micro_ap=0.482, val_loss=0.318, val_micro_ap=0.490]Epoch 2:  12%|‚ñà‚ñé        | 2/16 [00:10<01:16,  0.18it/s, v_num=8820, train_loss=0.315, train_micro_ap=0.482, val_loss=0.318, val_micro_ap=0.490]Epoch 2:  12%|‚ñà‚ñé        | 2/16 [00:12<01:26,  0.16it/s, v_num=8820, train_loss=0.313, train_micro_ap=0.513, val_loss=0.318, val_micro_ap=0.490]Epoch 2:  19%|‚ñà‚ñâ        | 3/16 [00:13<00:59,  0.22it/s, v_num=8820, train_loss=0.313, train_micro_ap=0.513, val_loss=0.318, val_micro_ap=0.490]Epoch 2:  19%|‚ñà‚ñâ        | 3/16 [00:15<01:05,  0.20it/s, v_num=8820, train_loss=0.301, train_micro_ap=0.496, val_loss=0.318, val_micro_ap=0.490]Epoch 2:  25%|‚ñà‚ñà‚ñå       | 4/16 [00:16<00:49,  0.24it/s, v_num=8820, train_loss=0.301, train_micro_ap=0.496, val_loss=0.318, val_micro_ap=0.490]Epoch 2:  25%|‚ñà‚ñà‚ñå       | 4/16 [00:18<00:54,  0.22it/s, v_num=8820, train_loss=0.320, train_micro_ap=0.503, val_loss=0.318, val_micro_ap=0.490]Epoch 2:  31%|‚ñà‚ñà‚ñà‚ñè      | 5/16 [00:19<00:42,  0.26it/s, v_num=8820, train_loss=0.320, train_micro_ap=0.503, val_loss=0.318, val_micro_ap=0.490]Epoch 2:  31%|‚ñà‚ñà‚ñà‚ñè      | 5/16 [00:20<00:45,  0.24it/s, v_num=8820, train_loss=0.301, train_micro_ap=0.462, val_loss=0.318, val_micro_ap=0.490]Epoch 2:  38%|‚ñà‚ñà‚ñà‚ñä      | 6/16 [00:22<00:37,  0.27it/s, v_num=8820, train_loss=0.301, train_micro_ap=0.462, val_loss=0.318, val_micro_ap=0.490]Epoch 2:  38%|‚ñà‚ñà‚ñà‚ñä      | 6/16 [00:23<00:39,  0.25it/s, v_num=8820, train_loss=0.302, train_micro_ap=0.507, val_loss=0.318, val_micro_ap=0.490]Epoch 2:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 7/16 [00:25<00:32,  0.28it/s, v_num=8820, train_loss=0.302, train_micro_ap=0.507, val_loss=0.318, val_micro_ap=0.490]Epoch 2:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 7/16 [00:26<00:34,  0.26it/s, v_num=8820, train_loss=0.307, train_micro_ap=0.507, val_loss=0.318, val_micro_ap=0.490]Epoch 2:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 8/16 [00:27<00:27,  0.29it/s, v_num=8820, train_loss=0.307, train_micro_ap=0.507, val_loss=0.318, val_micro_ap=0.490]Epoch 2:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 8/16 [00:29<00:29,  0.27it/s, v_num=8820, train_loss=0.308, train_micro_ap=0.481, val_loss=0.318, val_micro_ap=0.490]Epoch 2:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 9/16 [00:30<00:23,  0.29it/s, v_num=8820, train_loss=0.308, train_micro_ap=0.481, val_loss=0.318, val_micro_ap=0.490]Epoch 2:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 9/16 [00:32<00:25,  0.28it/s, v_num=8820, train_loss=0.307, train_micro_ap=0.509, val_loss=0.318, val_micro_ap=0.490]Epoch 2:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 10/16 [00:33<00:20,  0.30it/s, v_num=8820, train_loss=0.307, train_micro_ap=0.509, val_loss=0.318, val_micro_ap=0.490]Epoch 2:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 10/16 [00:35<00:21,  0.29it/s, v_num=8820, train_loss=0.304, train_micro_ap=0.513, val_loss=0.318, val_micro_ap=0.490]Epoch 2:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 11/16 [00:36<00:16,  0.30it/s, v_num=8820, train_loss=0.304, train_micro_ap=0.513, val_loss=0.318, val_micro_ap=0.490]Epoch 2:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 11/16 [00:37<00:17,  0.29it/s, v_num=8820, train_loss=0.301, train_micro_ap=0.511, val_loss=0.318, val_micro_ap=0.490]Epoch 2:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 12/16 [00:39<00:13,  0.31it/s, v_num=8820, train_loss=0.301, train_micro_ap=0.511, val_loss=0.318, val_micro_ap=0.490]Epoch 2:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 12/16 [00:40<00:13,  0.29it/s, v_num=8820, train_loss=0.295, train_micro_ap=0.508, val_loss=0.318, val_micro_ap=0.490]Epoch 2:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 13/16 [00:42<00:09,  0.31it/s, v_num=8820, train_loss=0.295, train_micro_ap=0.508, val_loss=0.318, val_micro_ap=0.490]Epoch 2:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 13/16 [00:43<00:10,  0.30it/s, v_num=8820, train_loss=0.294, train_micro_ap=0.515, val_loss=0.318, val_micro_ap=0.490]Epoch 2:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 14/16 [00:44<00:06,  0.31it/s, v_num=8820, train_loss=0.294, train_micro_ap=0.515, val_loss=0.318, val_micro_ap=0.490]Epoch 2:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 14/16 [00:46<00:06,  0.30it/s, v_num=8820, train_loss=0.302, train_micro_ap=0.516, val_loss=0.318, val_micro_ap=0.490]Epoch 2:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 15/16 [00:47<00:03,  0.31it/s, v_num=8820, train_loss=0.302, train_micro_ap=0.516, val_loss=0.318, val_micro_ap=0.490]Epoch 2:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 15/16 [00:49<00:03,  0.30it/s, v_num=8820, train_loss=0.300, train_micro_ap=0.507, val_loss=0.318, val_micro_ap=0.490]Epoch 2: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 16/16 [00:50<00:00,  0.32it/s, v_num=8820, train_loss=0.300, train_micro_ap=0.507, val_loss=0.318, val_micro_ap=0.490]Epoch 2: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 16/16 [00:51<00:00,  0.31it/s, v_num=8820, train_loss=0.304, train_micro_ap=0.491, val_loss=0.318, val_micro_ap=0.490][96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m

Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:01<00:03,  0.98it/s][A
Validation DataLoader 0:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:02<00:02,  0.85it/s][A
Validation DataLoader 0:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:03<00:01,  0.82it/s][A
Validation DataLoader 0: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:04<00:00,  0.82it/s][A
/faststorage/arne/mamba/envs/cl_lora_env/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py:4631: UserWarning: No device id is provided via `init_process_group` or `barrier `. Using the current device set by the user. 
  warnings.warn(  # warn only once
Epoch 2, global step 48: 'val_loss' reached 0.31450 (best 0.31450), saving model to 'saved_models/lightning_logs/version_8820/checkpoints/epoch=2-step=48.ckpt' as top 1
                                                                      [AEpoch 2: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 16/16 [01:02<00:00,  0.26it/s, v_num=8820, train_loss=0.304, train_micro_ap=0.491, val_loss=0.314, val_micro_ap=0.498]Epoch 2: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 16/16 [01:02<00:00,  0.26it/s, v_num=8820, train_loss=0.304, train_micro_ap=0.491, val_loss=0.314, val_micro_ap=0.498]Epoch 2:   0%|          | 0/16 [00:00<?, ?it/s, v_num=8820, train_loss=0.304, train_micro_ap=0.491, val_loss=0.314, val_micro_ap=0.498]         Epoch 3:   0%|          | 0/16 [00:00<?, ?it/s, v_num=8820, train_loss=0.304, train_micro_ap=0.491, val_loss=0.314, val_micro_ap=0.498][96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
Epoch 3:   6%|‚ñã         | 1/16 [00:08<02:01,  0.12it/s, v_num=8820, train_loss=0.304, train_micro_ap=0.491, val_loss=0.314, val_micro_ap=0.498]Epoch 3:   6%|‚ñã         | 1/16 [00:09<02:23,  0.10it/s, v_num=8820, train_loss=0.311, train_micro_ap=0.504, val_loss=0.314, val_micro_ap=0.498]Epoch 3:  12%|‚ñà‚ñé        | 2/16 [00:11<01:17,  0.18it/s, v_num=8820, train_loss=0.311, train_micro_ap=0.504, val_loss=0.314, val_micro_ap=0.498]Epoch 3:  12%|‚ñà‚ñé        | 2/16 [00:12<01:27,  0.16it/s, v_num=8820, train_loss=0.297, train_micro_ap=0.492, val_loss=0.314, val_micro_ap=0.498]Epoch 3:  19%|‚ñà‚ñâ        | 3/16 [00:13<01:00,  0.22it/s, v_num=8820, train_loss=0.297, train_micro_ap=0.492, val_loss=0.314, val_micro_ap=0.498]Epoch 3:  19%|‚ñà‚ñâ        | 3/16 [00:15<01:06,  0.19it/s, v_num=8820, train_loss=0.290, train_micro_ap=0.532, val_loss=0.314, val_micro_ap=0.498]Epoch 3:  25%|‚ñà‚ñà‚ñå       | 4/16 [00:16<00:50,  0.24it/s, v_num=8820, train_loss=0.290, train_micro_ap=0.532, val_loss=0.314, val_micro_ap=0.498]Epoch 3:  25%|‚ñà‚ñà‚ñå       | 4/16 [00:18<00:54,  0.22it/s, v_num=8820, train_loss=0.298, train_micro_ap=0.480, val_loss=0.314, val_micro_ap=0.498]Epoch 3:  31%|‚ñà‚ñà‚ñà‚ñè      | 5/16 [00:19<00:43,  0.25it/s, v_num=8820, train_loss=0.298, train_micro_ap=0.480, val_loss=0.314, val_micro_ap=0.498]Epoch 3:  31%|‚ñà‚ñà‚ñà‚ñè      | 5/16 [00:21<00:46,  0.24it/s, v_num=8820, train_loss=0.303, train_micro_ap=0.497, val_loss=0.314, val_micro_ap=0.498]Epoch 3:  38%|‚ñà‚ñà‚ñà‚ñä      | 6/16 [00:22<00:37,  0.27it/s, v_num=8820, train_loss=0.303, train_micro_ap=0.497, val_loss=0.314, val_micro_ap=0.498]Epoch 3:  38%|‚ñà‚ñà‚ñà‚ñä      | 6/16 [00:23<00:39,  0.25it/s, v_num=8820, train_loss=0.295, train_micro_ap=0.488, val_loss=0.314, val_micro_ap=0.498]Epoch 3:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 7/16 [00:25<00:32,  0.28it/s, v_num=8820, train_loss=0.295, train_micro_ap=0.488, val_loss=0.314, val_micro_ap=0.498]Epoch 3:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 7/16 [00:26<00:34,  0.26it/s, v_num=8820, train_loss=0.304, train_micro_ap=0.510, val_loss=0.314, val_micro_ap=0.498]Epoch 3:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 8/16 [00:28<00:28,  0.28it/s, v_num=8820, train_loss=0.304, train_micro_ap=0.510, val_loss=0.314, val_micro_ap=0.498]Epoch 3:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 8/16 [00:29<00:29,  0.27it/s, v_num=8820, train_loss=0.305, train_micro_ap=0.503, val_loss=0.314, val_micro_ap=0.498]Epoch 3:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 9/16 [00:31<00:24,  0.29it/s, v_num=8820, train_loss=0.305, train_micro_ap=0.503, val_loss=0.314, val_micro_ap=0.498]Epoch 3:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 9/16 [00:32<00:25,  0.28it/s, v_num=8820, train_loss=0.300, train_micro_ap=0.506, val_loss=0.314, val_micro_ap=0.498]Epoch 3:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 10/16 [00:33<00:20,  0.30it/s, v_num=8820, train_loss=0.300, train_micro_ap=0.506, val_loss=0.314, val_micro_ap=0.498]Epoch 3:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 10/16 [00:35<00:21,  0.28it/s, v_num=8820, train_loss=0.304, train_micro_ap=0.519, val_loss=0.314, val_micro_ap=0.498]Epoch 3:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 11/16 [00:36<00:16,  0.30it/s, v_num=8820, train_loss=0.304, train_micro_ap=0.519, val_loss=0.314, val_micro_ap=0.498]Epoch 3:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 11/16 [00:38<00:17,  0.29it/s, v_num=8820, train_loss=0.313, train_micro_ap=0.506, val_loss=0.314, val_micro_ap=0.498]Epoch 3:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 12/16 [00:39<00:13,  0.30it/s, v_num=8820, train_loss=0.313, train_micro_ap=0.506, val_loss=0.314, val_micro_ap=0.498]Epoch 3:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 12/16 [00:41<00:13,  0.29it/s, v_num=8820, train_loss=0.302, train_micro_ap=0.514, val_loss=0.314, val_micro_ap=0.498]Epoch 3:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 13/16 [00:42<00:09,  0.31it/s, v_num=8820, train_loss=0.302, train_micro_ap=0.514, val_loss=0.314, val_micro_ap=0.498]Epoch 3:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 13/16 [00:43<00:10,  0.30it/s, v_num=8820, train_loss=0.296, train_micro_ap=0.498, val_loss=0.314, val_micro_ap=0.498]Epoch 3:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 14/16 [00:45<00:06,  0.31it/s, v_num=8820, train_loss=0.296, train_micro_ap=0.498, val_loss=0.314, val_micro_ap=0.498]Epoch 3:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 14/16 [00:46<00:06,  0.30it/s, v_num=8820, train_loss=0.296, train_micro_ap=0.499, val_loss=0.314, val_micro_ap=0.498]Epoch 3:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 15/16 [00:48<00:03,  0.31it/s, v_num=8820, train_loss=0.296, train_micro_ap=0.499, val_loss=0.314, val_micro_ap=0.498]Epoch 3:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 15/16 [00:49<00:03,  0.30it/s, v_num=8820, train_loss=0.307, train_micro_ap=0.534, val_loss=0.314, val_micro_ap=0.498]Epoch 3: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 16/16 [00:50<00:00,  0.32it/s, v_num=8820, train_loss=0.307, train_micro_ap=0.534, val_loss=0.314, val_micro_ap=0.498]Epoch 3: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 16/16 [00:51<00:00,  0.31it/s, v_num=8820, train_loss=0.325, train_micro_ap=0.469, val_loss=0.314, val_micro_ap=0.498][96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m

Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:01<00:03,  0.98it/s][A
Validation DataLoader 0:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:02<00:02,  0.85it/s][A
Validation DataLoader 0:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:03<00:01,  0.82it/s][A
Validation DataLoader 0: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:04<00:00,  0.82it/s][A
/faststorage/arne/mamba/envs/cl_lora_env/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py:4631: UserWarning: No device id is provided via `init_process_group` or `barrier `. Using the current device set by the user. 
  warnings.warn(  # warn only once
Metric val_loss improved by 0.012 >= min_delta = 0.01. New best score: 0.312
Epoch 3, global step 64: 'val_loss' reached 0.31159 (best 0.31159), saving model to 'saved_models/lightning_logs/version_8820/checkpoints/epoch=3-step=64.ckpt' as top 1
                                                                      [AEpoch 3: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 16/16 [01:02<00:00,  0.26it/s, v_num=8820, train_loss=0.325, train_micro_ap=0.469, val_loss=0.312, val_micro_ap=0.502]Epoch 3: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 16/16 [01:02<00:00,  0.25it/s, v_num=8820, train_loss=0.325, train_micro_ap=0.469, val_loss=0.312, val_micro_ap=0.502]Epoch 3:   0%|          | 0/16 [00:00<?, ?it/s, v_num=8820, train_loss=0.325, train_micro_ap=0.469, val_loss=0.312, val_micro_ap=0.502]         Epoch 4:   0%|          | 0/16 [00:00<?, ?it/s, v_num=8820, train_loss=0.325, train_micro_ap=0.469, val_loss=0.312, val_micro_ap=0.502][96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
Epoch 4:   6%|‚ñã         | 1/16 [00:07<01:57,  0.13it/s, v_num=8820, train_loss=0.325, train_micro_ap=0.469, val_loss=0.312, val_micro_ap=0.502]Epoch 4:   6%|‚ñã         | 1/16 [00:09<02:19,  0.11it/s, v_num=8820, train_loss=0.286, train_micro_ap=0.527, val_loss=0.312, val_micro_ap=0.502]Epoch 4:  12%|‚ñà‚ñé        | 2/16 [00:10<01:14,  0.19it/s, v_num=8820, train_loss=0.286, train_micro_ap=0.527, val_loss=0.312, val_micro_ap=0.502]Epoch 4:  12%|‚ñà‚ñé        | 2/16 [00:12<01:25,  0.16it/s, v_num=8820, train_loss=0.311, train_micro_ap=0.496, val_loss=0.312, val_micro_ap=0.502]Epoch 4:  19%|‚ñà‚ñâ        | 3/16 [00:13<00:58,  0.22it/s, v_num=8820, train_loss=0.311, train_micro_ap=0.496, val_loss=0.312, val_micro_ap=0.502]Epoch 4:  19%|‚ñà‚ñâ        | 3/16 [00:15<01:05,  0.20it/s, v_num=8820, train_loss=0.309, train_micro_ap=0.515, val_loss=0.312, val_micro_ap=0.502]Epoch 4:  25%|‚ñà‚ñà‚ñå       | 4/16 [00:16<00:49,  0.24it/s, v_num=8820, train_loss=0.309, train_micro_ap=0.515, val_loss=0.312, val_micro_ap=0.502]Epoch 4:  25%|‚ñà‚ñà‚ñå       | 4/16 [00:17<00:53,  0.22it/s, v_num=8820, train_loss=0.296, train_micro_ap=0.525, val_loss=0.312, val_micro_ap=0.502]Epoch 4:  31%|‚ñà‚ñà‚ñà‚ñè      | 5/16 [00:19<00:42,  0.26it/s, v_num=8820, train_loss=0.296, train_micro_ap=0.525, val_loss=0.312, val_micro_ap=0.502]Epoch 4:  31%|‚ñà‚ñà‚ñà‚ñè      | 5/16 [00:20<00:45,  0.24it/s, v_num=8820, train_loss=0.292, train_micro_ap=0.527, val_loss=0.312, val_micro_ap=0.502]Epoch 4:  38%|‚ñà‚ñà‚ñà‚ñä      | 6/16 [00:22<00:36,  0.27it/s, v_num=8820, train_loss=0.292, train_micro_ap=0.527, val_loss=0.312, val_micro_ap=0.502]Epoch 4:  38%|‚ñà‚ñà‚ñà‚ñä      | 6/16 [00:23<00:39,  0.25it/s, v_num=8820, train_loss=0.301, train_micro_ap=0.500, val_loss=0.312, val_micro_ap=0.502]Epoch 4:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 7/16 [00:24<00:32,  0.28it/s, v_num=8820, train_loss=0.301, train_micro_ap=0.500, val_loss=0.312, val_micro_ap=0.502]Epoch 4:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 7/16 [00:26<00:33,  0.27it/s, v_num=8820, train_loss=0.277, train_micro_ap=0.546, val_loss=0.312, val_micro_ap=0.502]Epoch 4:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 8/16 [00:27<00:27,  0.29it/s, v_num=8820, train_loss=0.277, train_micro_ap=0.546, val_loss=0.312, val_micro_ap=0.502]Epoch 4:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 8/16 [00:29<00:29,  0.27it/s, v_num=8820, train_loss=0.307, train_micro_ap=0.511, val_loss=0.312, val_micro_ap=0.502]Epoch 4:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 9/16 [00:30<00:23,  0.29it/s, v_num=8820, train_loss=0.307, train_micro_ap=0.511, val_loss=0.312, val_micro_ap=0.502]Epoch 4:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 9/16 [00:32<00:24,  0.28it/s, v_num=8820, train_loss=0.319, train_micro_ap=0.499, val_loss=0.312, val_micro_ap=0.502]Epoch 4:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 10/16 [00:33<00:20,  0.30it/s, v_num=8820, train_loss=0.319, train_micro_ap=0.499, val_loss=0.312, val_micro_ap=0.502]Epoch 4:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 10/16 [00:34<00:20,  0.29it/s, v_num=8820, train_loss=0.307, train_micro_ap=0.492, val_loss=0.312, val_micro_ap=0.502]Epoch 4:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 11/16 [00:36<00:16,  0.30it/s, v_num=8820, train_loss=0.307, train_micro_ap=0.492, val_loss=0.312, val_micro_ap=0.502]Epoch 4:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 11/16 [00:37<00:17,  0.29it/s, v_num=8820, train_loss=0.295, train_micro_ap=0.514, val_loss=0.312, val_micro_ap=0.502]Epoch 4:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 12/16 [00:39<00:13,  0.31it/s, v_num=8820, train_loss=0.295, train_micro_ap=0.514, val_loss=0.312, val_micro_ap=0.502]Epoch 4:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 12/16 [00:40<00:13,  0.30it/s, v_num=8820, train_loss=0.306, train_micro_ap=0.503, val_loss=0.312, val_micro_ap=0.502]Epoch 4:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 13/16 [00:41<00:09,  0.31it/s, v_num=8820, train_loss=0.306, train_micro_ap=0.503, val_loss=0.312, val_micro_ap=0.502]Epoch 4:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 13/16 [00:43<00:10,  0.30it/s, v_num=8820, train_loss=0.294, train_micro_ap=0.507, val_loss=0.312, val_micro_ap=0.502]Epoch 4:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 14/16 [00:44<00:06,  0.31it/s, v_num=8820, train_loss=0.294, train_micro_ap=0.507, val_loss=0.312, val_micro_ap=0.502]Epoch 4:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 14/16 [00:46<00:06,  0.30it/s, v_num=8820, train_loss=0.288, train_micro_ap=0.530, val_loss=0.312, val_micro_ap=0.502]Epoch 4:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 15/16 [00:47<00:03,  0.32it/s, v_num=8820, train_loss=0.288, train_micro_ap=0.530, val_loss=0.312, val_micro_ap=0.502]Epoch 4:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 15/16 [00:49<00:03,  0.31it/s, v_num=8820, train_loss=0.305, train_micro_ap=0.478, val_loss=0.312, val_micro_ap=0.502]Epoch 4: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 16/16 [00:49<00:00,  0.32it/s, v_num=8820, train_loss=0.305, train_micro_ap=0.478, val_loss=0.312, val_micro_ap=0.502]Epoch 4: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 16/16 [00:50<00:00,  0.31it/s, v_num=8820, train_loss=0.322, train_micro_ap=0.489, val_loss=0.312, val_micro_ap=0.502][96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m

Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:01<00:03,  0.98it/s][A
Validation DataLoader 0:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:02<00:02,  0.85it/s][A
Validation DataLoader 0:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:03<00:01,  0.81it/s][A
Validation DataLoader 0: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:04<00:00,  0.81it/s][A
/faststorage/arne/mamba/envs/cl_lora_env/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py:4631: UserWarning: No device id is provided via `init_process_group` or `barrier `. Using the current device set by the user. 
  warnings.warn(  # warn only once
Epoch 4, global step 80: 'val_loss' reached 0.31058 (best 0.31058), saving model to 'saved_models/lightning_logs/version_8820/checkpoints/epoch=4-step=80.ckpt' as top 1
                                                                      [AEpoch 4: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 16/16 [01:02<00:00,  0.26it/s, v_num=8820, train_loss=0.322, train_micro_ap=0.489, val_loss=0.311, val_micro_ap=0.495]Epoch 4: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 16/16 [01:02<00:00,  0.26it/s, v_num=8820, train_loss=0.322, train_micro_ap=0.489, val_loss=0.311, val_micro_ap=0.495]Epoch 4:   0%|          | 0/16 [00:00<?, ?it/s, v_num=8820, train_loss=0.322, train_micro_ap=0.489, val_loss=0.311, val_micro_ap=0.495]         Epoch 5:   0%|          | 0/16 [00:00<?, ?it/s, v_num=8820, train_loss=0.322, train_micro_ap=0.489, val_loss=0.311, val_micro_ap=0.495][96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
Epoch 5:   6%|‚ñã         | 1/16 [00:07<01:55,  0.13it/s, v_num=8820, train_loss=0.322, train_micro_ap=0.489, val_loss=0.311, val_micro_ap=0.495]Epoch 5:   6%|‚ñã         | 1/16 [00:09<02:17,  0.11it/s, v_num=8820, train_loss=0.301, train_micro_ap=0.523, val_loss=0.311, val_micro_ap=0.495]Epoch 5:  12%|‚ñà‚ñé        | 2/16 [00:10<01:13,  0.19it/s, v_num=8820, train_loss=0.301, train_micro_ap=0.523, val_loss=0.311, val_micro_ap=0.495]Epoch 5:  12%|‚ñà‚ñé        | 2/16 [00:12<01:24,  0.17it/s, v_num=8820, train_loss=0.285, train_micro_ap=0.535, val_loss=0.311, val_micro_ap=0.495]Epoch 5:  19%|‚ñà‚ñâ        | 3/16 [00:13<00:58,  0.22it/s, v_num=8820, train_loss=0.285, train_micro_ap=0.535, val_loss=0.311, val_micro_ap=0.495]Epoch 5:  19%|‚ñà‚ñâ        | 3/16 [00:14<01:04,  0.20it/s, v_num=8820, train_loss=0.295, train_micro_ap=0.503, val_loss=0.311, val_micro_ap=0.495]Epoch 5:  25%|‚ñà‚ñà‚ñå       | 4/16 [00:16<00:48,  0.25it/s, v_num=8820, train_loss=0.295, train_micro_ap=0.503, val_loss=0.311, val_micro_ap=0.495]Epoch 5:  25%|‚ñà‚ñà‚ñå       | 4/16 [00:17<00:53,  0.23it/s, v_num=8820, train_loss=0.305, train_micro_ap=0.492, val_loss=0.311, val_micro_ap=0.495]Epoch 5:  31%|‚ñà‚ñà‚ñà‚ñè      | 5/16 [00:19<00:42,  0.26it/s, v_num=8820, train_loss=0.305, train_micro_ap=0.492, val_loss=0.311, val_micro_ap=0.495]Epoch 5:  31%|‚ñà‚ñà‚ñà‚ñè      | 5/16 [00:20<00:45,  0.24it/s, v_num=8820, train_loss=0.299, train_micro_ap=0.513, val_loss=0.311, val_micro_ap=0.495]Epoch 5:  38%|‚ñà‚ñà‚ñà‚ñä      | 6/16 [00:21<00:36,  0.27it/s, v_num=8820, train_loss=0.299, train_micro_ap=0.513, val_loss=0.311, val_micro_ap=0.495]Epoch 5:  38%|‚ñà‚ñà‚ñà‚ñä      | 6/16 [00:23<00:39,  0.26it/s, v_num=8820, train_loss=0.291, train_micro_ap=0.509, val_loss=0.311, val_micro_ap=0.495]Epoch 5:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 7/16 [00:24<00:31,  0.28it/s, v_num=8820, train_loss=0.291, train_micro_ap=0.509, val_loss=0.311, val_micro_ap=0.495]Epoch 5:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 7/16 [00:26<00:33,  0.27it/s, v_num=8820, train_loss=0.282, train_micro_ap=0.557, val_loss=0.311, val_micro_ap=0.495]Epoch 5:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 8/16 [00:27<00:27,  0.29it/s, v_num=8820, train_loss=0.282, train_micro_ap=0.557, val_loss=0.311, val_micro_ap=0.495]Epoch 5:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 8/16 [00:29<00:29,  0.27it/s, v_num=8820, train_loss=0.311, train_micro_ap=0.483, val_loss=0.311, val_micro_ap=0.495]Epoch 5:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 9/16 [00:30<00:23,  0.30it/s, v_num=8820, train_loss=0.311, train_micro_ap=0.483, val_loss=0.311, val_micro_ap=0.495]Epoch 5:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 9/16 [00:31<00:24,  0.28it/s, v_num=8820, train_loss=0.313, train_micro_ap=0.511, val_loss=0.311, val_micro_ap=0.495]Epoch 5:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 10/16 [00:33<00:19,  0.30it/s, v_num=8820, train_loss=0.313, train_micro_ap=0.511, val_loss=0.311, val_micro_ap=0.495]Epoch 5:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 10/16 [00:34<00:20,  0.29it/s, v_num=8820, train_loss=0.306, train_micro_ap=0.501, val_loss=0.311, val_micro_ap=0.495]Epoch 5:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 11/16 [00:36<00:16,  0.30it/s, v_num=8820, train_loss=0.306, train_micro_ap=0.501, val_loss=0.311, val_micro_ap=0.495]Epoch 5:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 11/16 [00:37<00:17,  0.29it/s, v_num=8820, train_loss=0.313, train_micro_ap=0.492, val_loss=0.311, val_micro_ap=0.495]Epoch 5:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 12/16 [00:38<00:12,  0.31it/s, v_num=8820, train_loss=0.313, train_micro_ap=0.492, val_loss=0.311, val_micro_ap=0.495]Epoch 5:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 12/16 [00:40<00:13,  0.30it/s, v_num=8820, train_loss=0.291, train_micro_ap=0.488, val_loss=0.311, val_micro_ap=0.495]Epoch 5:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 13/16 [00:41<00:09,  0.31it/s, v_num=8820, train_loss=0.291, train_micro_ap=0.488, val_loss=0.311, val_micro_ap=0.495]Epoch 5:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 13/16 [00:43<00:09,  0.30it/s, v_num=8820, train_loss=0.314, train_micro_ap=0.475, val_loss=0.311, val_micro_ap=0.495]Epoch 5:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 14/16 [00:44<00:06,  0.31it/s, v_num=8820, train_loss=0.314, train_micro_ap=0.475, val_loss=0.311, val_micro_ap=0.495]Epoch 5:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 14/16 [00:46<00:06,  0.30it/s, v_num=8820, train_loss=0.296, train_micro_ap=0.513, val_loss=0.311, val_micro_ap=0.495]Epoch 5:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 15/16 [00:47<00:03,  0.32it/s, v_num=8820, train_loss=0.296, train_micro_ap=0.513, val_loss=0.311, val_micro_ap=0.495]Epoch 5:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 15/16 [00:48<00:03,  0.31it/s, v_num=8820, train_loss=0.309, train_micro_ap=0.500, val_loss=0.311, val_micro_ap=0.495]Epoch 5: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 16/16 [00:49<00:00,  0.32it/s, v_num=8820, train_loss=0.309, train_micro_ap=0.500, val_loss=0.311, val_micro_ap=0.495]Epoch 5: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 16/16 [00:50<00:00,  0.32it/s, v_num=8820, train_loss=0.284, train_micro_ap=0.518, val_loss=0.311, val_micro_ap=0.495][96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m

Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:01<00:03,  0.98it/s][A
Validation DataLoader 0:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:02<00:02,  0.85it/s][A
Validation DataLoader 0:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:03<00:01,  0.81it/s][A
Validation DataLoader 0: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:04<00:00,  0.82it/s][A
/faststorage/arne/mamba/envs/cl_lora_env/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py:4631: UserWarning: No device id is provided via `init_process_group` or `barrier `. Using the current device set by the user. 
  warnings.warn(  # warn only once
Epoch 5, global step 96: 'val_loss' reached 0.31022 (best 0.31022), saving model to 'saved_models/lightning_logs/version_8820/checkpoints/epoch=5-step=96-v2.ckpt' as top 1
                                                                      [AEpoch 5: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 16/16 [01:01<00:00,  0.26it/s, v_num=8820, train_loss=0.284, train_micro_ap=0.518, val_loss=0.310, val_micro_ap=0.500]Epoch 5: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 16/16 [01:02<00:00,  0.26it/s, v_num=8820, train_loss=0.284, train_micro_ap=0.518, val_loss=0.310, val_micro_ap=0.500]Epoch 5:   0%|          | 0/16 [00:00<?, ?it/s, v_num=8820, train_loss=0.284, train_micro_ap=0.518, val_loss=0.310, val_micro_ap=0.500]         Epoch 6:   0%|          | 0/16 [00:00<?, ?it/s, v_num=8820, train_loss=0.284, train_micro_ap=0.518, val_loss=0.310, val_micro_ap=0.500][96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
Epoch 6:   6%|‚ñã         | 1/16 [00:07<01:56,  0.13it/s, v_num=8820, train_loss=0.284, train_micro_ap=0.518, val_loss=0.310, val_micro_ap=0.500]Epoch 6:   6%|‚ñã         | 1/16 [00:09<02:18,  0.11it/s, v_num=8820, train_loss=0.304, train_micro_ap=0.539, val_loss=0.310, val_micro_ap=0.500]Epoch 6:  12%|‚ñà‚ñé        | 2/16 [00:10<01:16,  0.18it/s, v_num=8820, train_loss=0.304, train_micro_ap=0.539, val_loss=0.310, val_micro_ap=0.500]Epoch 6:  12%|‚ñà‚ñé        | 2/16 [00:12<01:26,  0.16it/s, v_num=8820, train_loss=0.290, train_micro_ap=0.528, val_loss=0.310, val_micro_ap=0.500]Epoch 6:  19%|‚ñà‚ñâ        | 3/16 [00:13<00:59,  0.22it/s, v_num=8820, train_loss=0.290, train_micro_ap=0.528, val_loss=0.310, val_micro_ap=0.500]Epoch 6:  19%|‚ñà‚ñâ        | 3/16 [00:15<01:06,  0.20it/s, v_num=8820, train_loss=0.310, train_micro_ap=0.487, val_loss=0.310, val_micro_ap=0.500]Epoch 6:  25%|‚ñà‚ñà‚ñå       | 4/16 [00:16<00:49,  0.24it/s, v_num=8820, train_loss=0.310, train_micro_ap=0.487, val_loss=0.310, val_micro_ap=0.500]Epoch 6:  25%|‚ñà‚ñà‚ñå       | 4/16 [00:18<00:54,  0.22it/s, v_num=8820, train_loss=0.296, train_micro_ap=0.512, val_loss=0.310, val_micro_ap=0.500]Epoch 6:  31%|‚ñà‚ñà‚ñà‚ñè      | 5/16 [00:19<00:42,  0.26it/s, v_num=8820, train_loss=0.296, train_micro_ap=0.512, val_loss=0.310, val_micro_ap=0.500]Epoch 6:  31%|‚ñà‚ñà‚ñà‚ñè      | 5/16 [00:20<00:46,  0.24it/s, v_num=8820, train_loss=0.310, train_micro_ap=0.480, val_loss=0.310, val_micro_ap=0.500]Epoch 6:  38%|‚ñà‚ñà‚ñà‚ñä      | 6/16 [00:22<00:37,  0.27it/s, v_num=8820, train_loss=0.310, train_micro_ap=0.480, val_loss=0.310, val_micro_ap=0.500]Epoch 6:  38%|‚ñà‚ñà‚ñà‚ñä      | 6/16 [00:23<00:39,  0.25it/s, v_num=8820, train_loss=0.304, train_micro_ap=0.494, val_loss=0.310, val_micro_ap=0.500]Epoch 6:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 7/16 [00:25<00:32,  0.28it/s, v_num=8820, train_loss=0.304, train_micro_ap=0.494, val_loss=0.310, val_micro_ap=0.500]Epoch 6:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 7/16 [00:26<00:34,  0.26it/s, v_num=8820, train_loss=0.306, train_micro_ap=0.498, val_loss=0.310, val_micro_ap=0.500]Epoch 6:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 8/16 [00:28<00:28,  0.29it/s, v_num=8820, train_loss=0.306, train_micro_ap=0.498, val_loss=0.310, val_micro_ap=0.500]Epoch 6:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 8/16 [00:29<00:29,  0.27it/s, v_num=8820, train_loss=0.300, train_micro_ap=0.529, val_loss=0.310, val_micro_ap=0.500]Epoch 6:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 9/16 [00:30<00:24,  0.29it/s, v_num=8820, train_loss=0.300, train_micro_ap=0.529, val_loss=0.310, val_micro_ap=0.500]Epoch 6:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 9/16 [00:32<00:25,  0.28it/s, v_num=8820, train_loss=0.296, train_micro_ap=0.505, val_loss=0.310, val_micro_ap=0.500]Epoch 6:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 10/16 [00:33<00:20,  0.30it/s, v_num=8820, train_loss=0.296, train_micro_ap=0.505, val_loss=0.310, val_micro_ap=0.500]Epoch 6:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 10/16 [00:35<00:21,  0.28it/s, v_num=8820, train_loss=0.282, train_micro_ap=0.517, val_loss=0.310, val_micro_ap=0.500]Epoch 6:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 11/16 [00:36<00:16,  0.30it/s, v_num=8820, train_loss=0.282, train_micro_ap=0.517, val_loss=0.310, val_micro_ap=0.500]Epoch 6:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 11/16 [00:38<00:17,  0.29it/s, v_num=8820, train_loss=0.291, train_micro_ap=0.494, val_loss=0.310, val_micro_ap=0.500]Epoch 6:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 12/16 [00:39<00:13,  0.30it/s, v_num=8820, train_loss=0.291, train_micro_ap=0.494, val_loss=0.310, val_micro_ap=0.500]Epoch 6:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 12/16 [00:40<00:13,  0.29it/s, v_num=8820, train_loss=0.299, train_micro_ap=0.477, val_loss=0.310, val_micro_ap=0.500]Epoch 6:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 13/16 [00:42<00:09,  0.31it/s, v_num=8820, train_loss=0.299, train_micro_ap=0.477, val_loss=0.310, val_micro_ap=0.500]Epoch 6:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 13/16 [00:43<00:10,  0.30it/s, v_num=8820, train_loss=0.303, train_micro_ap=0.504, val_loss=0.310, val_micro_ap=0.500]Epoch 6:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 14/16 [00:45<00:06,  0.31it/s, v_num=8820, train_loss=0.303, train_micro_ap=0.504, val_loss=0.310, val_micro_ap=0.500]Epoch 6:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 14/16 [00:46<00:06,  0.30it/s, v_num=8820, train_loss=0.307, train_micro_ap=0.519, val_loss=0.310, val_micro_ap=0.500]Epoch 6:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 15/16 [00:47<00:03,  0.31it/s, v_num=8820, train_loss=0.307, train_micro_ap=0.519, val_loss=0.310, val_micro_ap=0.500]Epoch 6:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 15/16 [00:49<00:03,  0.30it/s, v_num=8820, train_loss=0.299, train_micro_ap=0.515, val_loss=0.310, val_micro_ap=0.500]Epoch 6: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 16/16 [00:50<00:00,  0.32it/s, v_num=8820, train_loss=0.299, train_micro_ap=0.515, val_loss=0.310, val_micro_ap=0.500]Epoch 6: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 16/16 [00:51<00:00,  0.31it/s, v_num=8820, train_loss=0.301, train_micro_ap=0.506, val_loss=0.310, val_micro_ap=0.500][96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m

Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:01<00:03,  0.97it/s][A
Validation DataLoader 0:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:02<00:02,  0.85it/s][A
Validation DataLoader 0:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:03<00:01,  0.81it/s][A
Validation DataLoader 0: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:04<00:00,  0.81it/s][A
/faststorage/arne/mamba/envs/cl_lora_env/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py:4631: UserWarning: No device id is provided via `init_process_group` or `barrier `. Using the current device set by the user. 
  warnings.warn(  # warn only once
Epoch 6, global step 112: 'val_loss' reached 0.30926 (best 0.30926), saving model to 'saved_models/lightning_logs/version_8820/checkpoints/epoch=6-step=112-v1.ckpt' as top 1
                                                                      [AEpoch 6: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 16/16 [01:02<00:00,  0.26it/s, v_num=8820, train_loss=0.301, train_micro_ap=0.506, val_loss=0.309, val_micro_ap=0.502]Epoch 6: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 16/16 [01:02<00:00,  0.26it/s, v_num=8820, train_loss=0.301, train_micro_ap=0.506, val_loss=0.309, val_micro_ap=0.502]Epoch 6:   0%|          | 0/16 [00:00<?, ?it/s, v_num=8820, train_loss=0.301, train_micro_ap=0.506, val_loss=0.309, val_micro_ap=0.502]         Epoch 7:   0%|          | 0/16 [00:00<?, ?it/s, v_num=8820, train_loss=0.301, train_micro_ap=0.506, val_loss=0.309, val_micro_ap=0.502][96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
Epoch 7:   6%|‚ñã         | 1/16 [00:07<01:57,  0.13it/s, v_num=8820, train_loss=0.301, train_micro_ap=0.506, val_loss=0.309, val_micro_ap=0.502]Epoch 7:   6%|‚ñã         | 1/16 [00:09<02:20,  0.11it/s, v_num=8820, train_loss=0.292, train_micro_ap=0.505, val_loss=0.309, val_micro_ap=0.502]Epoch 7:  12%|‚ñà‚ñé        | 2/16 [00:10<01:16,  0.18it/s, v_num=8820, train_loss=0.292, train_micro_ap=0.505, val_loss=0.309, val_micro_ap=0.502]Epoch 7:  12%|‚ñà‚ñé        | 2/16 [00:12<01:26,  0.16it/s, v_num=8820, train_loss=0.293, train_micro_ap=0.516, val_loss=0.309, val_micro_ap=0.502]Epoch 7:  19%|‚ñà‚ñâ        | 3/16 [00:13<00:59,  0.22it/s, v_num=8820, train_loss=0.293, train_micro_ap=0.516, val_loss=0.309, val_micro_ap=0.502]Epoch 7:  19%|‚ñà‚ñâ        | 3/16 [00:15<01:05,  0.20it/s, v_num=8820, train_loss=0.319, train_micro_ap=0.473, val_loss=0.309, val_micro_ap=0.502]Epoch 7:  25%|‚ñà‚ñà‚ñå       | 4/16 [00:16<00:49,  0.24it/s, v_num=8820, train_loss=0.319, train_micro_ap=0.473, val_loss=0.309, val_micro_ap=0.502]Epoch 7:  25%|‚ñà‚ñà‚ñå       | 4/16 [00:18<00:54,  0.22it/s, v_num=8820, train_loss=0.305, train_micro_ap=0.499, val_loss=0.309, val_micro_ap=0.502]Epoch 7:  31%|‚ñà‚ñà‚ñà‚ñè      | 5/16 [00:19<00:42,  0.26it/s, v_num=8820, train_loss=0.305, train_micro_ap=0.499, val_loss=0.309, val_micro_ap=0.502]Epoch 7:  31%|‚ñà‚ñà‚ñà‚ñè      | 5/16 [00:20<00:45,  0.24it/s, v_num=8820, train_loss=0.301, train_micro_ap=0.503, val_loss=0.309, val_micro_ap=0.502]Epoch 7:  38%|‚ñà‚ñà‚ñà‚ñä      | 6/16 [00:22<00:37,  0.27it/s, v_num=8820, train_loss=0.301, train_micro_ap=0.503, val_loss=0.309, val_micro_ap=0.502]Epoch 7:  38%|‚ñà‚ñà‚ñà‚ñä      | 6/16 [00:23<00:39,  0.25it/s, v_num=8820, train_loss=0.299, train_micro_ap=0.508, val_loss=0.309, val_micro_ap=0.502]Epoch 7:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 7/16 [00:25<00:32,  0.28it/s, v_num=8820, train_loss=0.299, train_micro_ap=0.508, val_loss=0.309, val_micro_ap=0.502]Epoch 7:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 7/16 [00:26<00:34,  0.26it/s, v_num=8820, train_loss=0.284, train_micro_ap=0.526, val_loss=0.309, val_micro_ap=0.502]Epoch 7:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 8/16 [00:27<00:27,  0.29it/s, v_num=8820, train_loss=0.284, train_micro_ap=0.526, val_loss=0.309, val_micro_ap=0.502]Epoch 7:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 8/16 [00:29<00:29,  0.27it/s, v_num=8820, train_loss=0.287, train_micro_ap=0.512, val_loss=0.309, val_micro_ap=0.502]Epoch 7:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 9/16 [00:30<00:23,  0.29it/s, v_num=8820, train_loss=0.287, train_micro_ap=0.512, val_loss=0.309, val_micro_ap=0.502]Epoch 7:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 9/16 [00:32<00:25,  0.28it/s, v_num=8820, train_loss=0.308, train_micro_ap=0.511, val_loss=0.309, val_micro_ap=0.502]Epoch 7:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 10/16 [00:33<00:20,  0.30it/s, v_num=8820, train_loss=0.308, train_micro_ap=0.511, val_loss=0.309, val_micro_ap=0.502]Epoch 7:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 10/16 [00:35<00:21,  0.28it/s, v_num=8820, train_loss=0.315, train_micro_ap=0.520, val_loss=0.309, val_micro_ap=0.502]Epoch 7:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 11/16 [00:36<00:16,  0.30it/s, v_num=8820, train_loss=0.315, train_micro_ap=0.520, val_loss=0.309, val_micro_ap=0.502]Epoch 7:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 11/16 [00:37<00:17,  0.29it/s, v_num=8820, train_loss=0.281, train_micro_ap=0.543, val_loss=0.309, val_micro_ap=0.502]Epoch 7:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 12/16 [00:39<00:13,  0.30it/s, v_num=8820, train_loss=0.281, train_micro_ap=0.543, val_loss=0.309, val_micro_ap=0.502]Epoch 7:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 12/16 [00:40<00:13,  0.29it/s, v_num=8820, train_loss=0.297, train_micro_ap=0.522, val_loss=0.309, val_micro_ap=0.502]Epoch 7:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 13/16 [00:42<00:09,  0.31it/s, v_num=8820, train_loss=0.297, train_micro_ap=0.522, val_loss=0.309, val_micro_ap=0.502]Epoch 7:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 13/16 [00:43<00:10,  0.30it/s, v_num=8820, train_loss=0.286, train_micro_ap=0.536, val_loss=0.309, val_micro_ap=0.502]Epoch 7:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 14/16 [00:45<00:06,  0.31it/s, v_num=8820, train_loss=0.286, train_micro_ap=0.536, val_loss=0.309, val_micro_ap=0.502]Epoch 7:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 14/16 [00:46<00:06,  0.30it/s, v_num=8820, train_loss=0.317, train_micro_ap=0.513, val_loss=0.309, val_micro_ap=0.502]Epoch 7:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 15/16 [00:47<00:03,  0.31it/s, v_num=8820, train_loss=0.317, train_micro_ap=0.513, val_loss=0.309, val_micro_ap=0.502]Epoch 7:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 15/16 [00:49<00:03,  0.30it/s, v_num=8820, train_loss=0.297, train_micro_ap=0.524, val_loss=0.309, val_micro_ap=0.502]Epoch 7: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 16/16 [00:50<00:00,  0.32it/s, v_num=8820, train_loss=0.297, train_micro_ap=0.524, val_loss=0.309, val_micro_ap=0.502]Epoch 7: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 16/16 [00:51<00:00,  0.31it/s, v_num=8820, train_loss=0.293, train_micro_ap=0.513, val_loss=0.309, val_micro_ap=0.502][96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m

Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:01<00:03,  0.98it/s][A
Validation DataLoader 0:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:02<00:02,  0.85it/s][A
Validation DataLoader 0:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:03<00:01,  0.81it/s][A
Validation DataLoader 0: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:04<00:00,  0.82it/s][A
/faststorage/arne/mamba/envs/cl_lora_env/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py:4631: UserWarning: No device id is provided via `init_process_group` or `barrier `. Using the current device set by the user. 
  warnings.warn(  # warn only once
Epoch 7, global step 128: 'val_loss' reached 0.30847 (best 0.30847), saving model to 'saved_models/lightning_logs/version_8820/checkpoints/epoch=7-step=128.ckpt' as top 1
                                                                      [AEpoch 7: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 16/16 [01:02<00:00,  0.26it/s, v_num=8820, train_loss=0.293, train_micro_ap=0.513, val_loss=0.308, val_micro_ap=0.509]Epoch 7: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 16/16 [01:02<00:00,  0.26it/s, v_num=8820, train_loss=0.293, train_micro_ap=0.513, val_loss=0.308, val_micro_ap=0.509]Epoch 7:   0%|          | 0/16 [00:00<?, ?it/s, v_num=8820, train_loss=0.293, train_micro_ap=0.513, val_loss=0.308, val_micro_ap=0.509]         Epoch 8:   0%|          | 0/16 [00:00<?, ?it/s, v_num=8820, train_loss=0.293, train_micro_ap=0.513, val_loss=0.308, val_micro_ap=0.509][96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
Epoch 8:   6%|‚ñã         | 1/16 [00:07<01:56,  0.13it/s, v_num=8820, train_loss=0.293, train_micro_ap=0.513, val_loss=0.308, val_micro_ap=0.509]Epoch 8:   6%|‚ñã         | 1/16 [00:09<02:19,  0.11it/s, v_num=8820, train_loss=0.306, train_micro_ap=0.504, val_loss=0.308, val_micro_ap=0.509]Epoch 8:  12%|‚ñà‚ñé        | 2/16 [00:11<01:17,  0.18it/s, v_num=8820, train_loss=0.306, train_micro_ap=0.504, val_loss=0.308, val_micro_ap=0.509]Epoch 8:  12%|‚ñà‚ñé        | 2/16 [00:12<01:27,  0.16it/s, v_num=8820, train_loss=0.302, train_micro_ap=0.521, val_loss=0.308, val_micro_ap=0.509]Epoch 8:  19%|‚ñà‚ñâ        | 3/16 [00:13<01:00,  0.22it/s, v_num=8820, train_loss=0.302, train_micro_ap=0.521, val_loss=0.308, val_micro_ap=0.509]Epoch 8:  19%|‚ñà‚ñâ        | 3/16 [00:15<01:06,  0.20it/s, v_num=8820, train_loss=0.301, train_micro_ap=0.527, val_loss=0.308, val_micro_ap=0.509]Epoch 8:  25%|‚ñà‚ñà‚ñå       | 4/16 [00:16<00:50,  0.24it/s, v_num=8820, train_loss=0.301, train_micro_ap=0.527, val_loss=0.308, val_micro_ap=0.509]Epoch 8:  25%|‚ñà‚ñà‚ñå       | 4/16 [00:18<00:54,  0.22it/s, v_num=8820, train_loss=0.296, train_micro_ap=0.513, val_loss=0.308, val_micro_ap=0.509]Epoch 8:  31%|‚ñà‚ñà‚ñà‚ñè      | 5/16 [00:19<00:43,  0.25it/s, v_num=8820, train_loss=0.296, train_micro_ap=0.513, val_loss=0.308, val_micro_ap=0.509]Epoch 8:  31%|‚ñà‚ñà‚ñà‚ñè      | 5/16 [00:21<00:46,  0.24it/s, v_num=8820, train_loss=0.299, train_micro_ap=0.519, val_loss=0.308, val_micro_ap=0.509]Epoch 8:  38%|‚ñà‚ñà‚ñà‚ñä      | 6/16 [00:22<00:37,  0.27it/s, v_num=8820, train_loss=0.299, train_micro_ap=0.519, val_loss=0.308, val_micro_ap=0.509]Epoch 8:  38%|‚ñà‚ñà‚ñà‚ñä      | 6/16 [00:23<00:39,  0.25it/s, v_num=8820, train_loss=0.313, train_micro_ap=0.487, val_loss=0.308, val_micro_ap=0.509]Epoch 8:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 7/16 [00:25<00:32,  0.28it/s, v_num=8820, train_loss=0.313, train_micro_ap=0.487, val_loss=0.308, val_micro_ap=0.509]Epoch 8:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 7/16 [00:26<00:34,  0.26it/s, v_num=8820, train_loss=0.288, train_micro_ap=0.538, val_loss=0.308, val_micro_ap=0.509]Epoch 8:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 8/16 [00:28<00:28,  0.28it/s, v_num=8820, train_loss=0.288, train_micro_ap=0.538, val_loss=0.308, val_micro_ap=0.509]Epoch 8:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 8/16 [00:29<00:29,  0.27it/s, v_num=8820, train_loss=0.291, train_micro_ap=0.515, val_loss=0.308, val_micro_ap=0.509]Epoch 8:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 9/16 [00:30<00:24,  0.29it/s, v_num=8820, train_loss=0.291, train_micro_ap=0.515, val_loss=0.308, val_micro_ap=0.509]Epoch 8:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 9/16 [00:32<00:25,  0.28it/s, v_num=8820, train_loss=0.301, train_micro_ap=0.510, val_loss=0.308, val_micro_ap=0.509]Epoch 8:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 10/16 [00:33<00:20,  0.30it/s, v_num=8820, train_loss=0.301, train_micro_ap=0.510, val_loss=0.308, val_micro_ap=0.509]Epoch 8:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 10/16 [00:35<00:21,  0.28it/s, v_num=8820, train_loss=0.283, train_micro_ap=0.534, val_loss=0.308, val_micro_ap=0.509]Epoch 8:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 11/16 [00:36<00:16,  0.30it/s, v_num=8820, train_loss=0.283, train_micro_ap=0.534, val_loss=0.308, val_micro_ap=0.509]Epoch 8:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 11/16 [00:38<00:17,  0.29it/s, v_num=8820, train_loss=0.292, train_micro_ap=0.511, val_loss=0.308, val_micro_ap=0.509]Epoch 8:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 12/16 [00:39<00:13,  0.30it/s, v_num=8820, train_loss=0.292, train_micro_ap=0.511, val_loss=0.308, val_micro_ap=0.509]Epoch 8:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 12/16 [00:40<00:13,  0.29it/s, v_num=8820, train_loss=0.297, train_micro_ap=0.520, val_loss=0.308, val_micro_ap=0.509]Epoch 8:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 13/16 [00:42<00:09,  0.31it/s, v_num=8820, train_loss=0.297, train_micro_ap=0.520, val_loss=0.308, val_micro_ap=0.509]Epoch 8:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 13/16 [00:43<00:10,  0.30it/s, v_num=8820, train_loss=0.300, train_micro_ap=0.526, val_loss=0.308, val_micro_ap=0.509]Epoch 8:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 14/16 [00:45<00:06,  0.31it/s, v_num=8820, train_loss=0.300, train_micro_ap=0.526, val_loss=0.308, val_micro_ap=0.509]Epoch 8:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 14/16 [00:46<00:06,  0.30it/s, v_num=8820, train_loss=0.293, train_micro_ap=0.541, val_loss=0.308, val_micro_ap=0.509]Epoch 8:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 15/16 [00:48<00:03,  0.31it/s, v_num=8820, train_loss=0.293, train_micro_ap=0.541, val_loss=0.308, val_micro_ap=0.509]Epoch 8:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 15/16 [00:49<00:03,  0.30it/s, v_num=8820, train_loss=0.297, train_micro_ap=0.524, val_loss=0.308, val_micro_ap=0.509]Epoch 8: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 16/16 [00:50<00:00,  0.32it/s, v_num=8820, train_loss=0.297, train_micro_ap=0.524, val_loss=0.308, val_micro_ap=0.509]Epoch 8: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 16/16 [00:51<00:00,  0.31it/s, v_num=8820, train_loss=0.315, train_micro_ap=0.491, val_loss=0.308, val_micro_ap=0.509][96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m

Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:01<00:03,  0.98it/s][A
Validation DataLoader 0:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:02<00:02,  0.85it/s][A
Validation DataLoader 0:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:03<00:01,  0.82it/s][A
Validation DataLoader 0: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:04<00:00,  0.82it/s][A
/faststorage/arne/mamba/envs/cl_lora_env/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py:4631: UserWarning: No device id is provided via `init_process_group` or `barrier `. Using the current device set by the user. 
  warnings.warn(  # warn only once
Monitored metric val_loss did not improve in the last 5 records. Best score: 0.312. Signaling Trainer to stop.
Epoch 8, global step 144: 'val_loss' reached 0.30845 (best 0.30845), saving model to 'saved_models/lightning_logs/version_8820/checkpoints/epoch=8-step=144.ckpt' as top 1
                                                                      [AEpoch 8: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 16/16 [01:02<00:00,  0.26it/s, v_num=8820, train_loss=0.315, train_micro_ap=0.491, val_loss=0.308, val_micro_ap=0.508]Epoch 8: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 16/16 [01:02<00:00,  0.26it/s, v_num=8820, train_loss=0.315, train_micro_ap=0.491, val_loss=0.308, val_micro_ap=0.508]Epoch 8: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 16/16 [01:03<00:00,  0.25it/s, v_num=8820, train_loss=0.315, train_micro_ap=0.491, val_loss=0.308, val_micro_ap=0.508][96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
2025-06-16 19:33:54,937 INFO Training time: 581.84s
2025-06-16 19:33:55,640 INFO Saved: ./saved_models/step5-Portugal.pkl

[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
/faststorage/arne/mamba/envs/cl_lora_env/lib/python3.9/site-packages/sklearn/metrics/_ranking.py:1033: UserWarning: No positive class found in y_true, recall is set to one for all thresholds.
  warnings.warn(
/faststorage/arne/mamba/envs/cl_lora_env/lib/python3.9/site-packages/sklearn/metrics/_ranking.py:1033: UserWarning: No positive class found in y_true, recall is set to one for all thresholds.
  warnings.warn(
/faststorage/arne/mamba/envs/cl_lora_env/lib/python3.9/site-packages/sklearn/metrics/_ranking.py:1033: UserWarning: No positive class found in y_true, recall is set to one for all thresholds.
  warnings.warn(
/faststorage/arne/mamba/envs/cl_lora_env/lib/python3.9/site-packages/sklearn/metrics/_ranking.py:1033: UserWarning: No positive class found in y_true, recall is set to one for all thresholds.
  warnings.warn(
/faststorage/arne/mamba/envs/cl_lora_env/lib/python3.9/site-packages/sklearn/metrics/_ranking.py:1033: UserWarning: No positive class found in y_true, recall is set to one for all thresholds.
  warnings.warn(
/faststorage/arne/mamba/envs/cl_lora_env/lib/python3.9/site-packages/sklearn/metrics/_ranking.py:1033: UserWarning: No positive class found in y_true, recall is set to one for all thresholds.
  warnings.warn(
/faststorage/arne/mamba/envs/cl_lora_env/lib/python3.9/site-packages/sklearn/metrics/_ranking.py:1033: UserWarning: No positive class found in y_true, recall is set to one for all thresholds.
  warnings.warn(
[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
/faststorage/arne/mamba/envs/cl_lora_env/lib/python3.9/site-packages/sklearn/metrics/_ranking.py:1033: UserWarning: No positive class found in y_true, recall is set to one for all thresholds.
  warnings.warn(
/faststorage/arne/mamba/envs/cl_lora_env/lib/python3.9/site-packages/sklearn/metrics/_ranking.py:1033: UserWarning: No positive class found in y_true, recall is set to one for all thresholds.
  warnings.warn(
/faststorage/arne/mamba/envs/cl_lora_env/lib/python3.9/site-packages/sklearn/metrics/_ranking.py:1033: UserWarning: No positive class found in y_true, recall is set to one for all thresholds.
  warnings.warn(
/faststorage/arne/mamba/envs/cl_lora_env/lib/python3.9/site-packages/sklearn/metrics/_ranking.py:1033: UserWarning: No positive class found in y_true, recall is set to one for all thresholds.
  warnings.warn(
[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
/faststorage/arne/mamba/envs/cl_lora_env/lib/python3.9/site-packages/sklearn/metrics/_ranking.py:1033: UserWarning: No positive class found in y_true, recall is set to one for all thresholds.
  warnings.warn(
/faststorage/arne/mamba/envs/cl_lora_env/lib/python3.9/site-packages/sklearn/metrics/_ranking.py:1033: UserWarning: No positive class found in y_true, recall is set to one for all thresholds.
  warnings.warn(
/faststorage/arne/mamba/envs/cl_lora_env/lib/python3.9/site-packages/sklearn/metrics/_ranking.py:1033: UserWarning: No positive class found in y_true, recall is set to one for all thresholds.
  warnings.warn(
/faststorage/arne/mamba/envs/cl_lora_env/lib/python3.9/site-packages/sklearn/metrics/_ranking.py:1033: UserWarning: No positive class found in y_true, recall is set to one for all thresholds.
  warnings.warn(
/faststorage/arne/mamba/envs/cl_lora_env/lib/python3.9/site-packages/sklearn/metrics/_ranking.py:1033: UserWarning: No positive class found in y_true, recall is set to one for all thresholds.
  warnings.warn(
[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
/faststorage/arne/mamba/envs/cl_lora_env/lib/python3.9/site-packages/sklearn/metrics/_ranking.py:1033: UserWarning: No positive class found in y_true, recall is set to one for all thresholds.
  warnings.warn(
/faststorage/arne/mamba/envs/cl_lora_env/lib/python3.9/site-packages/sklearn/metrics/_ranking.py:1033: UserWarning: No positive class found in y_true, recall is set to one for all thresholds.
  warnings.warn(
/faststorage/arne/mamba/envs/cl_lora_env/lib/python3.9/site-packages/sklearn/metrics/_ranking.py:1033: UserWarning: No positive class found in y_true, recall is set to one for all thresholds.
  warnings.warn(
/faststorage/arne/mamba/envs/cl_lora_env/lib/python3.9/site-packages/sklearn/metrics/_ranking.py:1033: UserWarning: No positive class found in y_true, recall is set to one for all thresholds.
  warnings.warn(
[96m[INFO]    Opening LMDB environment ...[0m
[96m[INFO]    Opening LMDB environment ...[0m
/faststorage/arne/mamba/envs/cl_lora_env/lib/python3.9/site-packages/sklearn/metrics/_ranking.py:1033: UserWarning: No positive class found in y_true, recall is set to one for all thresholds.
  warnings.warn(
2025-06-16 19:34:26,037 INFO Eval time: 30.40s
2025-06-16 19:34:26,037 INFO Result: {'step': 5, 'countries': ('Finland', 'Ireland', 'Serbia', 'Austria', 'Portugal'), 'train_time_s': 581.8399941921234, 'eval_time_s': 30.396305561065674, 'Finland_micro_ap': np.float64(0.3460741974986682), 'Finland_macro_ap': np.float64(0.2586622520294069), 'Finland_accuracy': 86.33684210526316, 'Ireland_micro_ap': np.float64(0.34238245820906865), 'Ireland_macro_ap': np.float64(0.2019590510206639), 'Ireland_accuracy': 87.9578947368421, 'Serbia_micro_ap': np.float64(0.3321603797835416), 'Serbia_macro_ap': np.float64(0.17710799751625847), 'Serbia_accuracy': 83.62105263157895, 'Austria_micro_ap': np.float64(0.3116286204889746), 'Austria_macro_ap': np.float64(0.2201126959281164), 'Austria_accuracy': 82.6842105263158, 'Portugal_micro_ap': np.float64(0.4486224879444669), 'Portugal_macro_ap': np.float64(0.25014444508256073), 'Portugal_accuracy': 82.77894736842106, 'mean_micro_ap': np.float64(0.356173628784944), 'mean_macro_ap': np.float64(0.2215972883154013), 'mean_accuracy': 84.6757894736842}
   step  ... Portugal_accuracy
0     1  ...               NaN
1     2  ...               NaN
2     3  ...               NaN
3     4  ...               NaN
4     5  ...         82.778947

[5 rows x 22 columns]
